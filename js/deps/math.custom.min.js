'use strict';(function(m,e){"object"===typeof exports&&"object"===typeof module?module.exports=e():"function"===typeof define&&define.amd?define(e):"object"===typeof exports?exports.math=e():m.math=e()})(this,function(){return function(m){function e(l){if(a[l])return a[l].exports;var f=a[l]={exports:{},id:l,loaded:!1};m[l].call(f.exports,f,f.exports,e);f.loaded=!0;return f.exports}var a={};e.m=m;e.c=a;e.p="";return e(0)}([function(m,e,a){e=a(1).create();e.import(a(13));e.import(a(23));e.import(a(24));
e.import(a(34));e.import(a(35));e.import(a(36));e.import(a(63));e.import(a(53));e.import(a(69));e.import(a(67));e.import(a(72));e.import(a(73));m.exports=e},function(m,e,a){m.exports=a(2)},function(m,e,a){var l=a(5).isFactory,f=a(5).deepExtend,d=a(6),b=a(3),c=a(10),h=a(12);e.create=function(a){function r(b){if(!l(b))throw Error("Factory object with properties `type`, `name`, and `factory` expected");var h=n.indexOf(b);-1===h?(h=!0===b.math?b.factory(e.type,q,r,e.typed,e):b.factory(e.type,q,r,e.typed),
n.push(b),g.push(h)):h=g[h];return h}if("function"!==typeof Object.create)throw Error("ES5 not supported by this JavaScript engine. Please load the es5-shim and es5-sham library for compatibility.");var n=[],g=[],e=b.mixin({});e.type={};e.expression={transform:Object.create(e)};e.typed=d.create(e.type);var q={epsilon:1E-14,matrix:"matrix",number:"number",precision:64,predictable:!1};a&&f(q,a);e["import"]=r(c);e.config=r(h);return e}},function(m,e,a){var l=a(4);e.mixin=function(a){var d=new l;a.on=
d.on.bind(d);a.off=d.off.bind(d);a.once=d.once.bind(d);a.emit=d.emit.bind(d);return a}},function(m,e){function a(){}a.prototype={on:function(a,f,d){var b=this.e||(this.e={});(b[a]||(b[a]=[])).push({fn:f,ctx:d});return this},once:function(a,f,d){var b=this,c=function(){b.off(a,c);f.apply(d,arguments)};return this.on(a,c,d)},emit:function(a){var f=[].slice.call(arguments,1),d=((this.e||(this.e={}))[a]||[]).slice(),b=0,c=d.length;for(b;b<c;b++)d[b].fn.apply(d[b].ctx,f);return this},off:function(a,f){var d=
this.e||(this.e={}),b=d[a],c=[];if(b&&f)for(var h=0,e=b.length;h<e;h++)b[h].fn!==f&&c.push(b[h]);c.length?d[a]=c:delete d[a];return this}};m.exports=a},function(m,e){e.clone=function l(f){var d=typeof f;if("number"===d||"string"===d||"boolean"===d||null===f||void 0===f)return f;if("function"===typeof f.clone)return f.clone();if(Array.isArray(f))return f.map(function(b){return l(b)});if(f instanceof Number)return new Number(f.valueOf());if(f instanceof String)return new String(f.valueOf());if(f instanceof
Boolean)return new Boolean(f.valueOf());if(f instanceof Date)return new Date(f.valueOf());if(f&&!0===f.isBigNumber)return f;if(f instanceof RegExp)throw new TypeError("Cannot clone "+f);var d={},b;for(b in f)f.hasOwnProperty(b)&&(d[b]=l(f[b]));return d};e.extend=function(e,f){for(var d in f)f.hasOwnProperty(d)&&(e[d]=f[d]);return e};e.deepExtend=function f(d,b){if(Array.isArray(b))throw new TypeError("Arrays are not supported by deepExtend");for(var c in b)if(b.hasOwnProperty(c))if(b[c]&&b[c].constructor===
Object)void 0===d[c]&&(d[c]={}),d[c].constructor===Object?f(d[c],b[c]):d[c]=b[c];else{if(Array.isArray(b[c]))throw new TypeError("Arrays are not supported by deepExtend");d[c]=b[c]}return d};e.deepEqual=function(f,d){var b,c;if(Array.isArray(f)){if(!Array.isArray(d)||f.length!=d.length)return!1;b=0;for(c=f.length;b<c;b++)if(!e.deepEqual(f[b],d[b]))return!1;return!0}if(f instanceof Object){if(Array.isArray(d)||!(d instanceof Object))return!1;for(b in f)if(!e.deepEqual(f[b],d[b]))return!1;for(b in d)if(!e.deepEqual(f[b],
d[b]))return!1;return!0}return typeof f===typeof d&&f==d};e.canDefineProperty=function(){try{if(Object.defineProperty)return Object.defineProperty({},"x",{}),!0}catch(f){}return!1};e.lazy=function(f,d,b){if(e.canDefineProperty()){var c=!0,h;Object.defineProperty(f,d,{get:function(){c&&(h=b(),c=!1);return h},set:function(b){h=b;c=!1},configurable:!0,enumerable:!0})}else f[d]=b()};e.traverse=function(f,d){var b=f;if(d)for(var c=d.split("."),h=0;h<c.length;h++){var e=c[h];e in b||(b[e]={});b=b[e]}return b};
e.isFactory=function(f){return f&&"function"===typeof f.factory}},function(m,e,a){var l=a(7),f=a(8).digits,d=function(){d=l.create;return l};e.create=function(b){var a=d();a.types=[{name:"number",test:function(b){return"number"===typeof b}},{name:"Complex",test:function(b){return b&&b.isComplex}},{name:"BigNumber",test:function(b){return b&&b.isBigNumber}},{name:"Fraction",test:function(b){return b&&b.isFraction}},{name:"Unit",test:function(b){return b&&b.isUnit}},{name:"string",test:function(b){return"string"===
typeof b}},{name:"Array",test:Array.isArray},{name:"Matrix",test:function(b){return b&&b.isMatrix}},{name:"DenseMatrix",test:function(b){return b&&b.isDenseMatrix}},{name:"SparseMatrix",test:function(b){return b&&b.isSparseMatrix}},{name:"ImmutableDenseMatrix",test:function(b){return b&&b.isImmutableDenseMatrix}},{name:"Range",test:function(b){return b&&b.isRange}},{name:"Index",test:function(b){return b&&b.isIndex}},{name:"boolean",test:function(b){return"boolean"===typeof b}},{name:"ResultSet",
test:function(b){return b&&b.isResultSet}},{name:"Help",test:function(b){return b&&b.isHelp}},{name:"function",test:function(b){return"function"===typeof b}},{name:"Date",test:function(b){return b instanceof Date}},{name:"RegExp",test:function(b){return b instanceof RegExp}},{name:"Object",test:function(b){return"object"===typeof b}},{name:"null",test:function(b){return null===b}},{name:"undefined",test:function(b){return void 0===b}}];a.conversions=[{from:"number",to:"BigNumber",convert:function(a){if(15<
f(a))throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+a+"). Use function bignumber(x) to convert to BigNumber.");return new b.BigNumber(a)}},{from:"number",to:"Complex",convert:function(a){return new b.Complex(a,0)}},{from:"number",to:"string",convert:function(b){return b+""}},{from:"BigNumber",to:"Complex",convert:function(a){return new b.Complex(a.toNumber(),0)}},{from:"number",to:"Fraction",convert:function(a){if(15<f(a))throw new TypeError("Cannot implicitly convert a number with >15 significant digits to Fraction (value: "+
a+"). Use function fraction(x) to convert to Fraction.");return new b.Fraction(a)}},{from:"string",to:"number",convert:function(b){var a=Number(b);if(isNaN(a))throw Error('Cannot convert "'+b+'" to a number');return a}},{from:"boolean",to:"number",convert:function(b){return+b}},{from:"boolean",to:"BigNumber",convert:function(a){return new b.BigNumber(+a)}},{from:"boolean",to:"string",convert:function(b){return+b}},{from:"null",to:"number",convert:function(){return 0}},{from:"null",to:"string",convert:function(){return"null"}},
{from:"null",to:"BigNumber",convert:function(){return new b.BigNumber(0)}},{from:"Array",to:"Matrix",convert:function(a){return new b.DenseMatrix(a)}},{from:"Matrix",to:"Array",convert:function(b){return b.valueOf()}}];return a}},function(m,e,a){var l,f,d;"use strict";(function(b){!(f=[],l=b,d="function"===typeof l?l.apply(e,f):l,void 0!==d&&(m.exports=d))})(function(){function b(){function a(b){for(var D,g=0;g<w.types.length;g++){var c=w.types[g];if(c.name===b){D=c.test;break}}if(!D){for(var k,g=
0;g<w.types.length;g++)if(c=w.types[g],c.name.toLowerCase()==b.toLowerCase()){k=c.name;break}throw Error('Unknown type "'+b+'"'+(k?'. Did you mean "'+k+'"?':""));}return D}function d(b){for(var a="",g=0;g<b.length;g++){var c=b[g];if(""!=c.name)if(""==a)a=c.name;else if(a!=c.name)throw b=Error("Function names do not match (expected: "+a+", actual: "+c.name+")"),b.data={actual:c.name,expected:a},b;}return a}function f(b,a,g,c,k){var d=p(c);k=k?k.split(","):null;var h=b||"unnamed",n=k&&-1!==k.indexOf("any");
b={fn:b,index:g,actual:c,expected:k};a=k?a>g&&!n?"Unexpected type of argument in function "+h+" (expected: "+k.join(" or ")+", actual: "+d+", index: "+g+")":"Too few arguments in function "+h+" (expected: "+k.join(" or ")+", index: "+g+")":"Too many arguments in function "+h+" (expected: "+g+", actual: "+a+")";a=new TypeError(a);a.data=b;return a}function e(b){this.name=b||"refs";this.categories={}}function n(b,a){if("string"===typeof b){var g=b.trim(),c="..."===g.substr(0,3);c&&(g=g.substr(3));if(""===
g)this.types=["any"];else for(this.types=g.split("|"),g=0;g<this.types.length;g++)this.types[g]=this.types[g].trim()}else if(Array.isArray(b))this.types=b;else{if(b instanceof n)return b.clone();throw Error("String or Array expected");}this.conversions=[];this.varArgs=c||a||!1;this.anyType=-1!==this.types.indexOf("any")}function g(b,a){var g;if("string"===typeof b)g=""!==b?b.split(","):[];else if(Array.isArray(b))g=b;else throw Error("string or Array expected");this.params=Array(g.length);for(var c=
0;c<g.length;c++){var k=new n(g[c]);this.params[c]=k;if(c===g.length-1)this.varArgs=k.varArgs;else if(k.varArgs)throw new SyntaxError('Unexpected variable arguments operator "..."');}this.fn=a}function l(b,a,g){this.path=b||[];this.param=b[b.length-1]||null;this.signature=a||null;this.childs=g||[]}function q(b){var a,c={},k=[],d,f;for(f in b)if(b.hasOwnProperty(f)&&(a=new g(f,b[f]),!a.ignore()))for(a=a.expand(),d=0;d<a.length;d++){var h=a[d],n=h.toString(),t=c[n];if(t)if(t=g.compare(h,t),0>t)c[n]=
h;else{if(0===t)throw Error('Signature "'+n+'" is defined twice');}else c[n]=h}for(n in c)c.hasOwnProperty(n)&&k.push(c[n]);k.sort(function(b,a){return g.compare(b,a)});for(d=0;d<k.length;d++)if(a=k[d],a.varArgs)for(b=a.params.length-1,c=a.params[b],f=0;f<c.types.length;){if(c.conversions[f])for(n=c.types[f],h=0;h<k.length;h++){var t=k[h],e=t.params[b];if(t!==a&&e&&-1!==e.types.indexOf(n)&&!e.conversions[b]){c.types.splice(f,1);c.conversions.splice(f,1);f--;break}}f++}return k}function t(b,a){var g,
c,k=a.length,d,f=[];for(g=0;g<b.length;g++)c=b[g],c.params.length!==k||d||(d=c),void 0!=c.params[k]&&f.push(c);f.sort(function(b,a){return n.compare(b.params[k],a.params[k])});var h=[];for(g=0;g<f.length;g++){c=f[g];var e=c.params[k],q=h.filter(function(b){return b.param.overlapping(e)})[0];if(q){if(q.param.varArgs)throw Error('Conflicting types "'+q.param+'" and "'+e+'"');q.signatures.push(c)}else h.push({param:e,signatures:[c]})}c=Array(h.length);for(g=0;g<h.length;g++)f=h[g],c[g]=t(f.signatures,
a.concat(f.param));return new l(a,d,c)}function k(b,a){var g=new e,c=q(a);if(0==c.length)throw Error("No signatures provided");for(var k=t(c,[]),d=[],h=b||"",n=0,p=0;p<c.length;p++){var y=c[p].params.length;y>n&&(n=y)}p=[];for(y=0;y<n;y++)p[y]="arg"+y;d.push("function "+h+"("+p.join(", ")+") {");d.push('  "use strict";');d.push("  var name = '"+h+"';");d.push(k.toCode(g,"  "));d.push("}");k=[g.toCode(),"return "+d.join("\n")].join("\n");g=(new Function(g.name,"createError",k))(g,f);k={};for(d=0;d<
c.length;d++)h=c[d],h.fn&&!h.hasConversions()&&(n=h.params.join(","),k[n]=h.fn);g.signatures=k;return g}function p(b){for(var a,g=0;g<w.types.length;g++){var c=w.types[g];if("Object"===c.name)a=c;else if(c.test(b))return c.name}return a&&a.test(b)?a.name:"unknown"}e.prototype.add=function(b,a){var g=a||"fn";this.categories[g]||(this.categories[g]=[]);var c=this.categories[g].indexOf(b);-1==c&&(c=this.categories[g].length,this.categories[g].push(b));return g+c};e.prototype.toCode=function(){var b=
[],a=this.name+".categories",g=this.categories,c;for(c in g)if(g.hasOwnProperty(c))for(var k=g[c],d=0;d<k.length;d++)b.push("var "+c+d+" = "+a+"['"+c+"']["+d+"];");return b.join("\n")};n.compare=function(b,a){if(b.anyType)return 1;if(a.anyType)return-1;if(-1!==b.types.indexOf("Object"))return 1;if(-1!==a.types.indexOf("Object"))return-1;if(b.hasConversions()){if(a.hasConversions()){var g,c,k;for(g=0;g<b.conversions.length;g++)if(void 0!==b.conversions[g]){c=b.conversions[g];break}for(g=0;g<a.conversions.length;g++)if(void 0!==
a.conversions[g]){k=a.conversions[g];break}return w.conversions.indexOf(c)-w.conversions.indexOf(k)}return 1}if(a.hasConversions())return-1;var d,f;for(g=0;g<w.types.length;g++)if(w.types[g].name===b.types[0]){d=g;break}for(g=0;g<w.types.length;g++)if(w.types[g].name===a.types[0]){f=g;break}return d-f};n.prototype.overlapping=function(b){for(var a=0;a<this.types.length;a++)if(-1!==b.types.indexOf(this.types[a]))return!0;return!1};n.prototype.clone=function(){var b=new n(this.types.slice(),this.varArgs);
b.conversions=this.conversions.slice();return b};n.prototype.hasConversions=function(){return 0<this.conversions.length};n.prototype.contains=function(b){for(var a=0;a<this.types.length;a++)if(b[this.types[a]])return!0;return!1};n.prototype.toString=function(b){for(var a=[],g={},c=0;c<this.types.length;c++){var k=this.conversions[c],k=b&&k?k.to:this.types[c];k in g||(g[k]=!0,a.push(k))}return(this.varArgs?"...":"")+a.join("|")};g.prototype.clone=function(){return new g(this.params.slice(),this.fn)};
g.prototype.expand=function(){function b(c,k){if(k.length<c.params.length){var d,f,h,t=c.params[k.length];if(t.varArgs){f=t.clone();for(d=0;d<w.conversions.length;d++)if(h=w.conversions[d],-1===t.types.indexOf(h.from)&&-1!==t.types.indexOf(h.to)){var e=f.types.length;f.types[e]=h.from;f.conversions[e]=h}b(c,k.concat(f))}else{for(d=0;d<t.types.length;d++)b(c,k.concat(new n(t.types[d])));for(d=0;d<w.conversions.length;d++)h=w.conversions[d],-1===t.types.indexOf(h.from)&&-1!==t.types.indexOf(h.to)&&
(f=new n(h.from),f.conversions[0]=h,b(c,k.concat(f)))}}else a.push(new g(k,c.fn))}var a=[];b(this,[]);return a};g.compare=function(b,a){if(b.params.length>a.params.length)return 1;if(b.params.length<a.params.length)return-1;var g,c=b.params.length,k=0,d=0;for(g=0;g<c;g++)b.params[g].hasConversions()&&k++,a.params[g].hasConversions()&&d++;if(k>d)return 1;if(k<d)return-1;for(g=0;g<b.params.length;g++)if(c=n.compare(b.params[g],a.params[g]),0!==c)return c;return 0};g.prototype.hasConversions=function(){for(var b=
0;b<this.params.length;b++)if(this.params[b].hasConversions())return!0;return!1};g.prototype.ignore=function(){for(var b={},a=0;a<w.ignore.length;a++)b[w.ignore[a]]=!0;for(a=0;a<this.params.length;a++)if(this.params[a].contains(b))return!0;return!1};g.prototype.toCode=function(b,a){for(var g=Array(this.params.length),c=0;c<this.params.length;c++){var k=this.params[c],d=k.conversions[0];g[c]=k.varArgs?"varArgs":d?b.add(d.convert,"convert")+"(arg"+c+")":"arg"+c}return(c=this.fn?b.add(this.fn,"signature"):
void 0)?a+"return "+c+"("+g.join(", ")+"); // signature: "+this.params.join(", "):""};g.prototype.toString=function(){return this.params.join(", ")};l.prototype.toCode=function(b,g,k){var d=[];if(this.param){var f=this.path.length-1,h=this.param.conversions[0],h="// type: "+(h?h.from+" (convert to "+h.to+")":this.param);if(this.param.varArgs){if(this.param.anyType)d.push(g+"if (arguments.length > "+f+") {"),d.push(g+"  var varArgs = [];"),d.push(g+"  for (var i = "+f+"; i < arguments.length; i++) {"),
d.push(g+"    varArgs.push(arguments[i]);");else{var n=function(g,k){for(var d=[],f=0;f<g.length;f++)d[f]=b.add(a(g[f]),"test")+"("+k+")";return d.join(" || ")}.bind(this);k=this.param.types;for(var t=[],e=0;e<k.length;e++)void 0===this.param.conversions[e]&&t.push(k[e]);d.push(g+"if ("+n(k,"arg"+f)+") { "+h);d.push(g+"  var varArgs = [arg"+f+"];");d.push(g+"  for (var i = "+(f+1)+"; i < arguments.length; i++) {");d.push(g+"    if ("+n(t,"arguments[i]")+") {");d.push(g+"      varArgs.push(arguments[i]);");
for(e=0;e<k.length;e++)if(f=this.param.conversions[e])n=b.add(a(k[e]),"test"),f=b.add(f.convert,"convert"),d.push(g+"    }"),d.push(g+"    else if ("+n+"(arguments[i])) {"),d.push(g+"      varArgs.push("+f+"(arguments[i]));");d.push(g+"    } else {");d.push(g+"      throw createError(name, arguments.length, i, arguments[i], '"+t.join(",")+"');");d.push(g+"    }")}d.push(g+"  }");d.push(this.signature.toCode(b,g+"  "));d.push(g+"}")}else this.param.anyType?(d.push(g+"// type: any"),d.push(this._innerCode(b,
g,k))):(t=this.param.types[0],n="any"!==t?b.add(a(t),"test"):null,d.push(g+"if ("+n+"(arg"+f+")) { "+h),d.push(this._innerCode(b,g+"  ",k)),d.push(g+"}"))}else d.push(this._innerCode(b,g,k));return d.join("\n")};l.prototype._innerCode=function(b,a,g){var c=[],k;this.signature&&(c.push(a+"if (arguments.length === "+this.path.length+") {"),c.push(this.signature.toCode(b,a+"  ")),c.push(a+"}"));var d;for(k=0;k<this.childs.length;k++)if(this.childs[k].param.anyType){d=this.childs[k];break}for(k=0;k<this.childs.length;k++)c.push(this.childs[k].toCode(b,
a,d));g&&!this.param.anyType&&c.push(g.toCode(b,a,d));(b=this._exceptions(b,a))&&c.push(b);return c.join("\n")};l.prototype._exceptions=function(b,a){var g=this.path.length;if(0===this.childs.length)return[a+"if (arguments.length > "+g+") {",a+"  throw createError(name, arguments.length, "+g+", arguments["+g+"]);",a+"}"].join("\n");for(var c={},k=[],d=0;d<this.childs.length;d++){var f=this.childs[d];if(f.param)for(var h=0;h<f.param.types.length;h++){var n=f.param.types[h];n in c||f.param.conversions[h]||
(c[n]=!0,k.push(n))}}return a+"throw createError(name, arguments.length, "+g+", arguments["+g+"], '"+k.join(",")+"');"};var B=[{name:"number",test:function(b){return"number"===typeof b}},{name:"string",test:function(b){return"string"===typeof b}},{name:"boolean",test:function(b){return"boolean"===typeof b}},{name:"Function",test:function(b){return"function"===typeof b}},{name:"Array",test:Array.isArray},{name:"Date",test:function(b){return b instanceof Date}},{name:"RegExp",test:function(b){return b instanceof
RegExp}},{name:"Object",test:function(b){return"object"===typeof b}},{name:"null",test:function(b){return null===b}},{name:"undefined",test:function(b){return void 0===b}}],v={},y=[],x=[],w={config:v,types:B,conversions:y,ignore:x},w=k("typed",{Object:function(b){var a=[],g;for(g in b)b.hasOwnProperty(g)&&a.push(b[g]);a=d(a);return k(a,b)},"string, Object":k,"...Function":function(b){for(var a=d(b),g={},c=0;c<b.length;c++){var f=b[c];if("object"!==typeof f.signatures)throw b=new TypeError("Function is no typed-function (index: "+
c+")"),b.data={index:c},b;for(var n in f.signatures)if(f.signatures.hasOwnProperty(n))if(g.hasOwnProperty(n)){if(f.signatures[n]!==g[n])throw b=Error('Signature "'+n+'" is defined twice'),b.data={signature:n},b;}else g[n]=f.signatures[n]}return k(a,g)}});w.config=v;w.types=B;w.conversions=y;w.ignore=x;w.create=b;w.find=function(b,a){if(!b.signatures)throw new TypeError("Function is no typed-function");var g;if("string"===typeof a){g=a.split(",");for(var c=0;c<g.length;c++)g[c]=g[c].trim()}else if(Array.isArray(a))g=
a;else throw new TypeError("String array or a comma separated string expected");c=g.join(",");if(c=b.signatures[c])return c;throw new TypeError("Signature not found (signature: "+(b.name||"unnamed")+"("+g.join(", ")+"))");};w.convert=function(b,a){var g=p(b);if(a===g)return b;for(var c=0;c<w.conversions.length;c++){var k=w.conversions[c];if(k.from===g&&k.to===a)return k.convert(b)}throw Error("Cannot convert from "+g+" to "+a);};w.addType=function(b){if(!b||"string"!==typeof b.name||"function"!==
typeof b.test)throw new TypeError("Object with properties {name: string, test: function} expected");w.types.push(b)};w.addConversion=function(b){if(!b||"string"!==typeof b.from||"string"!==typeof b.to||"function"!==typeof b.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");w.conversions.push(b)};return w}return b()})},function(m,e,a){var l=a(9);e.isNumber=function(a){return"number"===typeof a};e.isInteger=function(a){return isFinite(a)?a==
Math.round(a):!1};e.sign=function(a){return 0<a?1:0>a?-1:0};e.format=function(a,d){if("function"===typeof d)return d(a);if(Infinity===a)return"Infinity";if(-Infinity===a)return"-Infinity";if(isNaN(a))return"NaN";var b="auto",c=void 0;d&&(d.notation&&(b=d.notation),e.isNumber(d)?c=d:d.precision&&(c=d.precision));switch(b){case "fixed":return e.toFixed(a,c);case "exponential":return e.toExponential(a,c);case "auto":return e.toPrecision(a,c,d&&d.exponential).replace(/((\.\d*?)(0+))($|e)/,function(b,
a,c,d,g){return"."!==c?c+g:g});default:throw Error('Unknown notation "'+b+'". Choose "auto", "exponential", or "fixed".');}};e.toExponential=function(a,d){return(new l(a)).toExponential(d)};e.toFixed=function(a,d){return(new l(a)).toFixed(d)};e.toPrecision=function(a,d,b){return(new l(a)).toPrecision(d,b)};e.digits=function(a){return a.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length};e.DBL_EPSILON=Number.EPSILON||2.220446049250313E-16;e.nearlyEqual=function(a,d,b){if(null==b)return a==
d;if(a==d)return!0;if(isNaN(a)||isNaN(d))return!1;if(isFinite(a)&&isFinite(d)){var c=Math.abs(a-d);return c<e.DBL_EPSILON?!0:c<=Math.max(Math.abs(a),Math.abs(d))*b}return!1}},function(m,e){function a(a){var d=String(a).toLowerCase().match(/^0*?(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!d)throw new SyntaxError("Invalid number");a=d[1];var b=d[2],c=parseFloat(d[4]||"0"),d=b.indexOf("."),c=c+(-1!==d?d-1:b.length-1);this.sign=a;this.coefficients=b.replace(".","").replace(/^0*/,function(b){c-=b.length;return""}).replace(/0*$/,
"").split("").map(function(b){return parseInt(b)});0===this.coefficients.length&&(this.coefficients.push(0),c++);this.exponent=c}function l(a){for(var d=[],b=0;b<a;b++)d.push(0);return d}a.prototype.toFixed=function(a){var d=this.roundDigits(this.exponent+1+(a||0)),b=d.coefficients,d=d.exponent+1,c=d+(a||0);b.length<c&&(b=b.concat(l(c-b.length)));0>d&&(b=l(-d+1).concat(b),d=1);a&&b.splice(d,0,0===d?"0.":".");return this.sign+b.join("")};a.prototype.toExponential=function(a){var d=a?this.roundDigits(a):
this.clone(),b=d.coefficients,d=d.exponent;b.length<a&&(b=b.concat(l(a-b.length)));a=b.shift();return this.sign+a+(0<b.length?"."+b.join(""):"")+"e"+(0<=d?"+":"")+d};a.prototype.toPrecision=function(a,d){var b=d&&void 0!==d.lower?d.lower:.001,c=d&&void 0!==d.upper?d.upper:1E5,h=Math.abs(Math.pow(10,this.exponent));if(h<b||h>=c)return this.toExponential(a);c=a?this.roundDigits(a):this.clone();b=c.coefficients;c=c.exponent;b.length<a&&(b=b.concat(l(a-b.length)));b=b.concat(l(c-b.length+1+(b.length<
a?a-b.length:0)));b=l(-c).concat(b);c=0<c?c:0;c<b.length-1&&b.splice(c+1,0,".");return this.sign+b.join("")};a.prototype.clone=function(){var f=new a("0");f.sign=this.sign;f.coefficients=this.coefficients.slice(0);f.exponent=this.exponent;return f};a.prototype.roundDigits=function(a){for(var d=this.clone(),b=d.coefficients;0>=a;)b.unshift(0),d.exponent++,a++;if(b.length>a&&5<=b.splice(a)[0])for(--a,b[a]++;10===b[a];)b.pop(),0===a&&(b.unshift(0),d.exponent++,a++),a--,b[a]++;return d};m.exports=a},
function(m,e,a){var l=a(5).lazy,f=a(5).isFactory,d=a(5).traverse,b=a(5).extend,c=a(11);e.math=!0;e.name="import";e.factory=function(a,e,r,n,g){function A(b,a){var g=arguments.length;if(1!=g&&2!=g)throw new c("import",g,1,2);a||(a={});if(f(b))p(b,a);else if(Array.isArray(b))b.forEach(function(b){A(b,a)});else if("object"===typeof b)for(var k in b)b.hasOwnProperty(k)&&(g=b[k],"function"==typeof g||"number"===typeof g||"string"===typeof g||"boolean"===typeof g||null===g||g&&!0===g.isUnit||g&&!0===g.isComplex?
q(k,g,a):f(b)?p(b,a):A(g,a));else if(!a.silent)throw new TypeError("Factory, Object, or Array expected");}function q(a,c,d){d.wrap&&"function"===typeof c&&(c=k(c));if(B(g[a])&&B(c))c=d.override?n(b({},g[a].signatures,c.signatures)):n(g[a],c),g[a]=c,t(a,c),g.emit("import",a,function(){return c});else if(void 0===g[a]||d.override)g[a]=c,t(a,c),g.emit("import",a,function(){return c});else if(!d.silent)throw Error('Cannot import "'+a+'": already exists');}function t(b,a){a&&"function"===typeof a.transform&&
(g.expression.transform[b]=a.transform)}function k(b){var a=function(){for(var a=[],c=0,k=arguments.length;c<k;c++){var d=arguments[c];a[c]=d&&d.valueOf()}return b.apply(g,a)};b.transform&&(a.transform=b.transform);return a}function p(a,c){if("string"===typeof a.name){var k=a.name,h=a.path?d(g,a.path):g,t=h.hasOwnProperty(k)?h[k]:void 0,e=function(){var g=r(a);if(B(t)&&B(g))return g=c.override?n(b({},t.signatures,g.signatures)):n(t,g);if(void 0===t||c.override)return g;if(!c.silent)throw Error('Cannot import "'+
k+'": already exists');};!1!==a.lazy?l(h,k,e):h[k]=e();g.emit("import",k,e,a.path)}else r(a)}function B(b){return"function"===typeof b&&"object"===typeof b.signatures}return A};e.lazy=!0},function(m,e){function a(e,f,d,b){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");this.fn=e;this.count=f;this.min=d;this.max=b;this.message="Wrong number of arguments in function "+e+" ("+f+" provided, "+d+(void 0!=b?"-"+b:"")+" expected)";this.stack=Error().stack}
a.prototype=Error();a.prototype.constructor=Error;a.prototype.name="ArgumentsError";a.prototype.isArgumentsError=!0;m.exports=a},function(m,e,a){var l=a(5);e.name="config";e.math=!0;e.factory=function(a,d,b,c,h){return function(b){if(b){var a=l.clone(d);l.deepExtend(d,b);b=l.clone(d);h.emit("config",b,a);return b}return l.clone(d)}}},function(m,e,a){var l=a(14).string.isString;e.name="Matrix";e.path="type";e.factory=function(a,d,b,c){function h(){if(!(this instanceof h))throw new SyntaxError("Constructor must be called with the new operator");
}h.prototype.type="Matrix";h.prototype.isMatrix=!0;h.storage=function(b){if(!l(b))throw new TypeError("format must be a string value");var a=h._storage[b];if(!a)throw new SyntaxError("Unsupported matrix storage format: "+b);return a};h._storage={};h.prototype.storage=function(){throw Error("Cannot invoke storage on a Matrix interface");};h.prototype.datatype=function(){throw Error("Cannot invoke datatype on a Matrix interface");};h.prototype.create=function(b,a){throw Error("Cannot invoke create on a Matrix interface");
};h.prototype.subset=function(b,a,c){throw Error("Cannot invoke subset on a Matrix interface");};h.prototype.get=function(b){throw Error("Cannot invoke get on a Matrix interface");};h.prototype.set=function(b,a,c){throw Error("Cannot invoke set on a Matrix interface");};h.prototype.resize=function(b,a){throw Error("Cannot invoke resize on a Matrix interface");};h.prototype.clone=function(){throw Error("Cannot invoke clone on a Matrix interface");};h.prototype.size=function(){throw Error("Cannot invoke size on a Matrix interface");
};h.prototype.map=function(b,a){throw Error("Cannot invoke map on a Matrix interface");};h.prototype.forEach=function(b){throw Error("Cannot invoke forEach on a Matrix interface");};h.prototype.toArray=function(){throw Error("Cannot invoke toArray on a Matrix interface");};h.prototype.valueOf=function(){throw Error("Cannot invoke valueOf on a Matrix interface");};h.prototype.format=function(b){throw Error("Cannot invoke format on a Matrix interface");};h.prototype.toString=function(){throw Error("Cannot invoke toString on a Matrix interface");
};return h}},function(m,e,a){e.array=a(15);e["boolean"]=a(21);e["function"]=a(22);e.number=a(8);e.object=a(5);e.string=a(17);e.types=a(16);e.emitter=a(3)},function(m,e,a){function l(b,a,c){var d=b.length;if(d!=a[c])throw new r(d,a[c]);if(c<a.length-1){var k=c+1;for(c=0;c<d;c++){if(!Array.isArray(b[c]))throw new r(a.length-1,a.length,"<");l(b[c],a,k)}}else for(c=0;c<d;c++)if(Array.isArray(b[c]))throw new r(a.length+1,a.length,">");}function f(b,a,c,d){var k,h=a[c],n=Math.min(b.length,h);b.length=h;
if(c<a.length-1){var r=c+1;for(c=0;c<n;c++)k=b[c],Array.isArray(k)||(k=[k],b[c]=k),f(k,a,r,d);for(c=n;c<h;c++)k=[],b[c]=k,f(k,a,r,d)}else{for(c=0;c<n;c++)for(;Array.isArray(b[c]);)b[c]=b[c][0];if(d!==e.UNINITIALIZED)for(c=n;c<h;c++)b[c]=u.clone(d)}}function d(b,a,c){var h;if(c<a){var k=c+1;c=0;for(h=b.length;c<h;c++)b[c]=d(b[c],a,k)}else for(;Array.isArray(b);)b=b[0];return b}function b(a,c,d){var h;if(Array.isArray(a)){var k=d+1;d=0;for(h=a.length;d<h;d++)a[d]=b(a[d],c,k)}else for(;d<c;d++)a=[a];
return a}var c=a(8),h=a(17),u=a(5);a(16);var r=a(19),n=a(20);e.size=function(b){for(var a=[];Array.isArray(b);)a.push(b.length),b=b[0];return a};e.validate=function(b,a){if(0==a.length){if(Array.isArray(b))throw new r(b.length,0);}else l(b,a,0)};e.validateIndex=function(b,a){if(!c.isNumber(b)||!c.isInteger(b))throw new TypeError("Index must be an integer (value: "+b+")");if(0>b)throw new n(b);if(void 0!==a&&b>=a)throw new n(b,a);};e.UNINITIALIZED={};e.resize=function(b,a,d){if(!Array.isArray(b)||
!Array.isArray(a))throw new TypeError("Array expected");if(0===a.length)throw Error("Resizing to scalar is not supported");a.forEach(function(b){if(!c.isNumber(b)||!c.isInteger(b)||0>b)throw new TypeError("Invalid size, must contain positive integers (size: "+h.format(a)+")");});f(b,a,0,void 0!==d?d:0);return b};e.squeeze=function(b,a){for(var c=a||e.size(b);Array.isArray(b)&&1===b.length;)b=b[0],c.shift();for(var h=c.length;1===c[h-1];)h--;h<c.length&&(b=d(b,h,0),c.length=h);return b};e.unsqueeze=
function(a,c,d,h){h=h||e.size(a);if(d)for(var k=0;k<d;k++)a=[a],h.unshift(1);for(a=b(a,c,0);h.length<c;)h.push(1);return a};e.flatten=function(b){if(!Array.isArray(b))return b;var a=[];b.forEach(function t(b){Array.isArray(b)?b.forEach(t):a.push(b)});return a};e.isArray=Array.isArray},function(m,e){e.type=function(a){var e=typeof a;return"object"===e?null===a?"null":a instanceof Boolean?"boolean":a instanceof Number?"number":a instanceof String?"string":Array.isArray(a)?"Array":a instanceof Date?
"Date":a instanceof RegExp?"RegExp":"Object":"function"===e?"Function":e}},function(m,e,a){function l(b,a){if(Array.isArray(b)){for(var d="[",f=b.length,r=0;r<f;r++)0!=r&&(d+=", "),d+=l(b[r],a);return d+"]"}return e.format(b,a)}var f=a(8).format,d=a(18).format;e.isString=function(b){return"string"===typeof b};e.endsWith=function(b,a){return b.substring(b.length-a.length,b.length)===a};e.format=function(b,a){return"number"===typeof b?f(b,a):b&&!0===b.isBigNumber?d(b,a):b&&!0===b.isFraction?a&&"decimal"===
a.fraction?b.toString():b.s*b.n+"/"+b.d:Array.isArray(b)?l(b,a):e.isString(b)?'"'+b+'"':"function"===typeof b?b.syntax?b.syntax+"":"function":"object"===typeof b?"function"===typeof b.format?b.format(a):b.toString():String(b)}},function(m,e){e.format=function(a,l){if("function"===typeof l)return l(a);if(!a.isFinite())return a.isNaN()?"NaN":a.gt(0)?"Infinity":"-Infinity";var f="auto",d=void 0;void 0!==l&&(l.notation&&(f=l.notation),"number"===typeof l?d=l:l.precision&&(d=l.precision));switch(f){case "fixed":return e.toFixed(a,
d);case "exponential":return e.toExponential(a,d);case "auto":var f=.001,b=1E5;l&&l.exponential&&(void 0!==l.exponential.lower&&(f=l.exponential.lower),void 0!==l.exponential.upper&&(b=l.exponential.upper));a.constructor.config({toExpNeg:Math.round(Math.log(f)/Math.LN10),toExpPos:Math.round(Math.log(b)/Math.LN10)});if(a.isZero())return"0";var c=a.abs();return(c.gte(f)&&c.lt(b)?a.toSignificantDigits(d).toFixed():e.toExponential(a,d)).replace(/((\.\d*?)(0+))($|e)/,function(b,a,c,d,g){return"."!==c?
c+g:g});default:throw Error('Unknown notation "'+f+'". Choose "auto", "exponential", or "fixed".');}};e.toExponential=function(a,e){return void 0!==e?a.toExponential(e-1):a.toExponential()};e.toFixed=function(a,e){return a.toFixed(e||0)}},function(m,e){function a(e,f,d){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");this.actual=e;this.expected=f;this.relation=d;this.message="Dimension mismatch ("+(Array.isArray(e)?"["+e.join(", ")+"]":e)+" "+(this.relation||
"!=")+" "+(Array.isArray(f)?"["+f.join(", ")+"]":f)+")";this.stack=Error().stack}a.prototype=new RangeError;a.prototype.constructor=RangeError;a.prototype.name="DimensionError";a.prototype.isDimensionError=!0;m.exports=a},function(m,e){function a(e,f,d){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");this.index=e;3>arguments.length?(this.min=0,this.max=f):(this.min=f,this.max=d);this.message=void 0!==this.min&&this.index<this.min?"Index out of range ("+
this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?"Index out of range ("+this.index+" > "+(this.max-1)+")":"Index out of range ("+this.index+")";this.stack=Error().stack}a.prototype=new RangeError;a.prototype.constructor=RangeError;a.prototype.name="IndexError";a.prototype.isIndexError=!0;m.exports=a},function(m,e){e.isBoolean=function(a){return"boolean"==typeof a}},function(m,e){e.memoize=function(a,e){return function d(){"object"!==typeof d.cache&&(d.cache={});for(var b=[],c=
0;c<arguments.length;c++)b[c]=arguments[c];c=e?e(b):JSON.stringify(b);return c in d.cache?d.cache[c]:d.cache[c]=a.apply(a,b)}}},function(m,e,a){var l=a(14),f=a(19),d=l.string,b=l.array,c=l.object;m=l.number;var h=Array.isArray,u=m.isNumber,r=m.isInteger,n=d.isString,g=b.validateIndex;e.name="DenseMatrix";e.path="type";e.factory=function(e,q,t,k){function p(a,g){if(!(this instanceof p))throw new SyntaxError("Constructor must be called with the new operator");if(g&&!n(g))throw Error("Invalid datatype: "+
g);if(a&&!0===a.isMatrix)"DenseMatrix"===a.type?(this._data=c.clone(a._data),this._size=c.clone(a._size)):(this._data=a.toArray(),this._size=a.size()),this._datatype=g||a._datatype;else if(a&&h(a.data)&&h(a.size))this._data=a.data,this._size=a.size,this._datatype=g||a.datatype;else{if(h(a))this._data=w(a),this._size=b.size(this._data),b.validate(this._data,this._size);else{if(a)throw new TypeError("Unsupported type of data ("+l.types.type(a)+")");this._data=[];this._size=[0]}this._datatype=g}}function B(b,
a,c,g){var d=g==c-1,k=a.dimension(g);return d?k.map(function(a){return b[a]}).valueOf():k.map(function(d){return B(b[d],a,c,g+1)}).valueOf()}function v(a,g,d,k){if(!g||!0!==g.isIndex)throw new TypeError("Invalid index");var h=g.size(),e=g.isScalar(),n;d&&!0===d.isMatrix?(n=d.size(),d=d.valueOf()):n=b.size(d);if(e){if(0!==n.length)throw new TypeError("Scalar expected");a.set(g.min(),d,k)}else{if(h.length<a._size.length)throw new f(h.length,a._size.length,"<");if(n.length<h.length){for(var t=e=0;1===
h[e]&&1===n[e];)e++;for(;1===h[e];)t++,e++;d=b.unsqueeze(d,h.length,t,n)}if(!c.deepEqual(h,n))throw new f(h,n,">");n=g.max().map(function(b){return b+1});x(a,n,k);y(a._data,g,d,h.length,0)}return a}function y(b,a,c,d,k){var h=k==d-1,e=a.dimension(k);h?e.forEach(function(a,d){g(a);b[a]=c[d[0]]}):e.forEach(function(h,e){g(h);y(b[h],a,c[e[0]],d,k+1)})}function x(b,a,g){for(var d=c.clone(b._size),k=!1;d.length<a.length;)d.push(0),k=!0;for(var h=0,e=a.length;h<e;h++)a[h]>d[h]&&(d[h]=a[h],k=!0);k&&z(b,
d,g)}function w(b){for(var a=0,c=b.length;a<c;a++){var g=b[a];h(g)?b[a]=w(g):g&&!0===g.isMatrix&&(b[a]=w(g.valueOf()))}return b}q=t(a(13));p.prototype=new q;p.prototype.type="DenseMatrix";p.prototype.isDenseMatrix=!0;p.prototype.storage=function(){return"dense"};p.prototype.datatype=function(){return this._datatype};p.prototype.create=function(b,a){return new p(b,a)};p.prototype.subset=function(b,a,c){switch(arguments.length){case 1:var d;if(!b||!0!==b.isIndex)throw new TypeError("Invalid index");
if(b.isScalar())d=this.get(b.min());else{d=b.size();if(d.length!=this._size.length)throw new f(d.length,this._size.length);for(var k=b.min(),h=b.max(),e=0,n=this._size.length;e<n;e++)g(k[e],this._size[e]),g(h[e],this._size[e]);d=new p(B(this._data,b,d.length,0),this._datatype)}return d;case 2:case 3:return v(this,b,a,c);default:throw new SyntaxError("Wrong number of arguments");}};p.prototype.get=function(b){if(!h(b))throw new TypeError("Array expected");if(b.length!=this._size.length)throw new f(b.length,
this._size.length);for(var a=0;a<b.length;a++)g(b[a],this._size[a]);for(var a=this._data,d=0,k=b.length;d<k;d++){var e=b[d];g(e,a.length);a=a[e]}return c.clone(a)};p.prototype.set=function(b,a,c){if(!h(b))throw new TypeError("Array expected");if(b.length<this._size.length)throw new f(b.length,this._size.length,"<");var d,k;d=b.map(function(b){return b+1});x(this,d,c);var e=this._data;c=0;for(d=b.length-1;c<d;c++)k=b[c],g(k,e.length),e=e[k];k=b[b.length-1];g(k,e.length);e[k]=a;return this};p.prototype.resize=
function(b,a,c){if(!h(b))throw new TypeError("Array expected");c=c?this.clone():this;return z(c,b,a)};var z=function(a,d,g){if(0===d.length){for(a=a._data;h(a);)a=a[0];return c.clone(a)}a._size=c.clone(d);a._data=b.resize(a._data,a._size,g);return a};p.prototype.clone=function(){return new p({data:c.clone(this._data),size:c.clone(this._size),datatype:this._datatype})};p.prototype.size=function(){return this._size};p.prototype.map=function(b){var a=this,d=function(c,g){return h(c)?c.map(function(b,
a){return d(b,g.concat(a))}):b(c,g,a)};return new p({data:d(this._data,[]),size:c.clone(this._size),datatype:this._datatype})};p.prototype.forEach=function(b){var a=this,c=function(d,g){h(d)?d.forEach(function(b,a){c(b,g.concat(a))}):b(d,g,a)};c(this._data,[])};p.prototype.toArray=function(){return c.clone(this._data)};p.prototype.valueOf=function(){return this._data};p.prototype.format=function(b){return d.format(this._data,b)};p.prototype.toString=function(){return d.format(this._data)};p.prototype.toJSON=
function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}};p.prototype.diagonal=function(b){if(b){if(!0===b.isBigNumber&&(b=b.toNumber()),!u(b)||!r(b))throw new TypeError("The parameter k must be an integer number");}else b=0;var a=0<b?b:0;b=0>b?-b:0;for(var d=Math.min(this._size[0]-b,this._size[1]-a),g=[],k=0;k<d;k++)g[k]=c.clone(this._data[k+b][k+a]);return new p({data:g,size:[d],datatype:this._datatype})};p.diagonal=function(a,c,d,g,f){if(!h(a))throw new TypeError("Array expected, size parameter");
if(2!==a.length)throw Error("Only two dimensions matrix are supported");a=a.map(function(b){b&&!0===b.isBigNumber&&(b=b.toNumber());if(!u(b)||!r(b)||1>b)throw Error("Size values must be positive integers");return b});if(d){if(d&&!0===d.isBigNumber&&(d=d.toNumber()),!u(d)||!r(d))throw new TypeError("The parameter k must be an integer number");}else d=0;g&&n(f)&&(g=k.convert(g,f));f=0<d?d:0;d=0>d?-d:0;var t=a[0],y=a[1],q=Math.min(t-d,y-f),l;if(h(c)){if(c.length!==q)throw Error("Invalid value array length");
l=function(b){return c[b]}}else if(c&&!0===c.isMatrix){l=c.size();if(1!==l.length||l[0]!==q)throw Error("Invalid matrix length");l=function(b){return c.get([b])}}else l=function(){return c};g||(g=l(0)&&!0===l(0).isBigNumber?new e.BigNumber(0):0);var v=[];if(0<a.length)for(v=b.resize(v,a,g),a=0;a<q;a++)v[a+d][a+f]=l(a);return new p({data:v,size:[t,y]})};p.fromJSON=function(b){return new p(b)};p.prototype.swapRows=function(b,a){if(!(u(b)&&r(b)&&u(a)&&r(a)))throw Error("Row index must be positive integers");
if(2!==this._size.length)throw Error("Only two dimensional matrix is supported");g(b,this._size[0]);g(a,this._size[0]);p._swapRows(b,a,this._data);return this};p._swapRows=function(b,a,c){var d=c[b];c[b]=c[a];c[a]=d};e.Matrix._storage.dense=p;return e.Matrix._storage["default"]=p};e.lazy=!1},function(m,e,a){var l=a(25),f=a(26);e.name="sin";e.factory=function(d,b,c,h){var e=h.find(c(a(31)),["number"]),r=h.find(c(a(33)),["number"]),n=h("sin",{number:Math.sin,Complex:function(b){return new d.Complex(Math.sin(b.re)*
e(-b.im),Math.cos(b.re)*r(b.im))},BigNumber:function(b){return f(b,d.BigNumber,1,!1)},Unit:function(b){if(!b.hasBase(d.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sin is no angle");return Math.sin(b.value)},"Array | Matrix":function(b){return l(b,n,!0)}});n.toTex="\\sin\\left(${args[0]}\\right)";return n}},function(m,e){m.exports=function l(e,d,b){return e&&"function"===typeof e.map?e.map(function(c){return l(c,d,b)}):d(e)}},function(m,e,a){var l=a(27),f=a(30);m.exports=function(a,
b,c,h){if(a.isNaN()||!a.isFinite())return new b(NaN);var e=b.precision,r=new b(a);if(a=r.isNegative())r.s=-r.s;var n=e+(Math.log(e)|0)+3;b.config({precision:n});r=l(r,b.constructor({precision:n}),c);r[0].constructor=b;if(r[1])return r=r[0],h&&r.isZero()&&(r=new b(Infinity)),b.config({precision:e}),r;r=r[0];if(c){c=f(r.div(3125),c);b.config({precision:Math.min(n,e+15)});for(var r=new b(5),g=new b(16),A=new b(20),q=0;5>q;++q){var n=c.times(c),t=n.times(c),n=t.times(n);c=g.times(n).minus(A.times(t)).plus(r.times(c))}a&&
(c.s=-c.s)}else for(r.abs().lt(b.ONE)?(g=64,a=3):(g=256,a=4),c=f(r.div(g),c),b.config({precision:Math.min(n,e+8)}),r=new b(8);0<a;--a)n=c.times(c),c=n.times(n),c=r.times(c.minus(n)).plus(b.ONE);h&&(c=c.e<=-e?new b(Infinity):b.ONE.div(c));b.config({precision:e});return c.toDP(e-1)}},function(m,e,a){var l=a(28);m.exports=function(a,d,b){var c=l.pi(d.constructor({precision:d.precision+2})),e=l.tau(d);if(a.abs().lte(c.toDP(a.dp())))return[a,!1];if(0==a.div(c.toDP(a.dp())).toNumber()%2)return[new d(b^
1),!0];var u=a.mod(e);if(u.toDP(a.dp(),1).isZero())return[new d(b^1),!0];u.gt(c)&&(b?(u=u.minus(c),u.s=-u.s):u=e.minus(u));u.constructor=a.constructor;return[u,!1]}},function(m,e,a){function l(a){return a[0].precision}m=a(22).memoize;var f=a(29);e.e=m(function(a){return(new a(1)).exp()},l);e.phi=m(function(a){return(new a(1)).plus((new a(5)).sqrt()).div(2)},l);e.pi=m(function(a){var b=a.constructor({precision:a.precision+4}),b=(new b(4)).times(f((new b(1)).div(5))).minus(f((new b(1)).div(239)));return(new a(4)).times(b)},
l);e.tau=m(function(a){var b=e.pi(a.constructor({precision:a.precision+2}));return(new a(2)).times(b)},l)},function(m,e){m.exports=function(a){for(var e=a,f=NaN,d=a.times(a),b=!0,c=3;!e.equals(f);c+=2)a=a.times(d),f=e,e=(b=!b)?e.plus(a.div(c)):e.minus(a.div(c));return e}},function(m,e){m.exports=function(a,e){for(var f=a.constructor.ONE,d=a,b=NaN,c=a.times(a),h=e?d:d=f,u=!0,r=e;!d.equals(b);r+=2)h=h.times(c),f=f.times(r+1).times(r+2),b=d,d=(u=!u)?d.plus(h.div(f)):d.minus(h.div(f));return d}},function(m,
e,a){function l(b){return(Math.exp(b)+Math.exp(-b))/2}var f=a(25),d=a(32);e.name="cosh";e.factory=function(b,a,e,u){var r=u("cosh",{number:l,Complex:function(a){var c=Math.exp(a.re),d=Math.exp(-a.re);return new b.Complex(Math.cos(a.im)*(c+d)/2,Math.sin(a.im)*(c-d)/2)},BigNumber:function(a){return d(a,b.BigNumber,!1,!1)},Unit:function(a){if(!a.hasBase(b.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cosh is no angle");return l(a.value)},"Array | Matrix":function(b){return f(b,r)}});r.toTex=
"\\cosh\\left(${args[0]}\\right)";return r}},function(m,e){m.exports=function(a,e,f,d){if(a.isNaN())return new e(NaN);if(!a.isFinite())return d?new e(0):new e(f?a:Infinity);var b=e.precision;e.config({precision:b+4});a=new e(a);a.constructor=e;a=a.exp();a=f?a.minus(e.ONE.div(a)):a.plus(e.ONE.div(a));a=d?(new e(2)).div(a):a.div(2);e.config({precision:b});return new e(a.toPrecision(b))}},function(m,e,a){function l(b){return 1>Math.abs(b)?b+b*b*b/6+b*b*b*b*b/120:(Math.exp(b)-Math.exp(-b))/2}var f=a(25),
d=a(32);e.name="sinh";e.factory=function(b,a,e,u){var r=u("sinh",{number:l,Complex:function(a){var c=Math.cos(a.im),d=Math.sin(a.im),e=Math.exp(a.re);a=Math.exp(-a.re);return new b.Complex(c*(e-a)/2,d*(e+a)/2)},BigNumber:function(a){return d(a,b.BigNumber,!0,!1)},Unit:function(a){if(!a.hasBase(b.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sinh is no angle");return l(a.value)},"Array | Matrix":function(a){return f(a,r,!0)}});r.toTex="\\sinh\\left(${args[0]}\\right)";return r}},function(m,
e,a){var l=a(25),f=a(26);e.name="cos";e.factory=function(d,b,c,e){var u=e.find(c(a(31)),["number"]),r=e.find(c(a(33)),["number"]),n=e("cos",{number:Math.cos,Complex:function(a){return new d.Complex(Math.cos(a.re)*u(-a.im),Math.sin(a.re)*r(-a.im))},BigNumber:function(a){return f(a,d.BigNumber,0,!1)},Unit:function(a){if(!a.hasBase(d.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cos is no angle");return Math.cos(a.value)},"Array | Matrix":function(a){return l(a,n)}});n.toTex="\\cos\\left(${args[0]}\\right)";
return n}},function(m,e,a){var l=a(25);e.name="sqrt";e.factory=function(a,d,b,c){function e(b){return 0<=b||d.predictable?Math.sqrt(b):u(new a.Complex(b,0))}function u(b){var c=Math.sqrt(b.re*b.re+b.im*b.im),d;d=0<=b.re?.5*Math.sqrt(2*(c+b.re)):Math.abs(b.im)/Math.sqrt(2*(c-b.re));c=0>=b.re?.5*Math.sqrt(2*(c-b.re)):Math.abs(b.im)/Math.sqrt(2*(c+b.re));return 0<=b.im?new a.Complex(d,c):new a.Complex(d,-c)}var r=c("sqrt",{number:e,Complex:u,BigNumber:function(a){return!a.isNegative()||d.predictable?
a.sqrt():e(a.toNumber())},"Array | Matrix":function(a){return l(a,r,!0)}});r.toTex="\\sqrt{${args[0]}}";return r}},function(m,e,a){e.name="norm";e.factory=function(e,f,d,b){function c(a,b){var d=a.size();if(1==d.length){if(b===Number.POSITIVE_INFINITY||"inf"===b){var k=0;a.forEach(function(a){a=h(a);q(a,k)&&(k=a)},!0);return k}if(b===Number.NEGATIVE_INFINITY||"-inf"===b){var e;a.forEach(function(a){a=h(a);if(!e||t(a,e))e=a},!0);return e||0}if("fro"===b)return c(a,2);if("number"===typeof b&&!isNaN(b)){if(!A(b,
0)){var f=0;a.forEach(function(a){f=u(r(h(a),b),f)},!0);return r(f,1/b)}return Number.POSITIVE_INFINITY}throw Error("Unsupported parameter value");}if(2==d.length){if(1===b){var v=[],l=0;a.forEach(function(a,b){var c=b[1],d=u(v[c]||0,h(a));q(d,l)&&(l=d);v[c]=d},!0);return l}if(b===Number.POSITIVE_INFINITY||"inf"===b){var m=[],H=0;a.forEach(function(a,b){var c=b[0],d=u(m[c]||0,h(a));q(d,H)&&(H=d);m[c]=d},!0);return H}if("fro"===b)return n(p(g(B(a),a)));if(2===b)throw Error("Unsupported parameter value, missing implementation of matrix singular value decomposition");
throw Error("Unsupported parameter value");}}var h=d(a(37)),u=d(a(38)),r=d(a(48)),n=d(a(35)),g=d(a(53)),A=d(a(44)),q=d(a(56)),t=d(a(60)),k=d(a(39)),p=d(a(61)),B=d(a(62));e=b.find(h,["Complex"]);var v=b("norm",{number:Math.abs,Complex:e,BigNumber:function(a){return a.abs()},"boolean | null":function(a){return Math.abs(a)},Array:function(a){return c(k(a),2)},Matrix:function(a){return c(a,2)},"number | Complex | BigNumber | boolean | null, number | BigNumber | string":function(a){return v(a)},"Array, number | BigNumber | string":function(a,
b){return c(k(a),b)},"Matrix, number | BigNumber | string":function(a,b){return c(a,b)}});v.toTex={1:"\\left\\|${args[0]}\\right\\|",2:"\\mathrm{${name}}\\left(${args}\\right)"};return v}},function(m,e,a){var l=a(25);e.name="abs";e.factory=function(a,d,b,c){var e=c("abs",{number:Math.abs,Complex:function(a){var b=Math.abs(a.re);a=Math.abs(a.im);if(1E3>b&&1E3>a)return Math.sqrt(b*b+a*a);if(b>=a)return a/=b,b*Math.sqrt(1+a*a);b/=a;return a*Math.sqrt(1+b*b)},BigNumber:function(a){return a.abs()},Fraction:function(a){return a.abs()},
"Array | Matrix":function(a){return l(a,e,!0)}});e.toTex="\\left|${args[0]}\\right|";return e}},function(m,e,a){var l=a(5).extend;e.name="add";e.factory=function(e,d,b,c){var h=b(a(39)),u=b(a(40));e=a(41);var r=b(a(42)),n=b(a(43)),g=b(a(45)),A=b(a(46)),q=b(a(47)),t=c("add",l({"Matrix, Matrix":function(a,b){var c;switch(a.storage()){case "sparse":switch(b.storage()){case "sparse":c=n(a,b,u);break;default:c=r(b,a,u,!0)}break;default:switch(b.storage()){case "sparse":c=r(a,b,u,!1);break;default:c=A(a,
b,u)}}return c},"Array, Array":function(a,b){return t(h(a),h(b)).valueOf()},"Array, Matrix":function(a,b){return t(h(a),b)},"Matrix, Array":function(a,b){return t(a,h(b))},"Matrix, any":function(a,b){var c;switch(a.storage()){case "sparse":c=g(a,b,u,!1);break;default:c=q(a,b,u,!1)}return c},"any, Matrix":function(a,b){var c;switch(b.storage()){case "sparse":c=g(b,a,u,!0);break;default:c=q(b,a,u,!0)}return c},"Array, any":function(a,b){return q(h(a),b,u,!1).valueOf()},"any, Array":function(a,b){return q(h(b),
a,u,!0).valueOf()}},u.signatures));t.toTex="\\left(${args[0]}"+e.operators.add+"${args[1]}\\right)";return t}},function(m,e){e.name="matrix";e.factory=function(a,e,f,d){function b(b,d,e){return new (a.Matrix.storage(d||"default"))(b,e)}e=d("matrix",{"":function(){return b([])},string:function(a){return b([],a)},"string, string":function(a,d){return b([],a,d)},Array:function(a){return b(a)},Matrix:function(a){return b(a,a.storage())},"Array | Matrix, string":b,"Array | Matrix, string, string":b});
e.toTex={0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"};return e}},function(m,e){e.factory=function(a,e,f,d){return d("add",{"number, number":function(a,c){return a+c},"Complex, Complex":function(b,c){return new a.Complex(b.re+c.re,b.im+c.im)},"BigNumber, BigNumber":function(a,c){return a.plus(c)},"Fraction, Fraction":function(a,c){return a.add(c)},"Unit, Unit":function(a,c){if(null==a.value)throw Error("Parameter x contains a unit with undefined value");
if(null==c.value)throw Error("Parameter y contains a unit with undefined value");if(!a.equalBase(c))throw Error("Units do not match");var d=a.clone();d.value+=c.value;d.fixPrefix=!1;return d}})}},function(m,e){e.symbols={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",
Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega","true":"\\mathrm{True}","false":"\\mathrm{False}",
i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"};e.operators={transpose:"^\\top",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",
bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"};e.defaultTemplate="\\mathrm{${name}}\\left(${args}\\right)";var a={deg:"^\\circ"};e.toSymbol=function(l,f){if("undefined"===typeof f?0:f)return a.hasOwnProperty(l)?a[l]:"\\mathrm{"+l+"}";if(e.symbols.hasOwnProperty(l))return e.symbols[l];if(-1!==l.indexOf("_")){var d=l.indexOf("_");return e.toSymbol(l.substring(0,d))+"_{"+e.toSymbol(l.substring(d+1))+"}"}return l}},function(m,e,a){var l=a(19);e.name="algorithm01";
e.factory=function(a,d,b,c){var e=a.DenseMatrix;return function(a,b,d,g){var f=a._data,q=a._size,t=a._datatype;a=b._values;var k=b._index,p=b._ptr,B=b._size,v=b._datatype;if(q.length!==B.length)throw new l(q.length,B.length);if(q[0]!==B[0]||q[1]!==B[1])throw new RangeError("Dimension mismatch. Matrix A ("+q+") must match Matrix B ("+B+")");if(!a)throw Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");b=q[0];q=q[1];d=(t="string"===typeof t&&t===v?t:void 0)?c.find(d,[t,t]):
d;for(var y=[],v=0;v<b;v++)y[v]=[];for(var x=[],w=[],B=0;B<q;B++){for(var z=B+1,m=p[B+1],G=p[B];G<m;G++)v=k[G],x[v]=g?d(a[G],f[v][B]):d(f[v][B],a[G]),w[v]=z;for(v=0;v<b;v++)y[v][B]=w[v]===z?x[v]:f[v][B]}return new e({data:y,size:[b,q],datatype:t})}}},function(m,e,a){var l=a(19);e.name="algorithm04";e.factory=function(e,d,b,c){var h=b(a(44)),u=e.SparseMatrix;return function(a,b,d){var e=a._values,f=a._index,t=a._ptr,k=a._size,p=a._datatype;a=b._values;var B=b._index,v=b._ptr,y=b._size,x=b._datatype;
if(k.length!==y.length)throw new l(k.length,y.length);if(k[0]!==y[0]||k[1]!==y[1])throw new RangeError("Dimension mismatch. Matrix A ("+k+") must match Matrix B ("+y+")");var w=k[0],k=k[1],z;b=h;var y=0,m=d;"string"===typeof p&&p===x&&(z=p,b=c.find(h,[z,z]),y=c.convert(0,z),m=c.find(d,[z,z]));d=e&&a?[]:void 0;p=[];x=[];z=new u({values:d,index:p,ptr:x,size:[w,k],datatype:z});var w=e&&a?[]:void 0,G=e&&a?[]:void 0,E=[],J=[],C,H,F,K;for(H=0;H<k;H++){x[H]=p.length;var I=H+1;C=t[H];K=t[H+1];for(F=C;F<K;F++)C=
f[F],p.push(C),E[C]=I,w&&(w[C]=e[F]);C=v[H];K=v[H+1];for(F=C;F<K;F++)if(C=B[F],E[C]===I){if(w){var L=m(w[C],a[F]);b(L,y)?E[C]=null:w[C]=L}}else p.push(C),J[C]=I,G&&(G[C]=a[F]);if(w&&G)for(F=x[H];F<p.length;)C=p[F],E[C]===I?(d[F]=w[C],F++):J[C]===I?(d[F]=G[C],F++):p.splice(F,1)}x[k]=p.length;return z}}},function(m,e,a){var l=a(8).nearlyEqual;e.factory=function(a,d,b,c){return c("equalScalar",{"boolean, boolean":function(a,b){return a===b},"number, number":function(a,b){return a===b||l(a,b,d.epsilon)},
"BigNumber, BigNumber":function(a,b){return a.eq(b)},"Fraction, Fraction":function(a,b){return a.equals(b)},"Complex, Complex":function(a,b){return(a.re===b.re||l(a.re,b.re,d.epsilon))&&(a.im===b.im||l(a.im,b.im,d.epsilon))},"Unit, Unit":function(a,b){if(!a.equalBase(b))throw Error("Cannot compare units with different base");return a.value===b.value||l(a.value,b.value,d.epsilon)},"string, string":function(a,b){return a===b}})}},function(m,e){e.name="algorithm10";e.factory=function(a,e,f,d){var b=
a.DenseMatrix;return function(a,e,f,r){var n=a._values,g=a._index,l=a._ptr,q=a._size,t=a._datatype;if(!n)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");a=q[0];var q=q[1],k,p=f;"string"===typeof t&&(k=t,e=d.convert(e,k),p=d.find(f,[k,k]));f=[];k=new b({data:f,size:[a,q],datatype:k});for(var t=[],B=[],v=0;v<q;v++){for(var y=v+1,x=l[v+1],w=l[v];w<x;w++){var z=g[w];t[z]=n[w];B[z]=y}for(x=0;x<a;x++)0===v&&(f[x]=[]),f[x][v]=B[x]===y?r?p(e,t[x]):p(t[x],e):e}return k}}},
function(m,e,a){a(14);var l=a(19);e.name="algorithm13";e.factory=function(a,d,b,c){var e=a.DenseMatrix,u=function(a,b,c,d,e,h){var k=[];if(b===c.length-1)for(b=0;b<d;b++)k[b]=a(e[b],h[b]);else for(var f=0;f<d;f++)k[f]=u(a,b+1,c,c[b+1],e[f],h[f]);return k};return function(a,b,d){var f=a._data,q=a._size,t=a._datatype,k=b._data,p=b._size,B=b._datatype;a=[];if(q.length!==p.length)throw new l(q.length,p.length);for(var v=0;v<q.length;v++){if(q[v]!==p[v])throw new RangeError("Dimension mismatch. Matrix A ("+
q+") must match Matrix B ("+p+")");a[v]=q[v]}var y,q=d;"string"===typeof t&&t===B&&(y=t,c.convert(b,y),q=c.find(d,[y,y]));b=0<a.length?u(q,0,a,a[0],f,k):[];return new e({data:b,size:a,datatype:y})}}},function(m,e,a){var l=a(5).clone;e.name="algorithm14";e.factory=function(a,d,b,c){var e=a.DenseMatrix,u=function(a,b,c,d,e,h,k){var f=[];if(b===c.length-1)for(b=0;b<d;b++)f[b]=k?a(h,e[b]):a(e[b],h);else for(var l=0;l<d;l++)f[l]=u(a,b+1,c,c[b+1],e[l],h,k);return f};return function(a,b,d,f){var q=a._data,
t=a._size;a=a._datatype;var k,p=d;"string"===typeof a&&(k=a,b=c.convert(b,k),p=c.find(d,[k,k]));b=0<t.length?u(p,0,t,t[0],q,b,f):[];return new e({data:b,size:l(t),datatype:k})}}},function(m,e,a){var l=a(8).isInteger,f=a(15).size;e.name="pow";e.factory=function(d,b,c,e){function u(a,c){return l(c)||0<=a||b.predictable?Math.pow(a,c):r(new d.Complex(a,0),new d.Complex(c,0))}function r(a,b){return q(p(k(a),b))}function n(a,b){if(!l(b)||0>b)throw new TypeError("For A^b, b must be a positive integer (value is "+
b+")");var c=f(a);if(2!=c.length)throw Error("For A^b, A must be 2 dimensional (A has "+c.length+" dimensions)");if(c[0]!=c[1])throw Error("For A^b, A must be square (size is "+c[0]+"x"+c[1]+")");for(var c=t(c[0]).valueOf(),d=a;1<=b;)1==(b&1)&&(c=p(d,c)),b>>=1,d=p(d,d);return c}function g(a,b){return B(n(a.valueOf(),b))}var A=a(41),q=c(a(50)),t=c(a(49)),k=c(a(51)),p=c(a(53)),B=c(a(39));c=e("pow",{"number, number":u,"Complex, Complex":r,"BigNumber, BigNumber":function(a,c){return c.isInteger()||0<=
a||b.predictable?a.pow(c):r(new d.Complex(a.toNumber(),0),new d.Complex(c.toNumber(),0))},"Fraction, Fraction":function(a,c){if(1!==c.d){if(b.predictable)throw Error("Function pow does not support non-integer exponents for fractions.");return u(a.valueOf(),c.valueOf())}return a.pow(c)},"Array, number":n,"Array, BigNumber":function(a,b){return n(a,b.toNumber())},"Matrix, number":g,"Matrix, BigNumber":function(a,b){return g(a,b.toNumber())}});c.toTex="\\left(${args[0]}\\right)"+A.operators.pow+"{${args[1]}}";
return c}},function(m,e,a){var l=a(15),f=a(8).isInteger;e.name="eye";e.factory=function(d,b,c,e){function u(a,b){switch(a.length){case 0:return b?n(b):[];case 1:return r(a[0],a[0],b);case 2:return r(a[0],a[1],b);default:throw Error("Vector containing two values expected");}}function r(a,b,c){var e=a&&!0===a.isBigNumber?d.BigNumber:b&&!0===b.isBigNumber?d.BigNumber:null;a&&!0===a.isBigNumber&&(a=a.toNumber());b&&!0===b.isBigNumber&&(b=b.toNumber());if(!f(a)||1>a)throw Error("Parameters in function eye must be positive integers");
if(!f(b)||1>b)throw Error("Parameters in function eye must be positive integers");var k=e?new d.BigNumber(1):1,e=e?new e(0):0,h=[a,b];if(c)return d.Matrix.storage(c).diagonal(h,k,0,e);c=l.resize([],h,e);a=a<b?a:b;for(b=0;b<a;b++)c[b][b]=k;return c}var n=c(a(39));c=e("eye",{"":function(){return"matrix"===b.matrix?n([]):[]},string:function(a){return n(a)},"number | BigNumber":function(a){return r(a,a,"matrix"===b.matrix?"default":void 0)},"number | BigNumber, string":function(a,b){return r(a,a,b)},
"number | BigNumber, number | BigNumber":function(a,c){return r(a,c,"matrix"===b.matrix?"default":void 0)},"number | BigNumber, number | BigNumber, string":function(a,b,c){return r(a,b,c)},Array:function(a){return u(a)},"Array, string":function(a,b){return u(a,b)},Matrix:function(a){return u(a.valueOf(),a.storage())},"Matrix, string":function(a,b){return u(a.valueOf(),b)}});c.toTex="\\mathrm{${name}}\\left(${args}\\right)";return c}},function(m,e,a){var l=a(25);e.name="exp";e.factory=function(a,d,
b,c){var e=c("exp",{number:Math.exp,Complex:function(b){var c=Math.exp(b.re);return new a.Complex(c*Math.cos(b.im),c*Math.sin(b.im))},BigNumber:function(a){return a.exp()},"Array | Matrix":function(a){return l(a,e)}});e.toTex="\\exp\\left(${args[0]}\\right)";return e}},function(m,e,a){var l=a(25);e.name="log";e.factory=function(e,d,b,c){function h(a){return new e.Complex(Math.log(Math.sqrt(a.re*a.re+a.im*a.im)),Math.atan2(a.im,a.re))}var u=b(a(52)),r=c("log",{number:function(a){return 0<=a||d.predictable?
Math.log(a):r(new e.Complex(a,0))},Complex:h,BigNumber:function(a){return!a.isNegative()||d.predictable?a.ln():h(new e.Complex(a.toNumber(),0))},"Array | Matrix":function(a){return l(a,r)},"any, any":function(a,b){return u(r(a),r(b))}});r.toTex={1:"\\ln\\left(${args[0]}\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}\\right)"};return r}},function(m,e){e.factory=function(a,e,f,d){return d("divide",{"number, number":function(a,c){return a/c},"Complex, Complex":function(b,c){var d=c.re*c.re+c.im*c.im;
return 0!=d?new a.Complex((b.re*c.re+b.im*c.im)/d,(b.im*c.re-b.re*c.im)/d):new a.Complex(0!=b.re?b.re/0:0,0!=b.im?b.im/0:0)},"BigNumber, BigNumber":function(a,c){return a.div(c)},"Fraction, Fraction":function(a,c){return a.div(c)},"Unit, number":function(a,c){var d=a.clone();d.value=(null===d.value?d._normalize(1):d.value)/c;return d}})}},function(m,e,a){var l=a(5).extend,f=a(15);e.name="multiply";e.factory=function(d,b,c,e){b=a(41);var u=c(a(39)),r=c(a(40)),n=c(a(54)),g=c(a(44)),A=c(a(55)),q=c(a(47)),
t=d.DenseMatrix,k=d.SparseMatrix,p=e("multiply",l({"Array, Array":function(a,b){B(f.size(a),f.size(b));var c=p(u(a),u(b));return c&&!0===c.isMatrix?c.valueOf():c},"Matrix, Matrix":function(a,b){var c=a.size(),d=b.size();B(c,d);if(1===c.length){if(1===d.length){var f=c[0];if(0===f)throw Error("Cannot multiply two empty vectors");var p=a._data,q=a._datatype,l=b._data,u=b._datatype,c=r,d=n;q&&u&&q===u&&"string"===typeof q&&(c=e.find(r,[q,q]),d=e.find(n,[q,q]));q=d(p[0],l[0]);for(u=1;u<f;u++)q=c(q,d(p[u],
l[u]));return q}a:{switch(b.storage()){case "dense":var f=a._data,A=a._datatype,p=b._data,m=b._datatype,c=a._size[0],d=b._size[1],q=r,u=n;A&&m&&A===m&&"string"===typeof A&&(l=A,q=e.find(r,[l,l]),u=e.find(n,[l,l]));A=[];for(m=0;m<d;m++){for(var K=u(f[0],p[0][m]),I=1;I<c;I++)K=q(K,u(f[I],p[I][m]));A[m]=K}f=1===d?A[0]:new t({data:A,size:[d],datatype:l});break a}throw Error("Not implemented");}return f}if(1===d.length){a:{switch(a.storage()){case "dense":f=a._data;d=a._size;A=a._datatype;l=b._data;m=
b._datatype;c=d[0];d=d[1];q=r;u=n;A&&m&&A===m&&"string"===typeof A&&(p=A,q=e.find(r,[p,p]),u=e.find(n,[p,p]));A=[];for(m=0;m<c;m++){for(var K=f[m],I=u(K[0],l[0]),L=1;L<d;L++)I=q(I,u(K[L],l[L]));A[m]=I}f=1===c?A[0]:new t({data:A,size:[c],datatype:p});break a;case "sparse":var q=a._values,u=a._index,A=a._ptr,M=a._datatype;if(!q)throw Error("Cannot multiply Pattern only Matrix times Dense Matrix");var m=b._data,N=b._datatype,p=a._size[0],K=b._size[0],l=[],c=[],d=[],I=r,L=n,fa=g,T=0;M&&N&&M===N&&"string"===
typeof M&&(f=M,I=e.find(r,[f,f]),L=e.find(n,[f,f]),fa=e.find(g,[f,f]),T=e.convert(0,f));for(var M=[],N=[],Q=d[0]=0;Q<K;Q++){var U=m[Q];if(!fa(U,T))for(var na=A[Q+1],V=A[Q];V<na;V++){var W=u[V];N[W]?M[W]=I(M[W],L(U,q[V])):(N[W]=!0,c.push(W),M[W]=L(U,q[V]))}}q=c.length;for(u=0;u<q;u++)l[u]=M[c[u]];d[1]=c.length;f=1===p?1===l.length?l[0]:0:new k({values:l,index:c,ptr:d,size:[p,1],datatype:f});break a}f=void 0}return f}return v(a,b)},"Matrix, Array":function(a,b){return p(a,u(b))},"Array, Matrix":function(a,
b){return p(u(a,b.storage()),b)},"Matrix, any":function(a,b){var c;switch(a.storage()){case "sparse":c=A(a,b,n,!1);break;case "dense":c=q(a,b,n,!1)}return c},"any, Matrix":function(a,b){var c;switch(b.storage()){case "sparse":c=A(b,a,n,!0);break;case "dense":c=q(b,a,n,!0)}return c},"Array, any":function(a,b){return q(u(a),b,n,!1).valueOf()},"any, Array":function(a,b){return q(u(b),a,n,!0).valueOf()}},n.signatures)),B=function(a,b){switch(a.length){case 1:switch(b.length){case 1:if(a[0]!==b[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");
break;case 2:if(a[0]!==b[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+a[0]+") must match Matrix rows ("+b[0]+")");break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+b.length+" dimensions)");}break;case 2:switch(b.length){case 1:if(a[1]!==b[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+a[1]+") must match Vector length ("+b[0]+")");break;case 2:if(a[1]!==b[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+
a[1]+") must match Matrix B rows ("+b[0]+")");break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+b.length+" dimensions)");}break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+a.length+" dimensions)");}},v=function(a,b){switch(a.storage()){case "dense":switch(b.storage()){case "dense":var c;var d=a._data,f=a._size,p=a._datatype,q=b._data,l=b._datatype,v=f[0],u=f[1],B=b._size[1],A,m=r,L=n;p&&l&&p===l&&"string"===typeof p&&(A=
p,m=e.find(r,[A,A]),L=e.find(n,[A,A]));for(var M=[],N=0;N<v;N++){var fa=d[N];M[N]=[];for(var T=0;T<B;T++){for(var Q=L(fa[0],q[0][T]),U=1;U<u;U++)Q=m(Q,L(fa[U],q[U][T]));M[N][T]=Q}}c=1===v&&1===B?M[0][0]:new t({data:M,size:[v,B],datatype:A});return c;case "sparse":var na;var V=a._data,W=a._size,oa=a._datatype,Ja=b._values,tb=b._index,Va=b._ptr,ub=b._size,Wa=b._datatype;if(!Ja)throw Error("Cannot multiply Dense Matrix times Pattern only Matrix");var Ka=W[0],pa=ub[1],R,Xa=r,La=n,Ya=g,Za=0;oa&&Wa&&oa===
Wa&&"string"===typeof oa&&(R=oa,Xa=e.find(r,[R,R]),La=e.find(n,[R,R]),Ya=e.find(g,[R,R]),Za=e.convert(0,R));for(var qa=[],ra=[],Ma=[],vb=new k({values:qa,index:ra,ptr:Ma,size:[Ka,pa],datatype:R}),ga=0;ga<pa;ga++){Ma[ga]=ra.length;var $a=Va[ga],ab=Va[ga+1];if(ab>$a)for(var Na=0,Z=0;Z<Ka;Z++){for(var Oa=Z+1,ha,ia=$a;ia<ab;ia++){var bb=tb[ia];Na!==Oa?(ha=La(V[Z][bb],Ja[ia]),Na=Oa):ha=Xa(ha,La(V[Z][bb],Ja[ia]))}Na!==Oa||Ya(ha,Za)||(ra.push(Z),qa.push(ha))}}Ma[pa]=ra.length;na=1===Ka&&1===pa?1===qa.length?
qa[0]:0:vb;return na}break;case "sparse":switch(b.storage()){case "dense":var cb;var Pa=a._values,wb=a._index,db=a._ptr,sa=a._datatype;if(!Pa)throw Error("Cannot multiply Pattern only Matrix times Dense Matrix");var xb=b._data,eb=b._datatype,fb=a._size[0],yb=b._size[0],ta=b._size[1],S,gb=r,Qa=n,hb=g,ib=0;sa&&eb&&sa===eb&&"string"===typeof sa&&(S=sa,gb=e.find(r,[S,S]),Qa=e.find(n,[S,S]),hb=e.find(g,[S,S]),ib=e.convert(0,S));for(var ua=[],aa=[],va=[],zb=new k({values:ua,index:aa,ptr:va,size:[fb,ta],
datatype:S}),wa=[],jb=[],ba=0;ba<ta;ba++){va[ba]=aa.length;for(var kb=ba+1,ja=0;ja<yb;ja++){var Ra=xb[ja][ba];if(!hb(Ra,ib))for(var Ab=db[ja+1],ka=db[ja];ka<Ab;ka++){var ca=wb[ka];jb[ca]!==kb?(jb[ca]=kb,aa.push(ca),wa[ca]=Qa(Ra,Pa[ka])):wa[ca]=gb(wa[ca],Qa(Ra,Pa[ka]))}}for(var Bb=aa.length,xa=va[ba];xa<Bb;xa++)ua[xa]=wa[aa[xa]]}va[ta]=aa.length;cb=1===fb&&1===ta?1===ua.length?ua[0]:0:zb;return cb;case "sparse":var lb;var Sa=a._values,mb=a._index,ya=a._ptr,za=a._datatype,Ta=b._values,Cb=b._index,nb=
b._ptr,ob=b._datatype,pb=a._size[0],Aa=b._size[1],la=Sa&&Ta,da,qb=r,Ua=n;za&&ob&&za===ob&&"string"===typeof za&&(da=za,qb=e.find(r,[da,da]),Ua=e.find(n,[da,da]));for(var Ba=la?[]:void 0,X=[],Ca=[],Db=new k({values:Ba,index:X,ptr:Ca,size:[pb,Aa],datatype:da}),Da=la?[]:void 0,Ea=[],P,Fa,Ga,ea,rb,sb,O,ma,Y=0;Y<Aa;Y++){Ca[Y]=X.length;var Ha=Y+1;rb=nb[Y];sb=nb[Y+1];for(ea=rb;ea<sb;ea++)if(ma=Cb[ea],la)for(Fa=ya[ma],Ga=ya[ma+1],P=Fa;P<Ga;P++)O=mb[P],Ea[O]!==Ha?(Ea[O]=Ha,X.push(O),Da[O]=Ua(Ta[ea],Sa[P])):
Da[O]=qb(Da[O],Ua(Ta[ea],Sa[P]));else for(Fa=ya[ma],Ga=ya[ma+1],P=Fa;P<Ga;P++)O=mb[P],Ea[O]!==Ha&&(Ea[O]=Ha,X.push(O));if(la)for(var Eb=X.length,Ia=Ca[Y];Ia<Eb;Ia++)Ba[Ia]=Da[X[Ia]]}Ca[Aa]=X.length;lb=1===pb&&1===Aa&&la?1===Ba.length?Ba[0]:0:Db;return lb}}};p.toTex="\\left(${args[0]}"+b.operators.multiply+"${args[1]}\\right)";return p}},function(m,e){e.factory=function(a,e,f,d){return d("multiplyScalar",{"number, number":function(a,c){return a*c},"Complex, Complex":function(b,c){return new a.Complex(b.re*
c.re-b.im*c.im,b.re*c.im+b.im*c.re)},"BigNumber, BigNumber":function(a,c){return a.times(c)},"Fraction, Fraction":function(a,c){return a.mul(c)},"number, Unit":function(a,c){var d=c.clone();d.value=null===d.value?d._normalize(a):d.value*a;return d},"Unit, number":function(a,c){var d=a.clone();d.value=null===d.value?d._normalize(c):d.value*c;return d}})}},function(m,e,a){e.name="algorithm11";e.factory=function(e,f,d,b){var c=d(a(44)),h=e.SparseMatrix;return function(a,d,e,g){var f=a._values,q=a._index,
t=a._ptr,k=a._size,p=a._datatype;if(!f)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var l=k[0],k=k[1],v;a=c;var m=0,x=e;"string"===typeof p&&(v=p,a=b.find(c,[v,v]),m=b.convert(0,v),d=b.convert(d,v),x=b.find(e,[v,v]));e=[];var p=[],w=[];v=new h({values:e,index:p,ptr:w,size:[l,k],datatype:v});for(l=0;l<k;l++){w[l]=p.length;for(var z=t[l+1],D=t[l];D<z;D++){var G=q[D],E=g?x(d,f[D]):x(f[D],d);a(E,m)||(p.push(G),e.push(E))}}w[k]=p.length;return v}}},function(m,e,a){var l=
a(8).nearlyEqual;e.name="larger";e.factory=function(e,d,b,c){var h=b(a(39)),u=b(a(58)),r=b(a(59)),n=b(a(57)),g=b(a(46)),A=b(a(47));e=a(41);var q=c("larger",{"boolean, boolean":function(a,b){return a>b},"number, number":function(a,b){return a>b&&!l(a,b,d.epsilon)},"BigNumber, BigNumber":function(a,b){return a.gt(b)},"Fraction, Fraction":function(a,b){return 1===a.compare(b)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers");},"Unit, Unit":function(a,
b){if(!a.equalBase(b))throw Error("Cannot compare units with different base");return a.value>b.value&&!l(a.value,b.value,d.epsilon)},"string, string":function(a,b){return a>b},"Matrix, Matrix":function(a,b){var c;switch(a.storage()){case "sparse":switch(b.storage()){case "sparse":c=r(a,b,q);break;default:c=u(b,a,q,!0)}break;default:switch(b.storage()){case "sparse":c=u(a,b,q,!1);break;default:c=g(a,b,q)}}return c},"Array, Array":function(a,b){return q(h(a),h(b)).valueOf()},"Array, Matrix":function(a,
b){return q(h(a),b)},"Matrix, Array":function(a,b){return q(a,h(b))},"Matrix, any":function(a,b){var c;switch(a.storage()){case "sparse":c=n(a,b,q,!1);break;default:c=A(a,b,q,!1)}return c},"any, Matrix":function(a,b){var c;switch(b.storage()){case "sparse":c=n(b,a,q,!0);break;default:c=A(b,a,q,!0)}return c},"Array, any":function(a,b){return A(h(a),b,q,!1).valueOf()},"any, Array":function(a,b){return A(h(b),a,q,!0).valueOf()}});q.toTex="\\left(${args[0]}"+e.operators.larger+"${args[1]}\\right)";return q}},
function(m,e){e.name="algorithm12";e.factory=function(a,e,f,d){var b=a.DenseMatrix;return function(a,e,f,l){var n=a._values,g=a._index,A=a._ptr,q=a._size,t=a._datatype;if(!n)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");a=q[0];var q=q[1],k,p=f;"string"===typeof t&&(k=t,e=d.convert(e,k),p=d.find(f,[k,k]));f=[];k=new b({data:f,size:[a,q],datatype:k});for(var t=[],B=[],v=0;v<q;v++){for(var m=v+1,x=A[v+1],w=A[v];w<x;w++){var z=g[w];t[z]=n[w];B[z]=m}for(x=0;x<a;x++)0===
v&&(f[x]=[]),f[x][v]=B[x]===m?l?p(e,t[x]):p(t[x],e):l?p(e,0):p(0,e)}return k}}},function(m,e,a){var l=a(19);e.name="algorithm03";e.factory=function(a,d,b,c){var e=a.DenseMatrix;return function(a,b,d,g){var f=a._data,q=a._size,t=a._datatype;a=b._values;var k=b._index,p=b._ptr,B=b._size,v=b._datatype;if(q.length!==B.length)throw new l(q.length,B.length);if(q[0]!==B[0]||q[1]!==B[1])throw new RangeError("Dimension mismatch. Matrix A ("+q+") must match Matrix B ("+B+")");if(!a)throw Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");
b=q[0];var q=q[1],m,B=0,x=d;"string"===typeof t&&t===v&&(m=t,B=c.convert(0,m),x=c.find(d,[m,m]));d=[];for(t=0;t<b;t++)d[t]=[];for(var t=[],v=[],w=0;w<q;w++){for(var z=w+1,D=p[w+1],G=p[w];G<D;G++){var E=k[G];t[E]=g?x(a[G],f[E][w]):x(f[E][w],a[G]);v[E]=z}for(D=0;D<b;D++)d[D][w]=v[D]===z?t[D]:g?x(B,f[D][w]):x(f[D][w],B)}return new e({data:d,size:[b,q],datatype:m})}}},function(m,e,a){var l=a(19);e.name="algorithm07";e.factory=function(a,d,b,c){var e=a.DenseMatrix,u=function(a,b,c,d,e){var f=a._values,
k=a._index,h=a._ptr;a=h[b];for(b=h[b+1];a<b;a++)h=k[a],c[h]=e,d[h]=f[a]};return function(a,b,d){var f=a._size,q=a._datatype,t=b._size,k=b._datatype;if(f.length!==t.length)throw new l(f.length,t.length);if(f[0]!==t[0]||f[1]!==t[1])throw new RangeError("Dimension mismatch. Matrix A ("+f+") must match Matrix B ("+t+")");var t=f[0],f=f[1],p,m=0,v=d;"string"===typeof q&&q===k&&(p=q,m=c.convert(0,p),v=c.find(d,[p,p]));q=[];for(d=0;d<t;d++)q[d]=[];var k=new e({data:q,size:[t,f],datatype:p}),y=[],x=[],w=
[],z=[];for(p=0;p<f;p++){var D=p+1;u(a,p,w,y,D);u(b,p,z,x,D);for(d=0;d<t;d++)q[d][p]=v(w[d]===D?y[d]:m,z[d]===D?x[d]:m)}return k}}},function(m,e,a){var l=a(8).nearlyEqual;e.name="smaller";e.factory=function(e,d,b,c){var h=b(a(39)),u=b(a(58)),r=b(a(59)),n=b(a(57)),g=b(a(46)),m=b(a(47));e=a(41);var q=c("smaller",{"boolean, boolean":function(a,b){return a<b},"number, number":function(a,b){return a<b&&!l(a,b,d.epsilon)},"BigNumber, BigNumber":function(a,b){return a.lt(b)},"Fraction, Fraction":function(a,
b){return-1===a.compare(b)},"Complex, Complex":function(a,b){throw new TypeError("No ordering relation is defined for complex numbers");},"Unit, Unit":function(a,b){if(!a.equalBase(b))throw Error("Cannot compare units with different base");return a.value<b.value&&!l(a.value,b.value,d.epsilon)},"string, string":function(a,b){return a<b},"Matrix, Matrix":function(a,b){var c;switch(a.storage()){case "sparse":switch(b.storage()){case "sparse":c=r(a,b,q);break;default:c=u(b,a,q,!0)}break;default:switch(b.storage()){case "sparse":c=
u(a,b,q,!1);break;default:c=g(a,b,q)}}return c},"Array, Array":function(a,b){return q(h(a),h(b)).valueOf()},"Array, Matrix":function(a,b){return q(h(a),b)},"Matrix, Array":function(a,b){return q(a,h(b))},"Matrix, any":function(a,b){var c;switch(a.storage()){case "sparse":c=n(a,b,q,!1);break;default:c=m(a,b,q,!1)}return c},"any, Matrix":function(a,b){var c;switch(b.storage()){case "sparse":c=n(b,a,q,!0);break;default:c=m(b,a,q,!0)}return c},"Array, any":function(a,b){return m(h(a),b,q,!1).valueOf()},
"any, Array":function(a,b){return m(h(b),a,q,!0).valueOf()}});q.toTex="\\left(${args[0]}"+e.operators.smaller+"${args[1]}\\right)";return q}},function(m,e,a){var l=a(5).clone,f=a(17).format;e.name="trace";e.factory=function(d,b,c,e){var m=c(a(39)),r=c(a(38)),n=e("trace",{Array:function(a){return n(m(a))},Matrix:function(a){var b;switch(a.storage()){case "dense":a:{var c=a._size;b=a._data;switch(c.length){case 1:if(1==c[0]){b=l(b[0]);break a}throw new RangeError("Matrix must be square (size: "+f(c)+
")");case 2:var d=c[0];if(d===c[1]){for(a=c=0;a<d;a++)c=r(c,b[a][a]);b=c;break a}throw new RangeError("Matrix must be square (size: "+f(c)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+f(c)+")");}}break;case "sparse":b=a._values;var d=a._index,c=a._ptr,e=a._size;a=e[1];if(e[0]===a){e=0;if(0<b.length)for(var h=0;h<a;h++)for(var n=c[h+1],v=c[h];v<n;v++){var m=d[v];if(m===h){e=r(e,b[v]);break}if(m>h)break}b=e}else throw new RangeError("Matrix must be square (size: "+f(e)+
")");}return b},any:l});n.toTex="\\mathrm{tr}\\left(${args[0]}\\right)";return n}},function(m,e,a){var l=a(5).clone,f=a(17).format;e.name="transpose";e.factory=function(d,b,c,e){b=a(41);var m=c(a(39)),r=d.DenseMatrix,n=d.SparseMatrix,g=e("transpose",{Array:function(a){return g(m(a)).valueOf()},Matrix:function(a){var b=a.size(),c;switch(b.length){case 1:c=a.clone();break;case 2:var d=b[0],e=b[1];if(0===e)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+f(b)+")");switch(a.storage()){case "dense":b=
a._data;c=[];for(var g,h=0;h<e;h++){g=c[h]=[];for(var m=0;m<d;m++)g[m]=l(b[m][h])}c=new r({data:c,size:[e,d],datatype:a._datatype});break;case "sparse":b=a._values;c=a._index;g=a._ptr;for(var h=b?[]:void 0,m=[],u=[],w=[],z=0;z<d;z++)w[z]=0;var D,z=0;for(D=c.length;z<D;z++)w[c[z]]++;for(D=z=0;D<d;D++)u.push(z),z+=w[D],w[D]=u[D];u.push(z);for(z=0;z<e;z++){D=g[z+1];for(var G=g[z];G<D;G++){var E=w[c[G]]++;m[E]=z;b&&(h[E]=l(b[G]))}}c=new n({values:h,index:m,ptr:u,size:[e,d],datatype:a._datatype})}break;
default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+f(this._size)+")");}return c},any:function(a){return l(a)}});g.toTex="\\left(${args[0]}\\right)"+b.operators.transpose;return g}},function(m,e,a){var l=a(5).extend;e.name="divide";e.factory=function(e,d,b,c){var h=b(a(52)),m=b(a(53)),r=b(a(64)),n=b(a(39)),g=b(a(55)),A=b(a(47));e=c("divide",l({"Array | Matrix, Array | Matrix":function(a,b){return m(a,r(b))},"Matrix, any":function(a,b){var c;switch(a.storage()){case "sparse":c=
g(a,b,h,!1);break;case "dense":c=A(a,b,h,!1)}return c},"Array, any":function(a,b){return A(n(a),b,h,!1).valueOf()},"any, Array | Matrix":function(a,b){return m(a,r(b))}},h.signatures));e.toTex="\\frac{${args[0]}}{${args[1]}}";return e}},function(m,e,a){var l=a(14);e.name="inv";e.factory=function(e,d,b,c){function h(a,b,c){var d,e;if(1==b){b=a[0][0];if(0==b)throw Error("Cannot calculate inverse, determinant is zero");return[[r(1,b)]]}if(2==b){b=q(a);if(0==b)throw Error("Cannot calculate inverse, determinant is zero");
return[[r(a[1][1],b),r(A(a[0][1]),b)],[r(A(a[1][0]),b),r(a[0][0],b)]]}var f=a.concat();for(a=0;a<b;a++)f[a]=f[a].concat();for(var h=t(b).valueOf(),l=0;l<c;l++){for(a=l;a<b&&0==f[a][l];)a++;if(a==b||0==f[a][l])throw Error("Cannot calculate inverse, determinant is zero");a!=l&&(d=f[l],f[l]=f[a],f[a]=d,d=h[l],h[l]=h[a],h[a]=d);var m=f[l],u=h[l];for(a=0;a<b;a++){var E=f[a],J=h[a];if(a!=l){if(0!=E[l]){e=r(A(E[l]),m[l]);for(d=l;d<c;d++)E[d]=n(E[d],g(e,m[d]));for(d=0;d<c;d++)J[d]=n(J[d],g(e,u[d]))}}else{e=
m[l];for(d=l;d<c;d++)E[d]=r(E[d],e);for(d=0;d<c;d++)J[d]=r(J[d],e)}}}return h}var m=b(a(39)),r=b(a(52)),n=b(a(40)),g=b(a(53)),A=b(a(65)),q=b(a(66)),t=b(a(49));e=c("inv",{"Array | Matrix":function(a){var b=!0===a.isMatrix?a.size():l.array.size(a);switch(b.length){case 1:if(1==b[0])return!0===a.isMatrix?m([r(1,a.valueOf()[0])]):[r(1,a[0])];throw new RangeError("Matrix must be square (size: "+l.string.format(b)+")");case 2:var c=b[0],d=b[1];if(c==d)return!0===a.isMatrix?m(h(a.valueOf(),c,d),a.storage()):
h(a,c,d);throw new RangeError("Matrix must be square (size: "+l.string.format(b)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+l.string.format(b)+")");}},any:function(a){return r(1,a)}});e.toTex="\\left(${args[0]}\\right)^{-1}";return e}},function(m,e,a){var l=a(25);e.name="unaryMinus";e.factory=function(e,d,b,c){d=a(41);var h=c("unaryMinus",{number:function(a){return-a},Complex:function(a){return new e.Complex(-a.re,-a.im)},BigNumber:function(a){return a.neg()},Fraction:function(a){a=
a.clone();a.s=-a.s;return a},Unit:function(a){var b=a.clone();b.value=-a.value;return b},"Array | Matrix":function(a){return l(a,h,!0)}});h.toTex=d.operators.unaryMinus+"\\left(${args[0]}\\right)";return h}},function(m,e,a){m=a(14);var l=m.object,f=m.string;e.name="det";e.factory=function(d,b,c,e){var m=c(a(39)),r=c(a(38)),n=c(a(67)),g=c(a(53)),A=c(a(65));d=e("det",{any:function(a){return l.clone(a)},"Array | Matrix":function(a){var b;a&&!0===a.isMatrix?b=a.size():Array.isArray(a)?(a=m(a),b=a.size()):
b=[];switch(b.length){case 0:return l.clone(a);case 1:if(1==b[0])return l.clone(a.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+f.format(b)+")");case 2:var c=b[0];if(c==b[1]){a=a.clone().valueOf();if(1==c)c=l.clone(a[0][0]);else if(2==c)c=n(g(a[0][0],a[1][1]),g(a[1][0],a[0][1]));else{var d=a;for(b=0;b<c-1;b++){for(var e=void 0,h=void 0,y=Array(d.length),x=0,e=1;e<d.length;e++)x=r(x,d[e][e]);for(e=0;e<d.length;e++){y[e]=Array(d.length);y[e][e]=A(x);for(h=0;h<e;h++)y[e][h]=0;for(h=
e+1;h<d.length;h++)y[e][h]=d[e][h];e+1<d.length&&(x=n(x,d[e+1][e+1]))}d=g(y,a)}c=0==c%2?A(d[0][0]):d[0][0]}return c}throw new RangeError("Matrix must be square (size: "+f.format(b)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+f.format(b)+")");}}});d.toTex="\\det\\left(${args[0]}\\right)";return d}},function(m,e,a){var l=a(19);e.name="subtract";e.factory=function(e,d,b,c){d=a(41);var h=b(a(39)),m=b(a(40)),r=b(a(65)),n=b(a(42)),g=b(a(58)),A=b(a(68)),q=b(a(45)),t=b(a(46)),
k=b(a(47)),p=c("subtract",{"number, number":function(a,b){return a-b},"Complex, Complex":function(a,b){return new e.Complex(a.re-b.re,a.im-b.im)},"BigNumber, BigNumber":function(a,b){return a.minus(b)},"Fraction, Fraction":function(a,b){return a.sub(b)},"Unit, Unit":function(a,b){if(null==a.value)throw Error("Parameter x contains a unit with undefined value");if(null==b.value)throw Error("Parameter y contains a unit with undefined value");if(!a.equalBase(b))throw Error("Units do not match");var c=
a.clone();c.value-=b.value;c.fixPrefix=!1;return c},"Matrix, Matrix":function(a,b){var c=a.size(),d=b.size();if(c.length!==d.length)throw new l(c.length,d.length);switch(a.storage()){case "sparse":switch(b.storage()){case "sparse":c=A(a,b,p);break;default:c=g(b,a,p,!0)}break;default:switch(b.storage()){case "sparse":c=n(a,b,p,!1);break;default:c=t(a,b,p)}}return c},"Array, Array":function(a,b){return p(h(a),h(b)).valueOf()},"Array, Matrix":function(a,b){return p(h(a),b)},"Matrix, Array":function(a,
b){return p(a,h(b))},"Matrix, any":function(a,b){var c;switch(a.storage()){case "sparse":c=q(a,r(b),m);break;default:c=k(a,b,p)}return c},"any, Matrix":function(a,b){var c;switch(b.storage()){case "sparse":c=q(b,a,p,!0);break;default:c=k(b,a,p,!0)}return c},"Array, any":function(a,b){return k(h(a),b,p,!1).valueOf()},"any, Array":function(a,b){return k(h(b),a,p,!0).valueOf()}});p.toTex="\\left(${args[0]}"+d.operators.subtract+"${args[1]}\\right)";return p}},function(m,e,a){var l=a(19);e.name="algorithm05";
e.factory=function(e,d,b,c){var h=b(a(44)),m=e.SparseMatrix;return function(a,b,d){var e=a._values,f=a._index,t=a._ptr,k=a._size,p=a._datatype;a=b._values;var B=b._index,v=b._ptr,y=b._size,x=b._datatype;if(k.length!==y.length)throw new l(k.length,y.length);if(k[0]!==y[0]||k[1]!==y[1])throw new RangeError("Dimension mismatch. Matrix A ("+k+") must match Matrix B ("+y+")");var w=k[0],k=k[1],z;b=h;var y=0,D=d;"string"===typeof p&&p===x&&(z=p,b=c.find(h,[z,z]),y=c.convert(0,z),D=c.find(d,[z,z]));d=e&&
a?[]:void 0;p=[];x=[];z=new m({values:d,index:p,ptr:x,size:[w,k],datatype:z});var w=d?[]:void 0,G=d?[]:void 0,E=[],J=[],C,H,F,K;for(H=0;H<k;H++){x[H]=p.length;var I=H+1;F=t[H];for(K=t[H+1];F<K;F++)C=f[F],p.push(C),E[C]=I,w&&(w[C]=e[F]);F=v[H];for(K=v[H+1];F<K;F++)C=B[F],E[C]!==I&&p.push(C),J[C]=I,G&&(G[C]=a[F]);if(d)for(F=x[H];F<p.length;){C=p[F];K=E[C];var L=J[C];if(K===I||L===I)C=D(K===I?w[C]:y,L===I?G[C]:y),b(C,y)?p.splice(F,1):(d.push(C),F++)}}x[k]=p.length;return z}}},function(m,e,a){e.name=
"dotMultiply";e.factory=function(e,f,d,b){var c=d(a(39)),h=d(a(54));e=a(41);var m=d(a(71)),r=d(a(70)),n=d(a(55)),g=d(a(46)),A=d(a(47)),q=b("dotMultiply",{"any, any":h,"Matrix, Matrix":function(a,b){var c;switch(a.storage()){case "sparse":switch(b.storage()){case "sparse":c=r(a,b,h,!1);break;default:c=m(b,a,h,!0)}break;default:switch(b.storage()){case "sparse":c=m(a,b,h,!1);break;default:c=g(a,b,h)}}return c},"Array, Array":function(a,b){return q(c(a),c(b)).valueOf()},"Array, Matrix":function(a,b){return q(c(a),
b)},"Matrix, Array":function(a,b){return q(a,c(b))},"Matrix, any":function(a,b){var c;switch(a.storage()){case "sparse":c=n(a,b,h,!1);break;default:c=A(a,b,h,!1)}return c},"any, Matrix":function(a,b){var c;switch(b.storage()){case "sparse":c=n(b,a,h,!0);break;default:c=A(b,a,h,!0)}return c},"Array, any":function(a,b){return A(c(a),b,h,!1).valueOf()},"any, Array":function(a,b){return A(c(b),a,h,!0).valueOf()}});q.toTex="\\left(${args[0]}"+e.operators.dotMultiply+"${args[1]}\\right)";return q}},function(m,
e,a){var l=a(19);e.name="algorithm09";e.factory=function(e,d,b,c){var h=b(a(44)),m=e.SparseMatrix;return function(a,b,d){var e=a._values,f=a._index,t=a._ptr,k=a._size,p=a._datatype;a=b._values;var B=b._index,v=b._ptr,y=b._size,x=b._datatype;if(k.length!==y.length)throw new l(k.length,y.length);if(k[0]!==y[0]||k[1]!==y[1])throw new RangeError("Dimension mismatch. Matrix A ("+k+") must match Matrix B ("+y+")");var w=k[0],k=k[1],z;b=h;var y=0,D=d;"string"===typeof p&&p===x&&(z=p,b=c.find(h,[z,z]),y=
c.convert(0,z),D=c.find(d,[z,z]));d=e&&a?[]:void 0;p=[];x=[];z=new m({values:d,index:p,ptr:x,size:[w,k],datatype:z});var w=d?[]:void 0,G=[],E,J,C,H;for(J=0;J<k;J++){x[J]=p.length;var F=J+1;if(w)for(E=v[J],H=v[J+1],C=E;C<H;C++)E=B[C],G[E]=F,w[E]=a[C];E=t[J];H=t[J+1];for(C=E;C<H;C++)if(E=f[C],w){var K=D(e[C],G[E]===F?w[E]:y);b(K,y)||(p.push(E),d.push(K))}else p.push(E)}x[k]=p.length;return z}}},function(m,e,a){var l=a(19);e.name="algorithm02";e.factory=function(e,d,b,c){var h=b(a(44)),m=e.SparseMatrix;
return function(a,b,d,e){var f=a._data,t=a._size,k=a._datatype;a=b._values;var p=b._index,B=b._ptr,v=b._size,y=b._datatype;if(t.length!==v.length)throw new l(t.length,v.length);if(t[0]!==v[0]||t[1]!==v[1])throw new RangeError("Dimension mismatch. Matrix A ("+t+") must match Matrix B ("+v+")");if(!a)throw Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");b=t[0];var t=t[1],x,v=h,w=0,z=d;"string"===typeof k&&k===y&&(x=k,v=c.find(h,[x,x]),w=c.convert(0,x),z=c.find(d,[x,x]));
d=[];for(var k=[],y=[],D=0;D<t;D++){y[D]=k.length;for(var G=B[D+1],E=B[D];E<G;E++){var J=p[E],C=e?z(a[E],f[J][D]):z(f[J][D],a[E]);v(C,w)||(k.push(J),d.push(C))}}y[t]=k.length;return new m({values:d,index:k,ptr:y,size:[b,t],datatype:x})}}},function(m,e,a){var l=a(15).size;e.name="cross";e.factory=function(e,d,b,c){function h(a,b){var c=l(a),d=l(b);if(1!=c.length||1!=d.length||3!=c[0]||3!=d[0])throw new RangeError("Vectors with length 3 expected (Size A = ["+c.join(", ")+"], B = ["+d.join(", ")+"])");
return[r(n(a[1],b[2]),n(a[2],b[1])),r(n(a[2],b[0]),n(a[0],b[2])),r(n(a[0],b[1]),n(a[1],b[0]))]}var m=b(a(39)),r=b(a(67)),n=b(a(53));e=c("cross",{"Matrix, Matrix":function(a,b){return m(h(a.toArray(),b.toArray()))},"Matrix, Array":function(a,b){return m(h(a.toArray(),b))},"Array, Matrix":function(a,b){return m(h(a,b.toArray()))},"Array, Array":h});e.toTex="\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)";return e}},function(m,e,a){var l=a(15).size;e.name="dot";e.factory=function(e,d,b,c){function h(a,
b){var c=l(a),d=l(b),e=c[0];if(1!==c.length||1!==d.length)throw new RangeError("Vector expected");if(c[0]!=d[0])throw new RangeError("Vectors must have equal length ("+c[0]+" != "+d[0]+")");if(0==e)throw new RangeError("Cannot calculate the dot product of empty vectors");for(d=c=0;d<e;d++)c=m(c,r(a[d],b[d]));return c}var m=b(a(38)),r=b(a(53));e=c("dot",{"Matrix, Matrix":function(a,b){return h(a.toArray(),b.toArray())},"Matrix, Array":function(a,b){return h(a.toArray(),b)},"Array, Matrix":function(a,
b){return h(a,b.toArray())},"Array, Array":h});e.toTex="\\left(${args[0]}\\cdot${args[1]}\\right)";return e}}])});
