<!--
Materials Informatics HTML5 Player --- in-browser ultra-fast and
lightweight renderer of the crystallographic data.
Author: Evgeny Blokhin
License: MIT
-->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0" />
<title>Materials Informatics HTML5 Player</title>
<style>
body{margin:0;padding:0;overflow:hidden;}
html, body{height:100%;}
#infopanel{position:fixed;top:10px;left:6px;width:150px;height:150px;text-align:left;z-index:2;line-height:18px;font-family:Verdana;font-size:0.75em;color:#222;}
#zoompanel{position:fixed;top:18px;right:6px;width:50px;height:102px;z-index:2;background:no-repeat url(data:image/gif;base64,R0lGODlhMgBmAKEBAAAAAP///8zMzP///yH5BAEKAAMALAAAAAAyAGYAAAL+nI+py+0uopzi2UtzvhxNLHXWJ4YiY55Gqg6sRzVvNx+bHKk5FPNV+cOReMBR77EzgoY+0LK2SOI4N2MQdfVBo9mEFHlUTqlhcNd2xjLFXLTmDWd+Ye64vepK5+v3/nWOxudnR4clOAhX2Ea2Bjb2BPioEMnVSGTIuDVJqQljiSmpRblpBqnnNZp3Kki2ZNW5khq7qgoL62bW+akmunqLqocHLFvZctiyq1VLu/m7zKcj7DlTljmoRoyd2Gs8zczaHb78La6dXd6cjC6kvl7p7D4LH19LH21cbT+8rT/+fk7jVruA5DyVm2ewG8BQAd0t3BMPIMJSrexle9iQjcWCVBiLXOoHkSG9LR1PcCqoMFgQRH4UkZLHkl/Il+Ni4jl5yKYclTl1SsEJ0+dOkRuJjlSJMtqpkow+9uPIlKLTo7QmWmkaUWJSqU/QDRwmLt+rlGJzoYxRlh2xKmnVvniTbmvNOGrDETIr12tbkP749sobVprfY4P/Aba7F+RXxT8KAAA7);}
#optionpanel{position:fixed;bottom:4px;left:0;width:100%;height:20px;z-index:2;text-align:center;font-family:Arial;font-size:0.9em;color:#222;}
#optionpanel input{margin:4px 4px 0 4px;}
#optionpanel label{line-height:22px;vertical-align:top;}
#landing{display:none;position:fixed;left:0;top:0;right:0;bottom:0;height:auto;z-index:4;background:#fff;margin:0;text-align:center;font-family:Arial;font-size:1.25em;padding:10px;line-height:2em;}
#landing a{color:#999;}
#legend{width:290px;margin:20px auto 0;border-radius:15px;background:#f2f2f2;color:#999;padding:5px;}
#triangle{width:0;height:0;margin:-2px auto 20px;border-left:20px solid transparent;border-right:20px solid transparent;border-top:20px solid #f2f2f2;}
#notifybox{display:none;z-index:6;position:fixed;top:4px;left:4px;width:500px;background:#333;color:#fff;font-weight:bold;border-radius:5px;font-family:Arial;}
#cross{float:right;width:24px;height:24px;font-size:10px;text-align:center;cursor:pointer;background:url(data:image/gif;base64,R0lGODlhEAAQAJEAAAAAAP///1VVVf///yH5BAEAAAMALAAAAAAQABAAAAIjnI+py6L+BDRy0gqxHVqvLjGcJ3Yl+IEhQpLX+m7wMYv2PRQAOw==) center center no-repeat;}
#message{margin:20px;}
#versionbox{display:none;z-index:5;position:fixed;bottom:2px;right:2px;color:#222;font-size:0.95em;}
#cmdbox{display:none;z-index:3;position:fixed;bottom:2px;left:4px;cursor:pointer;font-family:Arial;text-decoration:underline;font-size:1.5em;color:#222;background:#fff;font-weight:bold;}
@media screen and (min-width:1200px){
#cmdbox{display:block;}
#versionbox{display:block;}
}
</style>
</head>
<body>
<script type="text/javascript">
/*
 RequireJS domReady 2.0.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/requirejs/domReady for details
*/
'use strict';var player=function(J){function Q(n){if(S[n])return S[n].exports;var h=S[n]={exports:{},id:n,loaded:!1};J[n].call(h.exports,h,h.exports,Q);h.loaded=!0;return h.exports}var S={};Q.m=J;Q.c=S;Q.p="";return Q(0)}([function(J,Q,S){!function(){var n=[S(1),S(4),S(6),S(3)];(function(h,g,q,c){function a(a){var b=document.getElementById("notifybox"),d=document.getElementById("message");b.style.display="block";d.innerHTML="";setTimeout(function(){d.innerHTML=a},250)}function b(a,b){var d=document.createElement("div");
d.setAttribute("id",a);b&&(d.innerHTML=b);document.body.appendChild(d);return d}function d(a,b,d){d||(d=15658734);var c=new D.Geometry;c.vertices.push(new D.Vector3(a[0],a[1],a[2]));c.vertices.push(new D.Vector3(b[0],b[1],b[2]));a=new D.LineBasicMaterial({color:d});r.atombox.add(new D.Line(c,a))}function e(a){var b=document.createElement("canvas"),d=b.getContext("2d"),c=3.5*d.measureText(a).width;b.width=c;b.height=30;d.font="normal 30px Arial";d.textAlign="center";d.textBaseline="middle";d.fillStyle=
"#000000";d.fillText(a,b.width/2,b.height/2);a=new D.Texture(b);a.needsUpdate=!0;a=new D.SpriteMaterial({map:a});a=new D.Sprite(a);a.renderOrder=1;b=new D.Object3D;a.scale.set(c,30,1);b.add(a);b.name="label";return b}function f(){r.loaded=!0;r.container=b("player");r.scene=new D.Scene;r.camera=new D.PerspectiveCamera(45,window.innerWidth/window.innerHeight,.1,2E4);r.camera.position.set(0,0,2600);var a=new D.AmbientLight(10066329);r.scene.add(a);a=new D.PointLight(6710886,1);a.position.set(1500,1500,
1500);r.scene.add(a);r.renderer=new D.CanvasRenderer;r.renderer.setClearColor(16777215,1);r.renderer.setSize(window.innerWidth,window.innerHeight);r.container.appendChild(r.renderer.domElement);b("zoompanel").onclick=function(a){a=a||window.event;a.cancelBubble?a.cancelBubble=!0:(a.stopPropagation(),a.preventDefault());r.camera.fov-=7.5*(69<(a.pageY?a.pageY:a.clientY)?-1:1);r.camera.updateProjectionMatrix()};r.controls=new D.TrackballControls(r.camera);r.controls.rotateSpeed=7.5;r.controls.staticMoving=
!0;k()}function k(){var a=r.scene.getObjectByName("atombox");a&&(r.scene.remove(a),r.controls.reset());r.atombox=new D.Object3D;(a=document.getElementById("infopanel"))&&a.parentNode.removeChild(a);r.obj3d.descr&&b("infopanel","<span style=color:#900><i>a</i>="+(Math.round(1E3*parseFloat(r.obj3d.descr.a))/1E3).toFixed(3)+" &#8491;</span><br /><span style=color:#090><i>b</i>="+(Math.round(1E3*parseFloat(r.obj3d.descr.b))/1E3).toFixed(3)+" &#8491;</span><br /><span style=color:#09f><i>c</i>="+(Math.round(1E3*
parseFloat(r.obj3d.descr.c))/1E3).toFixed(3)+" &#8491;</span><br /><i>&#945;</i>="+(Math.round(100*parseFloat(r.obj3d.descr.alpha))/100).toFixed(2)+"&deg;<br /><i>&#946;</i>="+(Math.round(100*parseFloat(r.obj3d.descr.beta))/100).toFixed(2)+"&deg;<br /><i>&#947;</i>="+(Math.round(100*parseFloat(r.obj3d.descr.gamma))/100).toFixed(2)+"&deg;<br />");(a=document.getElementById("optionpanel"))&&a.parentNode.removeChild(a);a=b("optionpanel","<input type=radio name=optionpanel id=optionpanel_empty checked=checked /><label for=optionpanel_empty>none</label> <input type=radio name=optionpanel id=optionpanel_S /><label for=optionpanel_S>chemical elements</label> <input type=radio name=optionpanel id=optionpanel_N /><label for=optionpanel_N>id's</label>");
if(Object.keys(r.obj3d.overlayed).length)for(var c in r.obj3d.overlayed)a.innerHTML+=" <input type=radio name=optionpanel id=optionpanel_"+c+" /><label for=optionpanel_"+c+">"+r.obj3d.overlayed[c]+"</label>",r.available_overlays.push(c);a.onclick=function(a){a=a||window.event;a=(a.target||a.srcElement).id.replace("optionpanel_","");if(-1!==r.available_overlays.indexOf(a)){var b=r.scene.getObjectByName("atombox"),b=b.children,d=b.filter(function(a){return"label"==a.name}),c,f=d.length;for(c=0;c<f;c++)r.atombox.remove(d[c]),
r.scene.remove(d[c]);if("empty"!==a){b=b.filter(function(a){return"atom"==a.name});f=b.length;for(c=0;c<f;c++)d=e(b[c].overlays[a]),d.position.set(b[c].position.x,b[c].position.y,b[c].position.z),r.atombox.add(d);r.current_overlay=a}}r.renderer.render(r.scene,r.camera)};r.current_overlay="empty";var f;c={w:8,h:6};a={w:10,h:8};50<r.obj3d.atoms.length?f=c:f=a;a=r.obj3d.atoms.length;for(c=0;c<a;c++){var k=parseInt(100*r.obj3d.atoms[c].x),m=parseInt(100*r.obj3d.atoms[c].y),l=parseInt(100*r.obj3d.atoms[c].z),
x=new D.Mesh(new D.SphereBufferGeometry(65*r.obj3d.atoms[c].r,f.w,f.h),new D.MeshLambertMaterial({color:r.obj3d.atoms[c].c,overdraw:.75}));x.position.set(k,m,l);x.name="atom";x.overlays=r.obj3d.atoms[c].overlays;r.atombox.add(x);"empty"!==r.current_overlay&&(x=e(x.overlays[r.current_overlay]),x.position.set(k,m,l),r.atombox.add(x))}if(r.obj3d.cell.length){var p;f=[];for(c=0;3>c;c++)a=Math.round(1E3*parseFloat(r.obj3d.cell[c][0]))/10,k=Math.round(1E3*parseFloat(r.obj3d.cell[c][1]))/10,m=Math.round(1E3*
parseFloat(r.obj3d.cell[c][2]))/10,f.push([a,k,m]),0==c?p=10027008:1==c?p=39168:2==c&&(p=39423),r.atombox.add(new D.ArrowHelper((new D.Vector3(a,k,m)).normalize(),new D.Vector3(0,0,0),Math.sqrt(a*a+k*k+m*m),p,75,10));c=[f[0][0]+f[1][0],f[0][1]+f[1][1],f[0][2]+f[1][2]];a=[f[0][0]+f[2][0],f[0][1]+f[2][1],f[0][2]+f[2][2]];k=[c[0]+f[2][0],c[1]+f[2][1],c[2]+f[2][2]];m=[f[1][0]+f[2][0],f[1][1]+f[2][1],f[1][2]+f[2][2]];p=[];p.push([f[0],c]);p.push([f[0],a]);p.push([f[1],m]);p.push([f[1],c]);p.push([f[2],
m]);p.push([f[2],a]);p.push([c,k]);p.push([a,k]);p.push([k,m]);a=p.length;for(c=0;c<a;c++)d(p[c][0],p[c][1])}r.atombox.name="atombox";r.scene.add(r.atombox);w()}function m(){r.loaded&&(r.camera.aspect=window.innerWidth/window.innerHeight,r.camera.updateProjectionMatrix(),r.renderer.setSize(window.innerWidth,window.innerHeight),r.controls.handleResize(),w())}function w(){requestAnimationFrame(w);r.renderer.render(r.scene,r.camera);r.controls.update()}function x(){var b=document.location.hash.substr(1);
if(-1==b.indexOf("://"))return r.loaded||p(),a("Error: not a valid url!");s(b)}function p(){r.local_supported?document.getElementById("landing").style.display="block":u()}function u(a){a=a||window.event;a.cancelBubble?a.cancelBubble=!0:(a.stopPropagation(),a.preventDefault());l(r.sample,!1)}function s(b){document.createElement("a").href=b;var d=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");d.onreadystatechange=function(){4==d.readyState&&(200==d.status?l(d.responseText,
!0):(a("Error: HTTP "+d.status+" status received during retrieving data from the server"),r.loaded||p()))};d.open("GET",b);d.send(1)}function l(a,b){r.obj3d=h.to_player(a);r.obj3d?(document.getElementById("landing").style.display="none",r.loaded?k():f()):r.loaded||p()}function v(b){b.stopPropagation();b.preventDefault();if(1<b.dataTransfer.files.length)return a("Error: only one file at the time may be rendered!");b=b.dataTransfer.files[0];if(!b||!b.size)return a("Error: file cannot be read (unaccessible?)");
var d=new FileReader;d.onloadend=function(a){l(a.target.result,!1)};d.abort=function(){a("Error: file reading has been cancelled!")};d.onerror=function(b){a("Error: file reading has been cancelled: "+b.target.error.name)};d.readAsText(b)}function t(a){a.stopPropagation();a.preventDefault();a.dataTransfer.dropEffect="copy"}var r={version:"0.15",loaded:!1,container:null,stats:null,camera:null,scene:null,renderer:null,controls:null,atombox:null,available_overlays:["empty","S","N"],current_overlay:"empty",
obj3d:!1};r.local_supported=window.File&&window.FileReader&&window.FileList&&window.Blob;r.sample="data_global\n_cell_length_a 24\n_cell_length_b 5.91\n_cell_length_c 5.85\n_cell_angle_alpha 90\n_cell_angle_beta 90\n_cell_angle_gamma 90\n_symmetry_space_group_name_H-M 'P1'\nloop_\n_symmetry_equiv_pos_as_xyz\nx,y,z\nloop_\n_atom_site_label\n_atom_site_type_symbol\n_atom_site_fract_x\n_atom_site_fract_y\n_atom_site_fract_z\n_atom_site_charge\nO1 O 0.425 0.262 0.009 -2.0\nO2 O -0.425 0.262 0.009 -2.0\nH3 H 0.444 0.258 0.154 1.0\nH4 H -0.444 0.258 0.154 1.0\nH5 H 0.396 0.124 0.012 1.0\nH6 H -0.396 0.124 0.012 1.0\nO7 O 0.425 0.236 0.510 -2.0\nO8 O -0.425 0.236 0.510 -2.0\nH9 H 0.444 0.239 0.656 1.0\nH10 H -0.444 0.239 0.656 1.0\nH11 H 0.396 0.374 0.512 1.0\nH12 H -0.396 0.374 0.512 1.0\nSr13 Sr 0.342 0.964 0.467 2.0\nSr14 Sr -0.342 0.964 0.467 2.0\nSr15 Sr 0.342 0.535 0.967 2.0\nSr16 Sr -0.342 0.535 0.967 2.0\nO17 O 0.348 0.971 0.019 -2.0\nO18 O -0.348 0.971 0.019 -2.0\nO19 O 0.348 0.528 0.519 -2.0\nO20 O -0.348 0.528 0.519 -2.0\nO21 O 0.263 0.803 0.701 -2.0\nO22 O -0.263 0.803 0.701 -2.0\nO23 O 0.264 0.695 0.200 -2.0\nO24 O -0.264 0.695 0.200 -2.0\nZr25 Zr 0.261 0.000 0.998 4.0\nZr26 Zr -0.261 0.000 0.998 4.0\nZr27 Zr 0.261 0.499 0.498 4.0\nZr28 Zr -0.261 0.499 0.498 4.0\nO29 O 0.257 0.304 0.806 -2.0\nO30 O -0.257 0.304 0.806 -2.0\nO31 O 0.257 0.195 0.306 -2.0\nO32 O -0.257 0.195 0.306 -2.0\nSr33 Sr 0.173 0.993 0.524 2.0\nSr34 Sr -0.173 0.993 0.524 2.0\nSr35 Sr 0.173 0.506 0.024 2.0\nSr36 Sr -0.173 0.506 0.024 2.0\nO37 O 0.173 0.947 0.986 -2.0\nO38 O -0.173 0.947 0.986 -2.0\nO39 O 0.173 0.551 0.486 -2.0\nO40 O -0.173 0.551 0.486 -2.0\nO41 O 0.098 0.204 0.295 -2.0\nO42 O -0.098 0.204 0.295 -2.0\nO43 O 0.098 0.295 0.795 -2.0\nO44 O -0.098 0.295 0.795 -2.0\nZr45 Zr 0.086 0.004 0.998 4.0\nZr46 Zr -0.086 0.004 0.998 4.0\nZr47 Zr 0.086 0.495 0.498 4.0\nZr48 Zr -0.086 0.495 0.498 4.0\nO49 O 0.074 0.709 0.211 -2.0\nO50 O -0.074 0.709 0.211 -2.0\nO51 O 0.074 0.790 0.711 -2.0\nO52 O -0.074 0.790 0.711 -2.0\nSr53 Sr 0 0.991 0.467 2.0\nSr54 Sr 0 0.508 0.967 2.0\nO55 O 0 0.076 0.020 -2.0\nO56 O 0 0.423 0.520 -2.0";
var D=q.THREE||q;c(function(){var d=b("notifybox",'<div id="cross"></div><div id="message"></div>');document.getElementById("cross").onclick=function(){d.style.display="none"};b("versionbox","v"+r.version);b("cmdbox","Load new").onclick=p;b("landing",'<div id="legend">Choose a <b>CIF</b> or <b>POSCAR</b> file (drag<b><i>&</i></b>drop is supported). Files are processed offline in the browser, no remote server is used. <a href=/ id=play_demo>Example</a>.</div><div id="triangle"></div><input type="file" id="fileapi" />');
document.getElementById("play_demo").onclick=u;h=h(g,{warning:a,error:a});window.addEventListener("resize",m,!1);window.addEventListener("hashchange",x,!1);if(r.local_supported){window.addEventListener("dragover",t,!1);window.addEventListener("drop",v,!1);var c=document.getElementById("fileapi"),e=new FileReader;c.onchange=function(){if(!this.files[0]||!this.files[0].size)return a("Error: file cannot be read (unaccessible?)");e.currentFilename=this.files[0].name;e.readAsText(this.files[0])};e.onloadend=
function(a){l(a.target.result,!1)}}window.parent&&window.parent.playerdata?(c="object"===typeof window.parent.playerdata&&document.location.search?window.parent.playerdata[document.location.search.substr(1)]:window.parent.playerdata,l(c,!1)):document.location.hash.length?x():p()})}).apply(null,n)}()},function(J,Q,S){String.prototype.startswith=function(n){return 0===this.indexOf(n)};String.prototype.endswith=function(n,h){var g=this.toString();if(void 0===h||h>g.length)h=g.length;h-=n.length;g=g.indexOf(n,
h);return-1!==g&&g===h};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};String.prototype.isnumeric=function(){return!isNaN(parseFloat(this))&&isFinite(this)};Object.defineProperties(Object.prototype,{forOwn:{writable:!0,configurable:!0,value:function(n,h){Object.keys(this).forEach(function(g){n.call(h,this[g],g,this)},this)}}});Q=function(n,h){function g(a){if(0<a.indexOf("_cell_angle_gamma ")&&0<a.indexOf("loop_"))return"CIF";a=a.toString().replace(/(\r\n|\r)/gm,"\n").split("\n");
return 6<a.length&&("direct"==a[6].toLowerCase().substr(0,6)||"direct"==a[7].toLowerCase().substr(0,6))?"POSCAR":"unknown"}function q(a,b,d,c,e,p){if(!(a&&b&&d&&c&&e&&p))return h.error("Error: invalid cell definition!"),!1;c=c*Math.PI/180;e=e*Math.PI/180;p=p*Math.PI/180;var u=[0,0,1],s=[1,0,0],u=n.divide(u,n.norm(u)),s=n.subtract(s,n.multiply(n.dot(s,u),u)),s=n.divide(s,n.norm(s)),l=n.cross(u,s);a=n.multiply(a,[1,0,0]);b=n.multiply(b,[n.cos(p),n.sin(p),0]);var v=n.cos(e);c=n.divide(n.subtract(n.cos(c),
n.multiply(n.cos(e),n.cos(p))),n.sin(p));e=n.sqrt(n.subtract(n.subtract(1,n.multiply(v,v)),n.multiply(c,c)));d=n.multiply(d,[v,c,e]);return n.multiply([a,b,d],[s,l,u])}function c(a){a.symops&&h.warning("Warning! Reading of symmetry operations is not yet implemented, expect error now.");var b;b=6==Object.keys(a.cell).length?q(a.cell.a,a.cell.b,a.cell.c,a.cell.alpha,a.cell.beta,a.cell.gamma):a.cell;var d=[],c=[],e=[],p=[],d=b[0].map(function(a,d){return b.map(function(a){return a[d]})}),c=c.concat.apply(c,
d),u=0,s=a.atoms.length;if(a.types)for(u=0;u<s;u++)p.push([a.atoms[u].x,a.atoms[u].y,a.atoms[u].z]);else{for(var l=[],d={},u=0;u<s;u++)-1==Object.keys(d).indexOf(a.atoms[u].symbol)?d[a.atoms[u].symbol]=[[a.atoms[u].x,a.atoms[u].y,a.atoms[u].z]]:d[a.atoms[u].symbol].push([a.atoms[u].x,a.atoms[u].y,a.atoms[u].z]);var u=1,v;for(v in d){for(s=0;s<d[v].length;s++)p.push(d[v][s]),l.push(u);u++}}e=e.concat.apply(e,p);p=!1;p=(a.sg_name?a.sg_name:"")+(a.ng_name?" ("+a.ng_name+")":"");return{cell:c,atoms:e,
types:l||a.types,symlabel:p}}function a(a){var b=[],c=[],w=[];a=a.toString().replace(/(\r\n|\r)/gm,"\n").split("\n");var x={cell:{},atoms:[]},p=!1,u=!1,s=!1,l="",l=[],v="a b c alpha beta gamma".split(" "),t=["_atom_site_label","_atom_site_type_symbol","_atom_site_fract_x","_atom_site_fract_y","_atom_site_fract_z"],r=["label","symbol","x","y","z"],g=[0,1],z=[],y;for(y in e)z.push(t.length),t.push(y);var E=a.length;for(y=0;y<E;y++)if(!a[y].startswith("#"))if(l=a[y].toLowerCase().trim()){u=!1;if(l.startswith("data_"))u=
!0,p=!1,w=[],s=!1;else if(l.startswith("_cell_")){p=!1;l=l.split(" ");u=l[0].split("_");u=u[u.length-1];-1!==v.indexOf(u)&&l[l.length-1]&&(x.cell[u]=parseFloat(l[l.length-1]));continue}else if(l.startswith("_symmetry_space_group_name_h-m")||l.startswith("_space_group.patterson_name_h-m")){p=!1;x.sg_name=a[y].substr(31).replace(/"/g,"").replace(/'/g,"").trim();continue}else if(l.startswith("_space_group.it_number")||l.startswith("_space_group_it_number")||l.startswith("_symmetry_int_tables_number")){p=
!1;l=l.split(" ");x.ng_name=l[l.length-1].trim();continue}else if(l.startswith("loop_")){p=!0;w=[];s=!1;continue}if(p)if(l.startswith("_symmetry_equiv")||l.startswith("_space_group"))s=!0;else if(l.startswith("_"))w.push(l);else if(s)c.push(l.replace(/"/g,"").replace(/'/g,""));else{var u={overlays:{}},l=l.replace(/\t/g," ").split(" ").filter(function(a){return a?!0:!1}),B,C=w.length;for(B=0;B<C;B++){var F=t.indexOf(w[B]);-1!=F&&(-1<g.indexOf(F)?l[B]=l[B].charAt(0).toUpperCase()+l[B].slice(1).toLowerCase():
l[B]=parseFloat(l[B]),-1<z.indexOf(F)?u.overlays[t[F]]=l[B]:u[r[F]]=l[B])}void 0!==u.x&&void 0!==u.y&&void 0!==u.z&&(!u.symbol&&u.label&&(u.symbol=u.label.replace(/[0-9]/g,"")),!d.JmolColors[u.symbol]&&2<u.symbol.length&&(u.symbol=u.symbol.substr(0,u.symbol.length-1)),!d.JmolColors[u.symbol]&&1<u.symbol.length&&(u.symbol=u.symbol.substr(0,u.symbol.length-1)),u.symbol&&x.atoms.push(u))}else u&&x.atoms.length&&(1<c.length&&(x.symops=c),b.push(x),x={cell:{},atoms:[]},c=[])}else p=!1,w=[],s=!1;x.atoms.length&&
(1<c.length&&(x.symops=c),b.push(x));if(b.length)return b[b.length-1];h.error("Error: unexpected CIF format!");return!1}function b(a){a=a.toString().replace(/(\r\n|\r)/gm,"\n").split("\n");var b=[],c=[],e=1,x=[],p=[],u=[],s=[],l=["x","y","z","symbol"],v,t,r=a.length,g=[],z=0,g=[],y=[];v=0;a:for(;v<r;v++)if(0==v){g=a[v].split(" ").filter(function(a){return a?!0:!1});y=Object.keys(d.AseRadii);for(t=0;t<g.length;t++)if(-1==y.indexOf(g[t]))continue a;p=g}else if(1==v)e=parseFloat(a[v]);else if(-1!==[2,
3,4].indexOf(v))b.push(a[v].split(" ").filter(function(a){return a?!0:!1}).map(Number));else if(5==v)if(g=a[v].split(" ").filter(function(a){return a?!0:!1}),g[0].isnumeric())for(x=g.map(Number),t=0;t<x.length;t++)for(g=0;g<x[t];g++)s.push(t+1);else p=g;else if(6==v){if("direct"==a[v].toLowerCase().substr(0,6))continue a;g=a[v].split(" ").filter(function(a){return a?!0:!1});if(g[0].isnumeric())for(x=g.map(Number),t=0;t<x.length;t++)for(g=0;g<x[t];g++)s.push(t+1);else p=g}else if(6<v){if(7==v){if(p.length)for(t=
0;t<p.length;t++)for(g=0;g<x[t];g++)u.push(p[t]);if("direct"==a[v].toLowerCase().substr(0,6))continue a}y={};g=a[v].replace("#","").replace("!","").split(" ").filter(function(a){return a?!0:!1});if(!g.length)break;else if(3==g.length)u.length?g.push(u[z]):g.push("Xx");else if(3>g.length)return h.error("Error: invalid atom definition!"),!1;for(t=0;4>t;t++)y[l[t]]=3>t?parseFloat(g[t]):g[t];y.symbol=y.symbol.replace(/\W+/,"").replace(/\d+/,"");y.symbol.length||(y.symbol="Xx");c.push(y);z++}b=n.multiply(b,
e);if(c.length)return{cell:b,atoms:c,types:s};h.error("Error: unexpected POSCAR format!");return!1}var d={JmolColors:{D:"#FFFFC0",H:"#FFFFFF",He:"#D9FFFF",Li:"#CC80FF",Be:"#C2FF00",B:"#FFB5B5",C:"#909090",N:"#3050F8",O:"#FF0D0D",F:"#90E050",Ne:"#B3E3F5",Na:"#AB5CF2",Mg:"#8AFF00",Al:"#BFA6A6",Si:"#F0C8A0",P:"#FF8000",S:"#FFFF30",Cl:"#1FF01F",Ar:"#80D1E3",K:"#8F40D4",Ca:"#3DFF00",Sc:"#E6E6E6",Ti:"#BFC2C7",V:"#A6A6AB",Cr:"#8A99C7",Mn:"#9C7AC7",Fe:"#E06633",Co:"#F090A0",Ni:"#50D050",Cu:"#C88033",Zn:"#7D80B0",
Ga:"#C28F8F",Ge:"#668F8F",As:"#BD80E3",Se:"#FFA100",Br:"#A62929",Kr:"#5CB8D1",Rb:"#702EB0",Sr:"#00FF00",Y:"#94FFFF",Zr:"#94E0E0",Nb:"#73C2C9",Mo:"#54B5B5",Tc:"#3B9E9E",Ru:"#248F8F",Rh:"#0A7D8C",Pd:"#006985",Ag:"#C0C0C0",Cd:"#FFD98F",In:"#A67573",Sn:"#668080",Sb:"#9E63B5",Te:"#D47A00",I:"#940094",Xe:"#429EB0",Cs:"#57178F",Ba:"#00C900",La:"#70D4FF",Ce:"#FFFFC7",Pr:"#D9FFC7",Nd:"#C7FFC7",Pm:"#A3FFC7",Sm:"#8FFFC7",Eu:"#61FFC7",Gd:"#45FFC7",Tb:"#30FFC7",Dy:"#1FFFC7",Ho:"#00FF9C",Er:"#00E675",Tm:"#00D452",
Yb:"#00BF38",Lu:"#00AB24",Hf:"#4DC2FF",Ta:"#4DA6FF",W:"#2194D6",Re:"#267DAB",Os:"#266696",Ir:"#175487",Pt:"#D0D0E0",Au:"#FFD123",Hg:"#B8B8D0",Tl:"#A6544D",Pb:"#575961",Bi:"#9E4FB5",Po:"#AB5C00",At:"#754F45",Rn:"#428296",Fr:"#420066",Ra:"#007D00",Ac:"#70ABFA",Th:"#00BAFF",Pa:"#00A1FF",U:"#008FFF",Np:"#0080FF",Pu:"#006BFF",Am:"#545CF2",Cm:"#785CE3",Bk:"#8A4FE3",Cf:"#A136D4",Es:"#B31FD4",Fm:"#B31FBA",Md:"#B30DA6",No:"#BD0D87",Lr:"#C70066",Rf:"#CC0059",Db:"#D1004F",Sg:"#D90045",Bh:"#E00038",Hs:"#E6002E",
Mt:"#EB0026"},AseRadii:{X:.66,H:.31,He:.28,Li:1.28,Be:.96,B:.84,C:.76,N:.71,O:.66,F:.57,Ne:.58,Na:1.66,Mg:1.41,Al:1.21,Si:1.11,P:1.07,S:1.05,Cl:1.02,Ar:1.06,K:2.03,Ca:1.76,Sc:1.7,Ti:1.6,V:1.53,Cr:1.39,Mn:1.39,Fe:1.32,Co:1.26,Ni:1.24,Cu:1.32,Zn:1.22,Ga:1.22,Ge:1.2,As:1.19,Se:1.2,Br:1.2,Kr:1.16,Rb:2.2,Sr:1.95,Y:1.9,Zr:1.75,Nb:1.64,Mo:1.54,Tc:1.47,Ru:1.46,Rh:1.42,Pd:1.39,Ag:1.45,Cd:1.44,In:1.42,Sn:1.39,Sb:1.39,Te:1.38,I:1.39,Xe:1.4,Cs:2.44,Ba:2.15,La:2.07,Ce:2.04,Pr:2.03,Nd:2.01,Pm:1.99,Sm:1.98,Eu:1.98,
Gd:1.96,Tb:1.94,Dy:1.92,Ho:1.92,Er:1.89,Tm:1.9,Yb:1.87,Lu:1.87,Hf:1.75,Ta:1.7,W:1.62,Re:1.51,Os:1.44,Ir:1.41,Pt:1.36,Au:1.36,Hg:1.32,Tl:1.45,Pb:1.46,Bi:1.48,Po:1.4,At:1.5,Rn:1.5,Fr:2.6,Ra:2.21,Ac:2.15,Th:2.06,Pa:2,U:1.96,Np:1.9,Pu:1.87,Am:1.8,Cm:1.69,Bk:3,Cf:3,Es:3,Fm:3,Md:3,No:3,Lr:3,Rf:3,Db:3,Sg:3,Bh:3,Hs:3,Mt:3}},e={_atom_site_occupancy:"site occupancies",_atom_site_charge:"formal charges"};return{to_player:function(c){var k;switch(g(c)){case "CIF":k=a(c);break;case "POSCAR":k=b(c);break;default:h.error("Error: file format cannot be recognized!")}if(!k)return!1;
c=k;var m=!1,w;6==Object.keys(c.cell).length?(w=q(c.cell.a,c.cell.b,c.cell.c,c.cell.alpha,c.cell.beta,c.cell.gamma),m=c.cell):w=c.cell;var x=[],p=c.atoms.length;for(k=0;k<p;k++)x.push([c.atoms[k].x,c.atoms[k].y,c.atoms[k].z]);var x=n.multiply(x,w),m={atoms:[],cell:w,descr:m,overlayed:{}},u,s,l={},v=!1,p=c.atoms.length;for(k=0;k<p;k++){w=d.JmolColors[c.atoms[k].symbol]?d.JmolColors[c.atoms[k].symbol]:"0xffff00";u=d.AseRadii[c.atoms[k].symbol]?d.AseRadii[c.atoms[k].symbol]:.66;l={S:c.atoms[k].symbol,
N:k+1};c.atoms[k].overlays&&c.atoms[k].overlays._atom_site_occupancy&&1>c.atoms[k].overlays._atom_site_occupancy&&(v=!0);for(s in c.atoms[k].overlays)l[s]=c.atoms[k].overlays[s];m.atoms.push({x:x[k][0],y:x[k][1],z:x[k][2],c:w,r:u,overlays:l})}for(s in l)"S"!==s&&"N"!==s&&(m.overlayed[s]=e[s]);v&&h.warning("Warning! Rendering of alloys (with fractional site occupancies) is not yet implemented.");return m},to_flatten:function(d){var e;switch(g(d)){case "CIF":e=a(d);break;case "POSCAR":e=b(d);break;
default:h.error("Error: file format cannot be recognized!")}return e?c(e):!1},version:"0.0.2.4"}};"undefined"!==typeof J&&J.exports?J.exports=Q:"function"===typeof S(2).specified&&!(void 0!==Q&&(J.exports=Q))},function(J,Q,S){function n(g){return S(h(g))}function h(h){var c;if(!(c=g[h]))throw Error("Cannot find module '"+h+"'.");return c}var g={"./domReady":3,"./domReady.js":3,"./math.custom":4,"./math.custom.js":4,"./matinfio":1,"./matinfio.js":1,"./require":5,"./require.js":5,"./three.custom":6,
"./three.custom.js":6};n.keys=function(){return Object.keys(g)};n.resolve=h;J.exports=n;n.id=2},function(J,Q,S){var n;!(n=function(){function h(){if(!d){d=!0;a&&clearInterval(a);var b=f;if(d&&b.length){f=[];var c;for(c=0;c<b.length;c+=1)b[c](e)}}}function g(a){d?a(e):f.push(a);return g}var q,c,a,b="undefined"!==typeof window&&window.document,d=!b,e=b?document:null,f=[];if(b){if(document.addEventListener)document.addEventListener("DOMContentLoaded",h,!1),window.addEventListener("load",h,!1);else if(window.attachEvent){window.attachEvent("onload",
h);c=document.createElement("div");try{q=null===window.frameElement}catch(k){}c.doScroll&&q&&window.external&&(a=setInterval(function(){try{c.doScroll(),h()}catch(a){}},30))}"complete"===document.readyState&&h()}g.version="2.0.1";g.load=function(a,b,d,c){c.isBuild?d(null):g(d)};return g}.call(Q,S,Q,J),void 0!==n&&(J.exports=n))},function(J,Q,S){(function(n,h){J.exports=h()})(this,function(){return function(n){function h(q){if(g[q])return g[q].exports;var c=g[q]={exports:{},id:q,loaded:!1};n[q].call(c.exports,
c,c.exports,h);c.loaded=!0;return c.exports}var g={};h.m=n;h.c=g;h.p="";return h(0)}([function(n,h,g){h=g(1).create();h.import(g(13));h.import(g(23));h.import(g(24));h.import(g(26));h.import(g(27));h.import(g(28));h.import(g(55));h.import(g(43));h.import(g(60));h.import(g(62));h.import(g(63));n.exports=h},function(n,h,g){n.exports=g(2)},function(n,h,g){var q=g(3).isFactory;g(3);var c=g(4),a=g(8),b=g(10),d=g(12);h.create=function(e){function f(a){if(!q(a))throw Error("Factory object with properties `type`, `name`, and `factory` expected");
var b=k.indexOf(a);-1===b?(b=!0===a.math?a.factory(w.type,x,f,w.typed,w):a.factory(w.type,x,f,w.typed),k.push(a),m.push(b)):b=m[b];return b}if("function"!==typeof Object.create)throw Error("ES5 not supported by this JavaScript engine. Please load the es5-shim and es5-sham library for compatibility.");var k=[],m=[],w=a.mixin({});w.type={};w.expression={transform:Object.create(w)};w.typed=c.create(w.type);var x={epsilon:1E-12,matrix:"Matrix",number:"number",precision:64,predictable:!1};w["import"]=
f(b);w.config=f(d);e&&w.config(e);return w}},function(n,h){h.clone=function q(c){var a=typeof c;if("number"===a||"string"===a||"boolean"===a||null===c||void 0===c)return c;if("function"===typeof c.clone)return c.clone();if(Array.isArray(c))return c.map(function(a){return q(a)});if(c instanceof Number)return new Number(c.valueOf());if(c instanceof String)return new String(c.valueOf());if(c instanceof Boolean)return new Boolean(c.valueOf());if(c instanceof Date)return new Date(c.valueOf());if(c&&!0===
c.isBigNumber)return c;if(c instanceof RegExp)throw new TypeError("Cannot clone "+c);var a={},b;for(b in c)c.hasOwnProperty(b)&&(a[b]=q(c[b]));return a};h.extend=function(h,c){for(var a in c)c.hasOwnProperty(a)&&(h[a]=c[a]);return h};h.deepExtend=function c(a,b){if(Array.isArray(b))throw new TypeError("Arrays are not supported by deepExtend");for(var d in b)if(b.hasOwnProperty(d))if(b[d]&&b[d].constructor===Object)void 0===a[d]&&(a[d]={}),a[d].constructor===Object?c(a[d],b[d]):a[d]=b[d];else{if(Array.isArray(b[d]))throw new TypeError("Arrays are not supported by deepExtend");
a[d]=b[d]}return a};h.deepEqual=function(c,a){var b,d;if(Array.isArray(c)){if(!Array.isArray(a)||c.length!=a.length)return!1;b=0;for(d=c.length;b<d;b++)if(!h.deepEqual(c[b],a[b]))return!1;return!0}if(c instanceof Object){if(Array.isArray(a)||!(a instanceof Object))return!1;for(b in c)if(!h.deepEqual(c[b],a[b]))return!1;for(b in a)if(!h.deepEqual(c[b],a[b]))return!1;return!0}return typeof c===typeof a&&c==a};h.canDefineProperty=function(){try{if(Object.defineProperty)return Object.defineProperty({},
"x",{get:function(){}}),!0}catch(c){}return!1};h.lazy=function(c,a,b){if(h.canDefineProperty()){var d=!0,e;Object.defineProperty(c,a,{get:function(){d&&(e=b(),d=!1);return e},set:function(a){e=a;d=!1},configurable:!0,enumerable:!0})}else c[a]=b()};h.traverse=function(c,a){var b=c;if(a)for(var d=a.split("."),e=0;e<d.length;e++){var f=d[e];f in b||(b[f]={});b=b[f]}return b};h.isFactory=function(c){return c&&"function"===typeof c.factory}},function(n,h,g){var q=g(5),c=g(6).digits,a=function(){a=q.create;
return q};h.create=function(b){var d=a();d.types=[{name:"number",test:function(a){return"number"===typeof a}},{name:"Complex",test:function(a){return a&&a.isComplex}},{name:"BigNumber",test:function(a){return a&&a.isBigNumber}},{name:"Fraction",test:function(a){return a&&a.isFraction}},{name:"Unit",test:function(a){return a&&a.isUnit}},{name:"string",test:function(a){return"string"===typeof a}},{name:"Array",test:Array.isArray},{name:"Matrix",test:function(a){return a&&a.isMatrix}},{name:"DenseMatrix",
test:function(a){return a&&a.isDenseMatrix}},{name:"SparseMatrix",test:function(a){return a&&a.isSparseMatrix}},{name:"ImmutableDenseMatrix",test:function(a){return a&&a.isImmutableDenseMatrix}},{name:"Range",test:function(a){return a&&a.isRange}},{name:"Index",test:function(a){return a&&a.isIndex}},{name:"boolean",test:function(a){return"boolean"===typeof a}},{name:"ResultSet",test:function(a){return a&&a.isResultSet}},{name:"Help",test:function(a){return a&&a.isHelp}},{name:"function",test:function(a){return"function"===
typeof a}},{name:"Date",test:function(a){return a instanceof Date}},{name:"RegExp",test:function(a){return a instanceof RegExp}},{name:"Object",test:function(a){return"object"===typeof a}},{name:"null",test:function(a){return null===a}},{name:"undefined",test:function(a){return void 0===a}}];d.conversions=[{from:"number",to:"BigNumber",convert:function(a){if(15<c(a))throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+a+"). Use function bignumber(x) to convert to BigNumber.");
return new b.BigNumber(a)}},{from:"number",to:"Complex",convert:function(a){return new b.Complex(a,0)}},{from:"number",to:"string",convert:function(a){return a+""}},{from:"BigNumber",to:"Complex",convert:function(a){return new b.Complex(a.toNumber(),0)}},{from:"Fraction",to:"Complex",convert:function(a){return new b.Complex(a.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(a){if(15<c(a))throw new TypeError("Cannot implicitly convert a number with >15 significant digits to Fraction (value: "+
a+"). Use function fraction(x) to convert to Fraction.");return new b.Fraction(a)}},{from:"string",to:"number",convert:function(a){var b=Number(a);if(isNaN(b))throw Error('Cannot convert "'+a+'" to a number');return b}},{from:"boolean",to:"number",convert:function(a){return+a}},{from:"boolean",to:"BigNumber",convert:function(a){return new b.BigNumber(+a)}},{from:"boolean",to:"Fraction",convert:function(a){return new b.Fraction(+a)}},{from:"boolean",to:"string",convert:function(a){return+a}},{from:"null",
to:"number",convert:function(){return 0}},{from:"null",to:"string",convert:function(){return"null"}},{from:"null",to:"BigNumber",convert:function(){return new b.BigNumber(0)}},{from:"null",to:"Fraction",convert:function(){return new b.Fraction(0)}},{from:"Array",to:"Matrix",convert:function(a){return new b.DenseMatrix(a)}},{from:"Matrix",to:"Array",convert:function(a){return a.valueOf()}}];return d}},function(n,h,g){var q,c,a;"use strict";(function(b,d){!(c=[],q=d,a="function"===typeof q?q.apply(h,
c):q,void 0!==a&&(n.exports=a))})(this,function(){function a(){function d(a){for(var b,d=0;d<h.types.length;d++){var c=h.types[d];if(c.name===a){b=c.test;break}}if(!b){for(var e,d=0;d<h.types.length;d++)if(c=h.types[d],c.name.toLowerCase()==a.toLowerCase()){e=c.name;break}throw Error('Unknown type "'+a+'"'+(e?'. Did you mean "'+e+'"?':""));}return b}function c(a){for(var b="",d=0;d<a.length;d++){var e=a[d];if(e.signatures&&""!=e.name)if(""==b)b=e.name;else if(b!=e.name)throw a=Error("Function names do not match (expected: "+
b+", actual: "+e.name+")"),a.data={actual:e.name,expected:b},a;}return b}function f(a,b,d,c,e){var f=l(c);e=e?e.split(","):null;var k=a||"unnamed",m=e&&-1!==e.indexOf("any");a={fn:a,index:d,actual:c,expected:e};b=e?b>d&&!m?"Unexpected type of argument in function "+k+" (expected: "+e.join(" or ")+", actual: "+f+", index: "+d+")":"Too few arguments in function "+k+" (expected: "+e.join(" or ")+", index: "+d+")":"Too many arguments in function "+k+" (expected: "+d+", actual: "+b+")";b=new TypeError(b);
b.data=a;return b}function k(a){this.name=a||"refs";this.categories={}}function m(a,b){if("string"===typeof a){var d=a.trim(),c="..."===d.substr(0,3);c&&(d=d.substr(3));if(""===d)this.types=["any"];else for(this.types=d.split("|"),d=0;d<this.types.length;d++)this.types[d]=this.types[d].trim()}else if(Array.isArray(a))this.types=a;else{if(a instanceof m)return a.clone();throw Error("String or Array expected");}this.conversions=[];this.varArgs=c||b||!1;this.anyType=-1!==this.types.indexOf("any")}function w(a,
b){var d;if("string"===typeof a)d=""!==a?a.split(","):[];else if(Array.isArray(a))d=a;else throw Error("string or Array expected");this.params=Array(d.length);for(var c=0;c<d.length;c++){var e=new m(d[c]);this.params[c]=e;if(c===d.length-1)this.varArgs=e.varArgs;else if(e.varArgs)throw new SyntaxError('Unexpected variable arguments operator "..."');}this.fn=b}function x(a,b,d){this.path=a||[];this.param=a[a.length-1]||null;this.signature=b||null;this.childs=d||[]}function p(a){var b,d={},c=[],e,f;
for(f in a)if(a.hasOwnProperty(f)&&(b=new w(f,a[f]),!b.ignore()))for(b=b.expand(),e=0;e<b.length;e++){var k=b[e],m=k.toString(),l=d[m];if(l)if(l=w.compare(k,l),0>l)d[m]=k;else{if(0===l)throw Error('Signature "'+m+'" is defined twice');}else d[m]=k}for(m in d)d.hasOwnProperty(m)&&c.push(d[m]);c.sort(function(a,b){return w.compare(a,b)});for(e=0;e<c.length;e++)if(b=c[e],b.varArgs)for(a=b.params.length-1,d=b.params[a],f=0;f<d.types.length;){if(d.conversions[f])for(m=d.types[f],k=0;k<c.length;k++){var l=
c[k],x=l.params[a];if(l!==b&&x&&-1!==x.types.indexOf(m)&&!x.conversions[a]){d.types.splice(f,1);d.conversions.splice(f,1);f--;break}}f++}return c}function u(a,b){var d,c,e=b.length,f,k=[];for(d=0;d<a.length;d++)c=a[d],c.params.length!==e||f||(f=c),void 0!=c.params[e]&&k.push(c);k.sort(function(a,b){return m.compare(a.params[e],b.params[e])});var w=[];for(d=0;d<k.length;d++){c=k[d];var l=c.params[e],p=w.filter(function(a){return a.param.overlapping(l)})[0];if(p){if(p.param.varArgs)throw Error('Conflicting types "'+
p.param+'" and "'+l+'"');p.signatures.push(c)}else w.push({param:l,signatures:[c]})}c=Array(w.length);for(d=0;d<w.length;d++)k=w[d],c[d]=u(k.signatures,b.concat(k.param));return new x(b,f,c)}function s(a,b){var d=new k,c=p(b);if(0==c.length)throw Error("No signatures provided");for(var e=u(c,[]),m=[],w=a||"",l=0,x=0;x<c.length;x++){var r=c[x].params.length;r>l&&(l=r)}x=[];for(r=0;r<l;r++)x[r]="arg"+r;m.push("function "+w+"("+x.join(", ")+") {");m.push('  "use strict";');m.push("  var name = '"+w+
"';");m.push(e.toCode(d,"  "));m.push("}");e=[d.toCode(),"return "+m.join("\n")].join("\n");d=(new Function(d.name,"createError",e))(d,f);e={};for(m=0;m<c.length;m++)w=c[m],w.fn&&!w.hasConversions()&&(l=w.params.join(","),e[l]=w.fn);d.signatures=e;return d}function l(a){for(var b,d=0;d<h.types.length;d++){var c=h.types[d];if("Object"===c.name)b=c;else if(c.test(a))return c.name}return b&&b.test(a)?b.name:"unknown"}k.prototype.add=function(a,b){var d=b||"fn";this.categories[d]||(this.categories[d]=
[]);var c=this.categories[d].indexOf(a);-1==c&&(c=this.categories[d].length,this.categories[d].push(a));return d+c};k.prototype.toCode=function(){var a=[],b=this.name+".categories",d=this.categories,c;for(c in d)if(d.hasOwnProperty(c))for(var e=d[c],f=0;f<e.length;f++)a.push("var "+c+f+" = "+b+"['"+c+"']["+f+"];");return a.join("\n")};m.compare=function(a,b){if(a.anyType)return 1;if(b.anyType)return-1;if(-1!==a.types.indexOf("Object"))return 1;if(-1!==b.types.indexOf("Object"))return-1;if(a.hasConversions()){if(b.hasConversions()){var d,
c,e;for(d=0;d<a.conversions.length;d++)if(void 0!==a.conversions[d]){c=a.conversions[d];break}for(d=0;d<b.conversions.length;d++)if(void 0!==b.conversions[d]){e=b.conversions[d];break}return h.conversions.indexOf(c)-h.conversions.indexOf(e)}return 1}if(b.hasConversions())return-1;var f,k;for(d=0;d<h.types.length;d++)if(h.types[d].name===a.types[0]){f=d;break}for(d=0;d<h.types.length;d++)if(h.types[d].name===b.types[0]){k=d;break}return f-k};m.prototype.overlapping=function(a){for(var b=0;b<this.types.length;b++)if(-1!==
a.types.indexOf(this.types[b]))return!0;return!1};m.prototype.clone=function(){var a=new m(this.types.slice(),this.varArgs);a.conversions=this.conversions.slice();return a};m.prototype.hasConversions=function(){return 0<this.conversions.length};m.prototype.contains=function(a){for(var b=0;b<this.types.length;b++)if(a[this.types[b]])return!0;return!1};m.prototype.toString=function(a){for(var b=[],d={},c=0;c<this.types.length;c++){var e=this.conversions[c],e=a&&e?e.to:this.types[c];e in d||(d[e]=!0,
b.push(e))}return(this.varArgs?"...":"")+b.join("|")};w.prototype.clone=function(){return new w(this.params.slice(),this.fn)};w.prototype.expand=function(){function a(d,c){if(c.length<d.params.length){var e,f,k,l=d.params[c.length];if(l.varArgs){f=l.clone();for(e=0;e<h.conversions.length;e++)if(k=h.conversions[e],-1===l.types.indexOf(k.from)&&-1!==l.types.indexOf(k.to)){var x=f.types.length;f.types[x]=k.from;f.conversions[x]=k}a(d,c.concat(f))}else{for(e=0;e<l.types.length;e++)a(d,c.concat(new m(l.types[e])));
for(e=0;e<h.conversions.length;e++)k=h.conversions[e],-1===l.types.indexOf(k.from)&&-1!==l.types.indexOf(k.to)&&(f=new m(k.from),f.conversions[0]=k,a(d,c.concat(f)))}}else b.push(new w(c,d.fn))}var b=[];a(this,[]);return b};w.compare=function(a,b){if(a.params.length>b.params.length)return 1;if(a.params.length<b.params.length)return-1;var d,c=a.params.length,e=0,f=0;for(d=0;d<c;d++)a.params[d].hasConversions()&&e++,b.params[d].hasConversions()&&f++;if(e>f)return 1;if(e<f)return-1;for(d=0;d<a.params.length;d++)if(c=
m.compare(a.params[d],b.params[d]),0!==c)return c;return 0};w.prototype.hasConversions=function(){for(var a=0;a<this.params.length;a++)if(this.params[a].hasConversions())return!0;return!1};w.prototype.ignore=function(){for(var a={},b=0;b<h.ignore.length;b++)a[h.ignore[b]]=!0;for(b=0;b<this.params.length;b++)if(this.params[b].contains(a))return!0;return!1};w.prototype.toCode=function(a,b){for(var d=Array(this.params.length),c=0;c<this.params.length;c++){var e=this.params[c],f=e.conversions[0];d[c]=
e.varArgs?"varArgs":f?a.add(f.convert,"convert")+"(arg"+c+")":"arg"+c}return(c=this.fn?a.add(this.fn,"signature"):void 0)?b+"return "+c+"("+d.join(", ")+"); // signature: "+this.params.join(", "):""};w.prototype.toString=function(){return this.params.join(", ")};x.prototype.toCode=function(a,b,c){var e=[];if(this.param){var f=this.path.length-1,k=this.param.conversions[0],k="// type: "+(k?k.from+" (convert to "+k.to+")":this.param);if(this.param.varArgs){if(this.param.anyType)e.push(b+"if (arguments.length > "+
f+") {"),e.push(b+"  var varArgs = [];"),e.push(b+"  for (var i = "+f+"; i < arguments.length; i++) {"),e.push(b+"    varArgs.push(arguments[i]);");else{var m=function(b,c){for(var e=[],f=0;f<b.length;f++)e[f]=a.add(d(b[f]),"test")+"("+c+")";return e.join(" || ")}.bind(this);c=this.param.types;for(var w=[],l=0;l<c.length;l++)void 0===this.param.conversions[l]&&w.push(c[l]);e.push(b+"if ("+m(c,"arg"+f)+") { "+k);e.push(b+"  var varArgs = [arg"+f+"];");e.push(b+"  for (var i = "+(f+1)+"; i < arguments.length; i++) {");
e.push(b+"    if ("+m(w,"arguments[i]")+") {");e.push(b+"      varArgs.push(arguments[i]);");for(l=0;l<c.length;l++)if(f=this.param.conversions[l])m=a.add(d(c[l]),"test"),f=a.add(f.convert,"convert"),e.push(b+"    }"),e.push(b+"    else if ("+m+"(arguments[i])) {"),e.push(b+"      varArgs.push("+f+"(arguments[i]));");e.push(b+"    } else {");e.push(b+"      throw createError(name, arguments.length, i, arguments[i], '"+w.join(",")+"');");e.push(b+"    }")}e.push(b+"  }");e.push(this.signature.toCode(a,
b+"  "));e.push(b+"}")}else this.param.anyType?(e.push(b+"// type: any"),e.push(this._innerCode(a,b,c))):(w=this.param.types[0],m="any"!==w?a.add(d(w),"test"):null,e.push(b+"if ("+m+"(arg"+f+")) { "+k),e.push(this._innerCode(a,b+"  ",c)),e.push(b+"}"))}else e.push(this._innerCode(a,b,c));return e.join("\n")};x.prototype._innerCode=function(a,b,d){var c=[],e;this.signature&&(c.push(b+"if (arguments.length === "+this.path.length+") {"),c.push(this.signature.toCode(a,b+"  ")),c.push(b+"}"));var f;for(e=
0;e<this.childs.length;e++)if(this.childs[e].param.anyType){f=this.childs[e];break}for(e=0;e<this.childs.length;e++)c.push(this.childs[e].toCode(a,b,f));d&&!this.param.anyType&&c.push(d.toCode(a,b,f));(a=this._exceptions(a,b))&&c.push(a);return c.join("\n")};x.prototype._exceptions=function(a,b){var d=this.path.length;if(0===this.childs.length)return[b+"if (arguments.length > "+d+") {",b+"  throw createError(name, arguments.length, "+d+", arguments["+d+"]);",b+"}"].join("\n");for(var c={},e=[],f=
0;f<this.childs.length;f++){var k=this.childs[f];if(k.param)for(var m=0;m<k.param.types.length;m++){var w=k.param.types[m];w in c||k.param.conversions[m]||(c[w]=!0,e.push(w))}}return b+"throw createError(name, arguments.length, "+d+", arguments["+d+"], '"+e.join(",")+"');"};var v=[{name:"number",test:function(a){return"number"===typeof a}},{name:"string",test:function(a){return"string"===typeof a}},{name:"boolean",test:function(a){return"boolean"===typeof a}},{name:"Function",test:function(a){return"function"===
typeof a}},{name:"Array",test:Array.isArray},{name:"Date",test:function(a){return a instanceof Date}},{name:"RegExp",test:function(a){return a instanceof RegExp}},{name:"Object",test:function(a){return"object"===typeof a}},{name:"null",test:function(a){return null===a}},{name:"undefined",test:function(a){return void 0===a}}],t={},r=[],g=[],h={config:t,types:v,conversions:r,ignore:g},h=s("typed",{Object:function(a){var b=[],d;for(d in a)a.hasOwnProperty(d)&&b.push(a[d]);b=c(b);return s(b,a)},"string, Object":s,
"...Function":function(a){for(var b=c(a),d={},f=0;f<a.length;f++){var k=a[f];if("object"!==typeof k.signatures)throw a=new TypeError("Function is no typed-function (index: "+f+")"),a.data={index:f},a;for(var m in k.signatures)if(k.signatures.hasOwnProperty(m))if(d.hasOwnProperty(m)){if(k.signatures[m]!==d[m])throw a=Error('Signature "'+m+'" is defined twice'),a.data={signature:m},a;}else d[m]=k.signatures[m]}return s(b,d)}});h.config=t;h.types=v;h.conversions=r;h.ignore=g;h.create=a;h.find=function(a,
b){if(!a.signatures)throw new TypeError("Function is no typed-function");var d;if("string"===typeof b){d=b.split(",");for(var c=0;c<d.length;c++)d[c]=d[c].trim()}else if(Array.isArray(b))d=b;else throw new TypeError("String array or a comma separated string expected");c=d.join(",");if(c=a.signatures[c])return c;throw new TypeError("Signature not found (signature: "+(a.name||"unnamed")+"("+d.join(", ")+"))");};h.convert=function(a,b){var d=l(a);if(b===d)return a;for(var c=0;c<h.conversions.length;c++){var e=
h.conversions[c];if(e.from===d&&e.to===b)return e.convert(a)}throw Error("Cannot convert from "+d+" to "+b);};h.addType=function(a){if(!a||"string"!==typeof a.name||"function"!==typeof a.test)throw new TypeError("Object with properties {name: string, test: function} expected");h.types.push(a)};h.addConversion=function(a){if(!a||"string"!==typeof a.from||"string"!==typeof a.to||"function"!==typeof a.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");
h.conversions.push(a)};return h}return a()})},function(n,h,g){var q=g(7);h.isNumber=function(c){return"number"===typeof c};h.isInteger=function(c){return isFinite(c)?c==Math.round(c):!1};h.sign=Math.sign||function(c){return 0<c?1:0>c?-1:0};h.format=function(c,a){if("function"===typeof a)return a(c);if(Infinity===c)return"Infinity";if(-Infinity===c)return"-Infinity";if(isNaN(c))return"NaN";var b="auto",d=void 0;a&&(a.notation&&(b=a.notation),h.isNumber(a)?d=a:a.precision&&(d=a.precision));switch(b){case "fixed":return h.toFixed(c,
d);case "exponential":return h.toExponential(c,d);case "engineering":return h.toEngineering(c,d);case "auto":return h.toPrecision(c,d,a&&a.exponential).replace(/((\.\d*?)(0+))($|e)/,function(a,b,d,c,w){return"."!==d?d+w:w});default:throw Error('Unknown notation "'+b+'". Choose "auto", "exponential", or "fixed".');}};h.toExponential=function(c,a){return(new q(c)).toExponential(a)};h.toEngineering=function(c,a){return(new q(c)).toEngineering(a)};h.toFixed=function(c,a){return(new q(c)).toFixed(a)};
h.toPrecision=function(c,a,b){return(new q(c)).toPrecision(a,b)};h.digits=function(c){return c.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length};h.DBL_EPSILON=Number.EPSILON||2.220446049250313E-16;h.nearlyEqual=function(c,a,b){if(null==b)return c==a;if(c==a)return!0;if(isNaN(c)||isNaN(a))return!1;if(isFinite(c)&&isFinite(a)){var d=Math.abs(c-a);return d<h.DBL_EPSILON?!0:d<=Math.max(Math.abs(c),Math.abs(a))*b}return!1}},function(n,h){function g(c){var a=String(c).toLowerCase().match(/^0*?(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);
if(!a)throw new SyntaxError("Invalid number");c=a[1];var b=a[2],d=parseFloat(a[4]||"0"),a=b.indexOf("."),d=d+(-1!==a?a-1:b.length-1);this.sign=c;this.coefficients=b.replace(".","").replace(/^0*/,function(a){d-=a.length;return""}).replace(/0*$/,"").split("").map(function(a){return parseInt(a)});0===this.coefficients.length&&(this.coefficients.push(0),d++);this.exponent=d}function q(c){for(var a=[],b=0;b<c;b++)a.push(0);return a}g.prototype.toEngineering=function(c){c=this.roundDigits(c);var a=c.exponent,
b=c.coefficients,d=0===a%3?a:0>a?a-3-a%3:a-a%3,e=0<=a?a:Math.abs(d);b.length-1<e&&(b=b.concat(q(e-(b.length-1))));for(var f=Math.abs(a-d),e=1,k="";0<=--f;)e++;f=b.slice(e).join("");f=f.match(/[1-9]/)?"."+f:"";k=b.slice(0,e).join("")+f;k+="e"+(0<=a?"+":"")+d.toString();return c.sign+k};g.prototype.toFixed=function(c){var a=this.roundDigits(this.exponent+1+(c||0)),b=a.coefficients,a=a.exponent+1,d=a+(c||0);b.length<d&&(b=b.concat(q(d-b.length)));0>a&&(b=q(-a+1).concat(b),a=1);c&&b.splice(a,0,0===a?
"0.":".");return this.sign+b.join("")};g.prototype.toExponential=function(c){var a=c?this.roundDigits(c):this.clone(),b=a.coefficients,a=a.exponent;b.length<c&&(b=b.concat(q(c-b.length)));c=b.shift();return this.sign+c+(0<b.length?"."+b.join(""):"")+"e"+(0<=a?"+":"")+a};g.prototype.toPrecision=function(c,a){var b=a&&void 0!==a.lower?a.lower:.001,d=a&&void 0!==a.upper?a.upper:1E5,e=Math.abs(Math.pow(10,this.exponent));if(e<b||e>=d)return this.toExponential(c);d=c?this.roundDigits(c):this.clone();b=
d.coefficients;d=d.exponent;b.length<c&&(b=b.concat(q(c-b.length)));b=b.concat(q(d-b.length+1+(b.length<c?c-b.length:0)));b=q(-d).concat(b);d=0<d?d:0;d<b.length-1&&b.splice(d+1,0,".");return this.sign+b.join("")};g.prototype.clone=function(){var c=new g("0");c.sign=this.sign;c.coefficients=this.coefficients.slice(0);c.exponent=this.exponent;return c};g.prototype.roundDigits=function(c){for(var a=this.clone(),b=a.coefficients;0>=c;)b.unshift(0),a.exponent++,c++;if(b.length>c&&5<=b.splice(c,b.length-
c)[0])for(c-=1,b[c]++;10===b[c];)b.pop(),0===c&&(b.unshift(0),a.exponent++,c++),c--,b[c]++;return a};n.exports=g},function(n,h,g){var q=g(9);h.mixin=function(c){var a=new q;c.on=a.on.bind(a);c.off=a.off.bind(a);c.once=a.once.bind(a);c.emit=a.emit.bind(a);return c}},function(n,h){function g(){}g.prototype={on:function(g,c,a){var b=this.e||(this.e={});(b[g]||(b[g]=[])).push({fn:c,ctx:a});return this},once:function(g,c,a){function b(){d.off(g,b);c.apply(a,arguments)}var d=this;b._=c;return this.on(g,
b,a)},emit:function(g){var c=[].slice.call(arguments,1),a=((this.e||(this.e={}))[g]||[]).slice(),b=0,d=a.length;for(b;b<d;b++)a[b].fn.apply(a[b].ctx,c);return this},off:function(g,c){var a=this.e||(this.e={}),b=a[g],d=[];if(b&&c)for(var e=0,f=b.length;e<f;e++)b[e].fn!==c&&b[e].fn._!==c&&d.push(b[e]);d.length?a[g]=d:delete a[g];return this}};n.exports=g},function(n,h,g){var q=g(3).lazy,c=g(3).isFactory,a=g(3).traverse;g(3);var b=g(11);h.math=!0;h.name="import";h.factory=function(d,e,f,k,m){function w(a,
d){var e=arguments.length;if(1!=e&&2!=e)throw new b("import",e,1,2);d||(d={});if(c(a))s(a,d);else if(Array.isArray(a))a.forEach(function(a){w(a,d)});else if("object"===typeof a)for(var f in a)a.hasOwnProperty(f)&&(e=a[f],"function"==typeof e||"number"===typeof e||"string"===typeof e||"boolean"===typeof e||null===e||e&&!0===e.isUnit||e&&!0===e.isComplex||e&&!0===e.isBigNumber||e&&!0===e.isFraction||e&&!0===e.isMatrix||e&&!0===Array.isArray(e)?x(f,e,d):c(a)?s(a,d):w(e,d));else if(!d.silent)throw new TypeError("Factory, Object, or Array expected");
}function x(a,b,d){d.wrap&&"function"===typeof b&&(b=u(b));if(l(m[a])&&l(b))b=d.override?k(a,b.signatures):k(m[a],b),m[a]=b,p(a,b),m.emit("import",a,function(){return b});else if(void 0===m[a]||d.override)m[a]=b,p(a,b),m.emit("import",a,function(){return b});else if(!d.silent)throw Error('Cannot import "'+a+'": already exists');}function p(a,b){b&&"function"===typeof b.transform&&(m.expression.transform[a]=b.transform)}function u(a){var b=function(){for(var b=[],d=0,c=arguments.length;d<c;d++){var e=
arguments[d];b[d]=e&&e.valueOf()}return a.apply(m,b)};a.transform&&(b.transform=a.transform);return b}function s(b,d){if("string"===typeof b.name){var c=b.name,e=b.path?a(m,b.path):m,w=e.hasOwnProperty(c)?e[c]:void 0,x=function(){var a=f(b);if(l(w)&&l(a))return d.override||(a=k(w,a)),a;if(void 0===w||d.override)return a;if(!d.silent)throw Error('Cannot import "'+c+'": already exists');};!1!==b.lazy?q(e,c,x):e[c]=x();m.emit("import",c,x,b.path)}else f(b)}function l(a){return"function"===typeof a&&
"object"===typeof a.signatures}return w};h.lazy=!0},function(n,h){function g(h,c,a,b){if(!(this instanceof g))throw new SyntaxError("Constructor must be called with the new operator");this.fn=h;this.count=c;this.min=a;this.max=b;this.message="Wrong number of arguments in function "+h+" ("+c+" provided, "+a+(void 0!=b?"-"+b:"")+" expected)";this.stack=Error().stack}g.prototype=Error();g.prototype.constructor=Error;g.prototype.name="ArgumentsError";g.prototype.isArgumentsError=!0;n.exports=g},function(n,
h,g){function q(a,d){return a.map(function(a){return a.toLowerCase()}).indexOf(d.toLowerCase())}function c(a,d,c){if(void 0!==a[d]&&-1===c.indexOf(a[d])){var f=q(c,a[d]);-1!==f?(console.warn('Warning: Wrong casing for configuration option "'+d+'", should be "'+c[f]+'" instead of "'+a[d]+'".'),a[d]=c[f]):console.warn('Warning: Unknown value "'+a[d]+'" for configuration option "'+d+'". Available options: '+c.map(JSON.stringify).join(", ")+".")}}var a=g(3);h.name="config";h.math=!0;h.factory=function(b,
d,e,f,k){function m(b){if(b){var e=a.clone(d);c(b,"matrix",w);c(b,"number",x);a.deepExtend(d,b);b=a.clone(d);k.emit("config",b,e);return b}return a.clone(d)}var w=["Matrix","Array"],x=["number","BigNumber","Fraction"];m.MATRIX=w;m.NUMBER=x;return m}},function(n,h,g){var q=g(14).string.isString;h.name="Matrix";h.path="type";h.factory=function(c,a,b,d){function e(){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");}e.prototype.type="Matrix";e.prototype.isMatrix=
!0;e.storage=function(a){if(!q(a))throw new TypeError("format must be a string value");var b=e._storage[a];if(!b)throw new SyntaxError("Unsupported matrix storage format: "+a);return b};e._storage={};e.prototype.storage=function(){throw Error("Cannot invoke storage on a Matrix interface");};e.prototype.datatype=function(){throw Error("Cannot invoke datatype on a Matrix interface");};e.prototype.create=function(a,b){throw Error("Cannot invoke create on a Matrix interface");};e.prototype.subset=function(a,
b,d){throw Error("Cannot invoke subset on a Matrix interface");};e.prototype.get=function(a){throw Error("Cannot invoke get on a Matrix interface");};e.prototype.set=function(a,b,d){throw Error("Cannot invoke set on a Matrix interface");};e.prototype.resize=function(a,b){throw Error("Cannot invoke resize on a Matrix interface");};e.prototype.clone=function(){throw Error("Cannot invoke clone on a Matrix interface");};e.prototype.size=function(){throw Error("Cannot invoke size on a Matrix interface");
};e.prototype.map=function(a,b){throw Error("Cannot invoke map on a Matrix interface");};e.prototype.forEach=function(a){throw Error("Cannot invoke forEach on a Matrix interface");};e.prototype.toArray=function(){throw Error("Cannot invoke toArray on a Matrix interface");};e.prototype.valueOf=function(){throw Error("Cannot invoke valueOf on a Matrix interface");};e.prototype.format=function(a){throw Error("Cannot invoke format on a Matrix interface");};e.prototype.toString=function(){throw Error("Cannot invoke toString on a Matrix interface");
};return e}},function(n,h,g){h.array=g(15);h["boolean"]=g(21);h["function"]=g(22);h.number=g(6);h.object=g(3);h.string=g(16);h.types=g(18);h.emitter=g(8)},function(n,h,g){function q(a,b,d){var c=a.length;if(c!=b[d])throw new f(c,b[d]);if(d<b.length-1){var e=d+1;for(d=0;d<c;d++){if(!Array.isArray(a[d]))throw new f(b.length-1,b.length,"<");q(a[d],b,e)}}else for(d=0;d<c;d++)if(Array.isArray(a[d]))throw new f(b.length+1,b.length,">");}function c(a,b,d,e){var f,k=b[d],l=Math.min(a.length,k);a.length=k;
if(d<b.length-1){var v=d+1;for(d=0;d<l;d++)f=a[d],Array.isArray(f)||(f=[f],a[d]=f),c(f,b,v,e);for(d=l;d<k;d++)f=[],a[d]=f,c(f,b,v,e)}else{for(d=0;d<l;d++)for(;Array.isArray(a[d]);)a[d]=a[d][0];if(e!==h.UNINITIALIZED)for(d=l;d<k;d++)a[d]=e}}function a(b,d,c){var e;if(c<d){var f=c+1;c=0;for(e=b.length;c<e;c++)b[c]=a(b[c],d,f)}else for(;Array.isArray(b);)b=b[0];return b}function b(a,d,c){var e;if(Array.isArray(a)){var f=c+1;c=0;for(e=a.length;c<e;c++)a[c]=b(a[c],d,f)}else for(;c<d;c++)a=[a];return a}
var d=g(6),e=g(16);g(3);g(18);var f=g(19),k=g(20);h.size=function(a){for(var b=[];Array.isArray(a);)b.push(a.length),a=a[0];return b};h.validate=function(a,b){if(0==b.length){if(Array.isArray(a))throw new f(a.length,0);}else q(a,b,0)};h.validateIndex=function(a,b){if(!d.isNumber(a)||!d.isInteger(a))throw new TypeError("Index must be an integer (value: "+a+")");if(0>a||"number"===typeof b&&a>=b)throw new k(a,b);};h.UNINITIALIZED={};h.resize=function(a,b,f){if(!Array.isArray(a)||!Array.isArray(b))throw new TypeError("Array expected");
if(0===b.length)throw Error("Resizing to scalar is not supported");b.forEach(function(a){if(!d.isNumber(a)||!d.isInteger(a)||0>a)throw new TypeError("Invalid size, must contain positive integers (size: "+e.format(b)+")");});c(a,b,0,void 0!==f?f:0);return a};h.squeeze=function(b,d){for(var c=d||h.size(b);Array.isArray(b)&&1===b.length;)b=b[0],c.shift();for(var e=c.length;1===c[e-1];)e--;e<c.length&&(b=a(b,e,0),c.length=e);return b};h.unsqueeze=function(a,d,c,e){e=e||h.size(a);if(c)for(var f=0;f<c;f++)a=
[a],e.unshift(1);for(a=b(a,d,0);e.length<d;)e.push(1);return a};h.flatten=function(a){if(!Array.isArray(a))return a;var b=[];a.forEach(function p(a){Array.isArray(a)?a.forEach(p):b.push(a)});return b};h.isArray=Array.isArray},function(n,h,g){function q(a,d){if(Array.isArray(a)){for(var c="[",f=a.length,k=0;k<f;k++)0!=k&&(c+=", "),c+=q(a[k],d);return c+"]"}return h.format(a,d)}var c=g(6).format,a=g(17).format;h.isString=function(a){return"string"===typeof a};h.endsWith=function(a,d){return a.substring(a.length-
d.length,a.length)===d};h.format=function(b,d){if("number"===typeof b)return c(b,d);if(b&&!0===b.isBigNumber)return a(b,d);if(b&&!0===b.isFraction)return d&&"decimal"===d.fraction?b.toString():b.s*b.n+"/"+b.d;if(Array.isArray(b))return q(b,d);if(h.isString(b))return'"'+b+'"';if("function"===typeof b)return b.syntax?String(b.syntax):"function";if(b&&"object"===typeof b){if("function"===typeof b.format)return b.format(d);if(b&&b.toString()!=={}.toString())return b.toString();var e=[],f;for(f in b)b.hasOwnProperty(f)&&
e.push('"'+f+'": '+h.format(b[f],d));return"{"+e.join(", ")+"}"}return String(b)}},function(n,h){h.format=function(g,q){if("function"===typeof q)return q(g);if(!g.isFinite())return g.isNaN()?"NaN":g.gt(0)?"Infinity":"-Infinity";var c="auto",a=void 0;void 0!==q&&(q.notation&&(c=q.notation),"number"===typeof q?a=q:q.precision&&(a=q.precision));switch(c){case "fixed":return h.toFixed(g,a);case "exponential":return h.toExponential(g,a);case "auto":var c=.001,b=1E5;q&&q.exponential&&(void 0!==q.exponential.lower&&
(c=q.exponential.lower),void 0!==q.exponential.upper&&(b=q.exponential.upper));g.constructor.config({toExpNeg:Math.round(Math.log(c)/Math.LN10),toExpPos:Math.round(Math.log(b)/Math.LN10)});if(g.isZero())return"0";var d=g.abs();return(d.gte(c)&&d.lt(b)?g.toSignificantDigits(a).toFixed():h.toExponential(g,a)).replace(/((\.\d*?)(0+))($|e)/,function(a,b,d,c,w){return"."!==d?d+w:w});default:throw Error('Unknown notation "'+c+'". Choose "auto", "exponential", or "fixed".');}};h.toExponential=function(g,
h){return void 0!==h?g.toExponential(h-1):g.toExponential()};h.toFixed=function(g,h){return g.toFixed(h||0)}},function(n,h){h.type=function(g){var h=typeof g;return"object"===h?null===g?"null":g instanceof Boolean?"boolean":g instanceof Number?"number":g instanceof String?"string":Array.isArray(g)?"Array":g instanceof Date?"Date":g instanceof RegExp?"RegExp":"Object":"function"===h?"Function":h};h.isScalar=function(g){return!(g&&g.isMatrix||Array.isArray(g))}},function(n,h){function g(h,c,a){if(!(this instanceof
g))throw new SyntaxError("Constructor must be called with the new operator");this.actual=h;this.expected=c;this.relation=a;this.message="Dimension mismatch ("+(Array.isArray(h)?"["+h.join(", ")+"]":h)+" "+(this.relation||"!=")+" "+(Array.isArray(c)?"["+c.join(", ")+"]":c)+")";this.stack=Error().stack}g.prototype=new RangeError;g.prototype.constructor=RangeError;g.prototype.name="DimensionError";g.prototype.isDimensionError=!0;n.exports=g},function(n,h){function g(h,c,a){if(!(this instanceof g))throw new SyntaxError("Constructor must be called with the new operator");
this.index=h;3>arguments.length?(this.min=0,this.max=c):(this.min=c,this.max=a);this.message=void 0!==this.min&&this.index<this.min?"Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?"Index out of range ("+this.index+" > "+(this.max-1)+")":"Index out of range ("+this.index+")";this.stack=Error().stack}g.prototype=new RangeError;g.prototype.constructor=RangeError;g.prototype.name="IndexError";g.prototype.isIndexError=!0;n.exports=g},function(n,h){h.isBoolean=
function(g){return"boolean"==typeof g}},function(n,h){h.memoize=function(g,h){return function a(){"object"!==typeof a.cache&&(a.cache={});for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];d=h?h(b):JSON.stringify(b);return d in a.cache?a.cache[d]:a.cache[d]=g.apply(g,b)}}},function(n,h,g){var q=g(14),c=g(19),a=q.string,b=q.array,d=q.object;n=q.number;var e=Array.isArray,f=n.isNumber,k=n.isInteger,m=a.isString,w=b.validateIndex;h.name="DenseMatrix";h.path="type";h.factory=function(x,p,u,s){function l(a,
c){if(!(this instanceof l))throw new SyntaxError("Constructor must be called with the new operator");if(c&&!m(c))throw Error("Invalid datatype: "+c);if(a&&!0===a.isMatrix)"DenseMatrix"===a.type?(this._data=d.clone(a._data),this._size=d.clone(a._size)):(this._data=a.toArray(),this._size=a.size()),this._datatype=c||a._datatype;else if(a&&e(a.data)&&e(a.size))this._data=a.data,this._size=a.size,this._datatype=c||a.datatype;else{if(e(a))this._data=z(a),this._size=b.size(this._data),b.validate(this._data,
this._size);else{if(a)throw new TypeError("Unsupported type of data ("+q.types.type(a)+")");this._data=[];this._size=[0]}this._datatype=c}}function v(a,b,d,c){var e=c==d-1,f=b.dimension(c);return e?f.map(function(b){return a[b]}).valueOf():f.map(function(e){return v(a[e],b,d,c+1)}).valueOf()}function t(a,e,f,k){if(!e||!0!==e.isIndex)throw new TypeError("Invalid index");var m=e.size(),l=e.isScalar(),w;f&&!0===f.isMatrix?(w=f.size(),f=f.valueOf()):w=b.size(f);if(l){if(0!==w.length)throw new TypeError("Scalar expected");
a.set(e.min(),f,k)}else{if(m.length<a._size.length)throw new c(m.length,a._size.length,"<");if(w.length<m.length){for(var x=l=0;1===m[l]&&1===w[l];)l++;for(;1===m[l];)x++,l++;f=b.unsqueeze(f,m.length,x,w)}if(!d.deepEqual(m,w))throw new c(m,w,">");w=e.max().map(function(a){return a+1});h(a,w,k);r(a._data,e,f,m.length,0)}return a}function r(a,b,d,c,e){var f=e==c-1,k=b.dimension(e);f?k.forEach(function(b,c){w(b);a[b]=d[c[0]]}):k.forEach(function(f,k){w(f);r(a[f],b,d[k[0]],c,e+1)})}function h(a,b,d){for(var c=
a._size.slice(0),e=!1;c.length<b.length;)c.push(0),e=!0;for(var f=0,k=b.length;f<k;f++)b[f]>c[f]&&(c[f]=b[f],e=!0);e&&y(a,c,d)}function z(a){for(var b=0,d=a.length;b<d;b++){var c=a[b];e(c)?a[b]=z(c):c&&!0===c.isMatrix&&(a[b]=z(c.valueOf()))}return a}p=u(g(13));l.prototype=new p;l.prototype.type="DenseMatrix";l.prototype.isDenseMatrix=!0;l.prototype.storage=function(){return"dense"};l.prototype.datatype=function(){return this._datatype};l.prototype.create=function(a,b){return new l(a,b)};l.prototype.subset=
function(a,b,d){switch(arguments.length){case 1:var e;if(!a||!0!==a.isIndex)throw new TypeError("Invalid index");if(a.isScalar())e=this.get(a.min());else{e=a.size();if(e.length!=this._size.length)throw new c(e.length,this._size.length);for(var f=a.min(),k=a.max(),m=0,x=this._size.length;m<x;m++)w(f[m],this._size[m]),w(k[m],this._size[m]);e=new l(v(this._data,a,e.length,0),this._datatype)}return e;case 2:case 3:return t(this,a,b,d);default:throw new SyntaxError("Wrong number of arguments");}};l.prototype.get=
function(a){if(!e(a))throw new TypeError("Array expected");if(a.length!=this._size.length)throw new c(a.length,this._size.length);for(var b=0;b<a.length;b++)w(a[b],this._size[b]);for(var b=this._data,d=0,f=a.length;d<f;d++){var k=a[d];w(k,b.length);b=b[k]}return b};l.prototype.set=function(a,b,d){if(!e(a))throw new TypeError("Array expected");if(a.length<this._size.length)throw new c(a.length,this._size.length,"<");var f,k;f=a.map(function(a){return a+1});h(this,f,d);var m=this._data;d=0;for(f=a.length-
1;d<f;d++)k=a[d],w(k,m.length),m=m[k];k=a[a.length-1];w(k,m.length);m[k]=b;return this};l.prototype.resize=function(a,b,d){if(!e(a))throw new TypeError("Array expected");d=d?this.clone():this;return y(d,a,b)};var y=function(a,d,c){if(0===d.length){for(a=a._data;e(a);)a=a[0];return a}a._size=d.slice(0);a._data=b.resize(a._data,a._size,c);return a};l.prototype.clone=function(){return new l({data:d.clone(this._data),size:d.clone(this._size),datatype:this._datatype})};l.prototype.size=function(){return this._size.slice(0)};
l.prototype.map=function(a){var b=this,c=function(d,f){return e(d)?d.map(function(a,b){return c(a,f.concat(b))}):a(d,f,b)};return new l({data:c(this._data,[]),size:d.clone(this._size),datatype:this._datatype})};l.prototype.forEach=function(a){var b=this,d=function(c,f){e(c)?c.forEach(function(a,b){d(a,f.concat(b))}):a(c,f,b)};d(this._data,[])};l.prototype.toArray=function(){return d.clone(this._data)};l.prototype.valueOf=function(){return this._data};l.prototype.format=function(b){return a.format(this._data,
b)};l.prototype.toString=function(){return a.format(this._data)};l.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}};l.prototype.diagonal=function(a){if(a){if(!0===a.isBigNumber&&(a=a.toNumber()),!f(a)||!k(a))throw new TypeError("The parameter k must be an integer number");}else a=0;var b=0<a?a:0;a=0>a?-a:0;for(var d=Math.min(this._size[0]-a,this._size[1]-b),c=[],e=0;e<d;e++)c[e]=this._data[e+a][e+b];return new l({data:c,size:[d],datatype:this._datatype})};
l.diagonal=function(a,d,c,w,p){if(!e(a))throw new TypeError("Array expected, size parameter");if(2!==a.length)throw Error("Only two dimensions matrix are supported");a=a.map(function(a){a&&!0===a.isBigNumber&&(a=a.toNumber());if(!f(a)||!k(a)||1>a)throw Error("Size values must be positive integers");return a});if(c){if(c&&!0===c.isBigNumber&&(c=c.toNumber()),!f(c)||!k(c))throw new TypeError("The parameter k must be an integer number");}else c=0;w&&m(p)&&(w=s.convert(w,p));p=0<c?c:0;c=0>c?-c:0;var r=
a[0],u=a[1],v=Math.min(r-c,u-p),g;if(e(d)){if(d.length!==v)throw Error("Invalid value array length");g=function(a){return d[a]}}else if(d&&!0===d.isMatrix){g=d.size();if(1!==g.length||g[0]!==v)throw Error("Invalid matrix length");g=function(a){return d.get([a])}}else g=function(){return d};w||(w=g(0)&&!0===g(0).isBigNumber?new x.BigNumber(0):0);var t=[];if(0<a.length)for(t=b.resize(t,a,w),a=0;a<v;a++)t[a+c][a+p]=g(a);return new l({data:t,size:[r,u]})};l.fromJSON=function(a){return new l(a)};l.prototype.swapRows=
function(a,b){if(!(f(a)&&k(a)&&f(b)&&k(b)))throw Error("Row index must be positive integers");if(2!==this._size.length)throw Error("Only two dimensional matrix is supported");w(a,this._size[0]);w(b,this._size[0]);l._swapRows(a,b,this._data);return this};l._swapRows=function(a,b,d){var c=d[a];d[a]=d[b];d[b]=c};x.Matrix._storage.dense=l;return x.Matrix._storage["default"]=l};h.lazy=!1},function(n,h,g){var q=g(25);h.name="sin";h.factory=function(c,a,b,d){var e=d("sin",{number:Math.sin,Complex:function(a){return a.sin()},
BigNumber:function(a){return a.sin()},Unit:function(a){if(!a.hasBase(c.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sin is no angle");return e(a.value)},"Array | Matrix":function(a){return q(a,e,!0)}});e.toTex={1:"\\sin\\left(${args[0]}\\right)"};return e}},function(n,h){n.exports=function q(c,a,b){return c&&"function"===typeof c.map?c.map(function(d){return q(d,a,b)}):a(c)}},function(n,h,g){var q=g(25);h.name="cos";h.factory=function(c,a,b,d){var e=d("cos",{number:Math.cos,Complex:function(a){return a.cos()},
BigNumber:function(a){return a.cos()},Unit:function(a){if(!a.hasBase(c.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cos is no angle");return e(a.value)},"Array | Matrix":function(a){return q(a,e)}});e.toTex={1:"\\cos\\left(${args[0]}\\right)"};return e}},function(n,h,g){var q=g(25);h.name="sqrt";h.factory=function(c,a,b,d){function e(b){return 0<=b||a.predictable?Math.sqrt(b):(new c.Complex(b,0)).sqrt()}var f=d("sqrt",{number:e,Complex:function(a){return a.sqrt()},BigNumber:function(b){return!b.isNegative()||
a.predictable?b.sqrt():e(b.toNumber())},"Array | Matrix":function(a){return q(a,f,!0)},Unit:function(a){return a.pow(.5)}});f.toTex={1:"\\sqrt{${args[0]}}"};return f}},function(n,h,g){h.name="norm";h.factory=function(h,c,a,b){function d(a,b){var c=a.size();if(1==c.length){if(b===Number.POSITIVE_INFINITY||"inf"===b){var s=0;a.forEach(function(a){a=e(a);p(a,s)&&(s=a)},!0);return s}if(b===Number.NEGATIVE_INFINITY||"-inf"===b){var g;a.forEach(function(a){a=e(a);if(!g||u(a,g))g=a},!0);return g||0}if("fro"===
b)return d(a,2);if("number"===typeof b&&!isNaN(b)){if(!x(b,0)){var t=0;a.forEach(function(a){t=f(k(e(a),b),t)},!0);return k(t,1/b)}return Number.POSITIVE_INFINITY}throw Error("Unsupported parameter value");}if(2==c.length){if(1===b){var h=[],q=0;a.forEach(function(a,b){var d=b[1],c=f(h[d]||0,e(a));p(c,q)&&(q=c);h[d]=c},!0);return q}if(b===Number.POSITIVE_INFINITY||"inf"===b){var n=[],G=0;a.forEach(function(a,b){var d=b[0],c=f(n[d]||0,e(a));p(c,G)&&(G=c);n[d]=c},!0);return G}if("fro"===b)return m(l(w(v(a),
a)));if(2===b)throw Error("Unsupported parameter value, missing implementation of matrix singular value decomposition");throw Error("Unsupported parameter value");}}var e=a(g(29)),f=a(g(30)),k=a(g(41)),m=a(g(27)),w=a(g(43)),x=a(g(36)),p=a(g(48)),u=a(g(52)),s=a(g(31)),l=a(g(53)),v=a(g(54)),t=b("norm",{number:Math.abs,Complex:function(a){return a.abs()},BigNumber:function(a){return a.abs()},"boolean | null":function(a){return Math.abs(a)},Array:function(a){return d(s(a),2)},Matrix:function(a){return d(a,
2)},"number | Complex | BigNumber | boolean | null, number | BigNumber | string":function(a){return t(a)},"Array, number | BigNumber | string":function(a,b){return d(s(a),b)},"Matrix, number | BigNumber | string":function(a,b){return d(a,b)}});t.toTex={1:"\\left\\|${args[0]}\\right\\|",2:void 0};return t}},function(n,h,g){var q=g(25);h.name="abs";h.factory=function(c,a,b,d){var e=d("abs",{number:Math.abs,Complex:function(a){return a.abs()},BigNumber:function(a){return a.abs()},Fraction:function(a){return a.abs()},
"Array | Matrix":function(a){return q(a,e,!0)},Unit:function(a){return a.abs()}});e.toTex={1:"\\left|${args[0]}\\right|"};return e}},function(n,h,g){var q=g(3).extend;h.name="add";h.factory=function(c,a,b,d){var e=b(g(31)),f=b(g(32));c=g(33);var k=b(g(34)),m=b(g(35)),w=b(g(38)),x=b(g(39)),p=b(g(40)),u=d("add",q({"Matrix, Matrix":function(a,b){var d;switch(a.storage()){case "sparse":switch(b.storage()){case "sparse":d=m(a,b,f);break;default:d=k(b,a,f,!0)}break;default:switch(b.storage()){case "sparse":d=
k(a,b,f,!1);break;default:d=x(a,b,f)}}return d},"Array, Array":function(a,b){return u(e(a),e(b)).valueOf()},"Array, Matrix":function(a,b){return u(e(a),b)},"Matrix, Array":function(a,b){return u(a,e(b))},"Matrix, any":function(a,b){var d;switch(a.storage()){case "sparse":d=w(a,b,f,!1);break;default:d=p(a,b,f,!1)}return d},"any, Matrix":function(a,b){var d;switch(b.storage()){case "sparse":d=w(b,a,f,!0);break;default:d=p(b,a,f,!0)}return d},"Array, any":function(a,b){return p(e(a),b,f,!1).valueOf()},
"any, Array":function(a,b){return p(e(b),a,f,!0).valueOf()}},f.signatures));u.toTex={2:"\\left(${args[0]}"+c.operators.add+"${args[1]}\\right)"};return u}},function(n,h){h.name="matrix";h.factory=function(g,h,c,a){function b(a,b,c){return new (g.Matrix.storage(b||"default"))(a,c)}h=a("matrix",{"":function(){return b([])},string:function(a){return b([],a)},"string, string":function(a,c){return b([],a,c)},Array:function(a){return b(a)},Matrix:function(a){return b(a,a.storage())},"Array | Matrix, string":b,
"Array | Matrix, string, string":b});h.toTex={0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"};return h}},function(n,h){h.factory=function(g,h,c,a){var b=a("add",{"number, number":function(a,b){return a+b},"Complex, Complex":function(a,b){return a.add(b)},"BigNumber, BigNumber":function(a,b){return a.plus(b)},"Fraction, Fraction":function(a,b){return a.add(b)},"Unit, Unit":function(a,c){if(null==a.value)throw Error("Parameter x contains a unit with undefined value");
if(null==c.value)throw Error("Parameter y contains a unit with undefined value");if(!a.equalBase(c))throw Error("Units do not match");var f=a.clone();f.value=b(f.value,c.value);f.fixPrefix=!1;return f}});return b}},function(n,h){h.symbols={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",
Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega","true":"\\mathrm{True}",
"false":"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"};h.operators={transpose:"^\\top",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",
largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"};h.defaultTemplate="\\mathrm{${name}}\\left(${args}\\right)";var g={deg:"^\\circ"};h.toSymbol=function(q,c){if("undefined"===typeof c?0:c)return g.hasOwnProperty(q)?g[q]:"\\mathrm{"+q+"}";if(h.symbols.hasOwnProperty(q))return h.symbols[q];if(-1!==q.indexOf("_")){var a=q.indexOf("_");return h.toSymbol(q.substring(0,a))+"_{"+h.toSymbol(q.substring(a+1))+"}"}return q}},function(n,h,g){var q=g(19);
h.name="algorithm01";h.factory=function(c,a,b,d){var e=c.DenseMatrix;return function(a,b,c,w){var x=a._data,p=a._size,u=a._datatype;a=b._values;var s=b._index,l=b._ptr,g=b._size,t=b._datatype;if(p.length!==g.length)throw new q(p.length,g.length);if(p[0]!==g[0]||p[1]!==g[1])throw new RangeError("Dimension mismatch. Matrix A ("+p+") must match Matrix B ("+g+")");if(!a)throw Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");b=p[0];p=p[1];c=(u="string"===typeof u&&u===t?u:void 0)?
d.find(c,[u,u]):c;for(var r=[],t=0;t<b;t++)r[t]=[];for(var h=[],z=[],g=0;g<p;g++){for(var y=g+1,n=l[g+1],B=l[g];B<n;B++)t=s[B],h[t]=w?c(a[B],x[t][g]):c(x[t][g],a[B]),z[t]=y;for(t=0;t<b;t++)r[t][g]=z[t]===y?h[t]:x[t][g]}return new e({data:r,size:[b,p],datatype:u})}}},function(n,h,g){var q=g(19);h.name="algorithm04";h.factory=function(c,a,b,d){var e=b(g(36)),f=c.SparseMatrix;return function(a,b,c){var x=a._values,p=a._index,g=a._ptr,s=a._size,l=a._datatype;a=b._values;var v=b._index,t=b._ptr,r=b._size,
h=b._datatype;if(s.length!==r.length)throw new q(s.length,r.length);if(s[0]!==r[0]||s[1]!==r[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+r+")");var z=s[0],s=s[1],y;b=e;var r=0,n=c;"string"===typeof l&&l===h&&(y=l,b=d.find(e,[y,y]),r=d.convert(0,y),n=d.find(c,[y,y]));c=x&&a?[]:void 0;l=[];h=[];y=new f({values:c,index:l,ptr:h,size:[z,s],datatype:y});var z=x&&a?[]:void 0,B=x&&a?[]:void 0,C=[],F=[],H,G,K,O;for(G=0;G<s;G++){h[G]=l.length;var P=G+1;H=g[G];O=g[G+
1];for(K=H;K<O;K++)H=p[K],l.push(H),C[H]=P,z&&(z[H]=x[K]);H=t[G];O=t[G+1];for(K=H;K<O;K++)if(H=v[K],C[H]===P){if(z){var N=n(z[H],a[K]);b(N,r)?C[H]=null:z[H]=N}}else l.push(H),F[H]=P,B&&(B[H]=a[K]);if(z&&B)for(K=h[G];K<l.length;)H=l[K],C[H]===P?(c[K]=z[H],K++):F[H]===P?(c[K]=B[H],K++):l.splice(K,1)}h[s]=l.length;return y}}},function(n,h,g){var q=g(6).nearlyEqual,c=g(37);h.factory=function(a,b,d,e){var f=e("equalScalar",{"boolean, boolean":function(a,b){return a===b},"number, number":function(a,d){return a===
d||q(a,d,b.epsilon)},"BigNumber, BigNumber":function(a,d){return a.eq(d)||c(a,d,b.epsilon)},"Fraction, Fraction":function(a,b){return a.equals(b)},"Complex, Complex":function(a,b){return a.equals(b)},"Unit, Unit":function(a,b){if(!a.equalBase(b))throw Error("Cannot compare units with different base");return f(a.value,b.value)},"string, string":function(a,b){return a===b}});return f}},function(n,h){n.exports=function(g,h,c){if(null==c)return g.eq(h);if(g.eq(h))return!0;if(g.isNaN()||h.isNaN())return!1;
if(g.isFinite()&&h.isFinite()){var a=g.minus(h).abs();if(a.isZero())return!0;g=g.constructor.max(g.abs(),h.abs());return a.lte(g.times(c))}return!1}},function(n,h){h.name="algorithm10";h.factory=function(g,h,c,a){var b=g.DenseMatrix;return function(d,c,f,k){var m=d._values,w=d._index,x=d._ptr,p=d._size,g=d._datatype;if(!m)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");d=p[0];var p=p[1],s,l=f;"string"===typeof g&&(s=g,c=a.convert(c,s),l=a.find(f,[s,s]));f=[];s=new b({data:f,
size:[d,p],datatype:s});for(var g=[],h=[],t=0;t<p;t++){for(var r=t+1,D=x[t+1],z=x[t];z<D;z++){var y=w[z];g[y]=m[z];h[y]=r}for(D=0;D<d;D++)0===t&&(f[D]=[]),f[D][t]=h[D]===r?k?l(c,g[D]):l(g[D],c):c}return s}}},function(n,h,g){g(14);var q=g(19);h.name="algorithm13";h.factory=function(c,a,b,d){var e=c.DenseMatrix,f=function(a,b,d,c,e,g){var s=[];if(b===d.length-1)for(b=0;b<c;b++)s[b]=a(e[b],g[b]);else for(var l=0;l<c;l++)s[l]=f(a,b+1,d,d[b+1],e[l],g[l]);return s};return function(a,b,c){var x=a._data,
p=a._size,g=a._datatype,s=b._data,l=b._size,h=b._datatype;a=[];if(p.length!==l.length)throw new q(p.length,l.length);for(var t=0;t<p.length;t++){if(p[t]!==l[t])throw new RangeError("Dimension mismatch. Matrix A ("+p+") must match Matrix B ("+l+")");a[t]=p[t]}var r,p=c;"string"===typeof g&&g===h&&(r=g,d.convert(b,r),p=d.find(c,[r,r]));b=0<a.length?f(p,0,a,a[0],x,s):[];return new e({data:b,size:a,datatype:r})}}},function(n,h,g){var q=g(3).clone;h.name="algorithm14";h.factory=function(c,a,b,d){var e=
c.DenseMatrix,f=function(a,b,d,c,e,g,s){var l=[];if(b===d.length-1)for(b=0;b<c;b++)l[b]=s?a(g,e[b]):a(e[b],g);else for(var h=0;h<c;h++)l[h]=f(a,b+1,d,d[b+1],e[h],g,s);return l};return function(a,b,c,x){var p=a._data,g=a._size;a=a._datatype;var s,l=c;"string"===typeof a&&(s=a,b=d.convert(b,s),l=d.find(c,[s,s]));b=0<g.length?f(l,0,g,g[0],p,b,x):[];return new e({data:b,size:q(g),datatype:s})}}},function(n,h,g){var q=g(6).isInteger,c=g(15).size;h.name="pow";h.factory=function(a,b,d,e){function f(d,c){if(b.predictable&&
!q(c)&&0>d)try{var e=s(c),f=l(e);if((c===f||1E-14>Math.abs((c-f)/c))&&1===e.d%2)return(0===e.n%2?1:-1)*Math.pow(-d,c)}catch(k){}return q(c)||0<=d||b.predictable?Math.pow(d,c):(new a.Complex(d,0)).pow(c,0)}function k(a,b){if(!q(b)||0>b)throw new TypeError("For A^b, b must be a positive integer (value is "+b+")");var d=c(a);if(2!=d.length)throw Error("For A^b, A must be 2 dimensional (A has "+d.length+" dimensions)");if(d[0]!=d[1])throw Error("For A^b, A must be square (size is "+d[0]+"x"+d[1]+")");
for(var d=x(d[0]).valueOf(),e=a;1<=b;)1==(b&1)&&(d=p(e,d)),b>>=1,e=p(e,e);return d}function m(a,b){return u(k(a.valueOf(),b))}var w=g(33),x=d(g(42)),p=d(g(43)),u=d(g(31)),s=d(g(46)),l=d(g(47));d=e("pow",{"number, number":f,"Complex, Complex":function(a,b){return a.pow(b)},"BigNumber, BigNumber":function(d,c){return c.isInteger()||0<=d||b.predictable?d.pow(c):(new a.Complex(d.toNumber(),0)).pow(c.toNumber(),0)},"Fraction, Fraction":function(a,d){if(1!==d.d){if(b.predictable)throw Error("Function pow does not support non-integer exponents for fractions.");
return f(a.valueOf(),d.valueOf())}return a.pow(d)},"Array, number":k,"Array, BigNumber":function(a,b){return k(a,b.toNumber())},"Matrix, number":m,"Matrix, BigNumber":function(a,b){return m(a,b.toNumber())},"Unit, number":function(a,b){return a.pow(b)}});d.toTex={2:"\\left(${args[0]}\\right)"+w.operators.pow+"{${args[1]}}"};return d}},function(n,h,g){var q=g(15),c=g(6).isInteger;h.name="eye";h.factory=function(a,b,d,e){function f(a,b){switch(a.length){case 0:return b?m(b):[];case 1:return k(a[0],
a[0],b);case 2:return k(a[0],a[1],b);default:throw Error("Vector containing two values expected");}}function k(b,d,e){var f=b&&!0===b.isBigNumber?a.BigNumber:d&&!0===d.isBigNumber?a.BigNumber:null;b&&!0===b.isBigNumber&&(b=b.toNumber());d&&!0===d.isBigNumber&&(d=d.toNumber());if(!c(b)||1>b)throw Error("Parameters in function eye must be positive integers");if(!c(d)||1>d)throw Error("Parameters in function eye must be positive integers");var k=f?new a.BigNumber(1):1,f=f?new f(0):0,m=[b,d];if(e)return a.Matrix.storage(e).diagonal(m,
k,0,f);e=q.resize([],m,f);b=b<d?b:d;for(d=0;d<b;d++)e[d][d]=k;return e}var m=d(g(31));d=e("eye",{"":function(){return"Matrix"===b.matrix?m([]):[]},string:function(a){return m(a)},"number | BigNumber":function(a){return k(a,a,"Matrix"===b.matrix?"default":void 0)},"number | BigNumber, string":function(a,b){return k(a,a,b)},"number | BigNumber, number | BigNumber":function(a,d){return k(a,d,"Matrix"===b.matrix?"default":void 0)},"number | BigNumber, number | BigNumber, string":function(a,b,d){return k(a,
b,d)},Array:function(a){return f(a)},"Array, string":function(a,b){return f(a,b)},Matrix:function(a){return f(a.valueOf(),a.storage())},"Matrix, string":function(a,b){return f(a.valueOf(),b)}});d.toTex=void 0;return d}},function(n,h,g){var q=g(3).extend,c=g(15);h.name="multiply";h.factory=function(a,b,d,e){b=g(33);var f=d(g(31)),k=d(g(32)),m=d(g(44)),w=d(g(36)),x=d(g(45)),p=d(g(40)),h=a.DenseMatrix,s=a.SparseMatrix,l=e("multiply",q({"Array, Array":function(a,b){v(c.size(a),c.size(b));var d=l(f(a),
f(b));return d&&!0===d.isMatrix?d.valueOf():d},"Matrix, Matrix":function(a,b){var d=a.size(),c=b.size();v(d,c);if(1===d.length){if(1===c.length){var f=d[0];if(0===f)throw Error("Cannot multiply two empty vectors");var l=a._data,x=a._datatype,p=b._data,g=b._datatype,d=k,c=m;x&&g&&x===g&&"string"===typeof x&&(d=e.find(k,[x,x]),c=e.find(m,[x,x]));x=c(l[0],p[0]);for(g=1;g<f;g++)x=d(x,c(l[g],p[g]));return x}a:{switch(b.storage()){case "dense":var f=a._data,q=a._datatype,l=b._data,n=b._datatype,d=a._size[0],
c=b._size[1],x=k,g=m;q&&n&&q===n&&"string"===typeof q&&(p=q,x=e.find(k,[p,p]),g=e.find(m,[p,p]));q=[];for(n=0;n<c;n++){for(var O=g(f[0],l[0][n]),P=1;P<d;P++)O=x(O,g(f[P],l[P][n]));q[n]=O}f=new h({data:q,size:[c],datatype:p});break a}throw Error("Not implemented");}return f}if(1===c.length){a:{switch(a.storage()){case "dense":f=a._data;c=a._size;q=a._datatype;p=b._data;n=b._datatype;d=c[0];c=c[1];x=k;g=m;q&&n&&q===n&&"string"===typeof q&&(l=q,x=e.find(k,[l,l]),g=e.find(m,[l,l]));q=[];for(n=0;n<d;n++){for(var O=
f[n],P=g(O[0],p[0]),N=1;N<c;N++)P=x(P,g(O[N],p[N]));q[n]=P}f=new h({data:q,size:[d],datatype:l});break a;case "sparse":var x=a._values,g=a._index,q=a._ptr,A=a._datatype;if(!x)throw Error("Cannot multiply Pattern only Matrix times Dense Matrix");var n=b._data,L=b._datatype,l=a._size[0],O=b._size[0],p=[],d=[],c=[],P=k,N=m,T=w,Y=0;A&&L&&A===L&&"string"===typeof A&&(f=A,P=e.find(k,[f,f]),N=e.find(m,[f,f]),T=e.find(w,[f,f]),Y=e.convert(0,f));for(var A=[],L=[],U=c[0]=0;U<O;U++){var I=n[U];if(!T(I,Y))for(var Z=
q[U+1],ia=q[U];ia<Z;ia++){var ma=g[ia];L[ma]?A[ma]=P(A[ma],N(I,x[ia])):(L[ma]=!0,d.push(ma),A[ma]=N(I,x[ia]))}}x=d.length;for(g=0;g<x;g++)p[g]=A[d[g]];c[1]=d.length;f=new s({values:p,index:d,ptr:c,size:[l,1],datatype:f});break a}f=void 0}return f}return t(a,b)},"Matrix, Array":function(a,b){return l(a,f(b))},"Array, Matrix":function(a,b){return l(f(a,b.storage()),b)},"Matrix, any":function(a,b){var d;switch(a.storage()){case "sparse":d=x(a,b,m,!1);break;case "dense":d=p(a,b,m,!1)}return d},"any, Matrix":function(a,
b){var d;switch(b.storage()){case "sparse":d=x(b,a,m,!0);break;case "dense":d=p(b,a,m,!0)}return d},"Array, any":function(a,b){return p(f(a),b,m,!1).valueOf()},"any, Array":function(a,b){return p(f(b),a,m,!0).valueOf()}},m.signatures)),v=function(a,b){switch(a.length){case 1:switch(b.length){case 1:if(a[0]!==b[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(a[0]!==b[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+
a[0]+") must match Matrix rows ("+b[0]+")");break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+b.length+" dimensions)");}break;case 2:switch(b.length){case 1:if(a[1]!==b[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+a[1]+") must match Vector length ("+b[0]+")");break;case 2:if(a[1]!==b[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+a[1]+") must match Matrix B rows ("+b[0]+")");break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+
b.length+" dimensions)");}break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+a.length+" dimensions)");}},t=function(a,b){switch(a.storage()){case "dense":switch(b.storage()){case "dense":var d=a._data,c=a._size,f=a._datatype,l=b._data,x=b._datatype,g=c[0],p=c[1],t=b._size[1],v,q=k,n=m;f&&x&&f===x&&"string"===typeof f&&(v=f,q=e.find(k,[v,v]),n=e.find(m,[v,v]));for(var N=[],A=0;A<g;A++){var L=d[A];N[A]=[];for(var T=0;T<t;T++){for(var Y=n(L[0],l[0][T]),U=1;U<p;U++)Y=
q(Y,n(L[U],l[U][T]));N[A][T]=Y}}return new h({data:N,size:[g,t],datatype:v});case "sparse":var I=a._data,Z=a._size,ia=a._datatype,ma=b._values,ub=b._index,ha=b._ptr,$=b._size,da=b._datatype;if(!ma)throw Error("Cannot multiply Dense Matrix times Pattern only Matrix");var ka=Z[0],ta=$[1],la,xa=k,ua=m,ya=w,za=0;ia&&da&&ia===da&&"string"===typeof ia&&(la=ia,xa=e.find(k,[la,la]),ua=e.find(m,[la,la]),ya=e.find(w,[la,la]),za=e.convert(0,la));for(var M=[],va=[],Fa=[],La=new s({values:M,index:va,ptr:Fa,size:[ka,
ta],datatype:la}),ba=0;ba<ta;ba++){Fa[ba]=va.length;var R=ha[ba],ga=ha[ba+1];if(ga>R)for(var J=0,X=0;X<ka;X++){for(var aa=X+1,Q,ea=R;ea<ga;ea++){var ca=ub[ea];J!==aa?(Q=ua(I[X][ca],ma[ea]),J=aa):Q=xa(Q,ua(I[X][ca],ma[ea]))}J!==aa||ya(Q,za)||(va.push(X),M.push(Q))}}Fa[ta]=va.length;return La}break;case "sparse":switch(b.storage()){case "dense":var V=a._values,fa=a._index,S=a._ptr,pa=a._datatype;if(!V)throw Error("Cannot multiply Pattern only Matrix times Dense Matrix");var Ba=b._data,Ga=b._datatype,
Oa=a._size[0],ja=b._size[0],ra=b._size[1],sa,hb=k,bb=m,ib=w,jb=0;pa&&Ga&&pa===Ga&&"string"===typeof pa&&(sa=pa,hb=e.find(k,[sa,sa]),bb=e.find(m,[sa,sa]),ib=e.find(w,[sa,sa]),jb=e.convert(0,sa));for(var kb=[],W=[],Pa=[],vb=new s({values:kb,index:W,ptr:Pa,size:[Oa,ra],datatype:sa}),Qa=[],lb=[],Ha=0;Ha<ra;Ha++){Pa[Ha]=W.length;for(var mb=Ha+1,Ma=0;Ma<ja;Ma++){var cb=Ba[Ma][Ha];if(!ib(cb,jb))for(var wb=S[Ma+1],Ca=S[Ma];Ca<wb;Ca++){var Ia=fa[Ca];lb[Ia]!==mb?(lb[Ia]=mb,W.push(Ia),Qa[Ia]=bb(cb,V[Ca])):Qa[Ia]=
hb(Qa[Ia],bb(cb,V[Ca]))}}for(var xb=W.length,Ra=Pa[Ha];Ra<xb;Ra++)kb[Ra]=Qa[W[Ra]]}Pa[ra]=W.length;return vb;case "sparse":var db=a._values,nb=a._index,Sa=a._ptr,Ta=a._datatype,eb=b._values,yb=b._index,ob=b._ptr,pb=b._datatype,zb=a._size[0],fb=b._size[1],Ua=db&&eb,Ja,qb=k,gb=m;Ta&&pb&&Ta===pb&&"string"===typeof Ta&&(Ja=Ta,qb=e.find(k,[Ja,Ja]),gb=e.find(m,[Ja,Ja]));for(var rb=Ua?[]:void 0,Da=[],Va=[],Ab=new s({values:rb,index:Da,ptr:Va,size:[zb,fb],datatype:Ja}),Wa=Ua?[]:void 0,Xa=[],qa,Ya,Za,Ka,sb,
tb,na,Na,Ea=0;Ea<fb;Ea++){Va[Ea]=Da.length;var $a=Ea+1;sb=ob[Ea];tb=ob[Ea+1];for(Ka=sb;Ka<tb;Ka++)if(Na=yb[Ka],Ua)for(Ya=Sa[Na],Za=Sa[Na+1],qa=Ya;qa<Za;qa++)na=nb[qa],Xa[na]!==$a?(Xa[na]=$a,Da.push(na),Wa[na]=gb(eb[Ka],db[qa])):Wa[na]=qb(Wa[na],gb(eb[Ka],db[qa]));else for(Ya=Sa[Na],Za=Sa[Na+1],qa=Ya;qa<Za;qa++)na=nb[qa],Xa[na]!==$a&&(Xa[na]=$a,Da.push(na));if(Ua)for(var Bb=Da.length,ab=Va[Ea];ab<Bb;ab++)rb[ab]=Wa[Da[ab]]}Va[fb]=Da.length;return Ab}}};l.toTex={2:"\\left(${args[0]}"+b.operators.multiply+
"${args[1]}\\right)"};return l}},function(n,h){h.factory=function(g,h,c,a){var b=a("multiplyScalar",{"number, number":function(a,b){return a*b},"Complex, Complex":function(a,b){return a.mul(b)},"BigNumber, BigNumber":function(a,b){return a.times(b)},"Fraction, Fraction":function(a,b){return a.mul(b)},"number | Fraction | BigNumber | Complex, Unit":function(a,c){var f=c.clone();f.value=null===f.value?f._normalize(a):b(f.value,a);return f},"Unit, number | Fraction | BigNumber | Complex":function(a,
c){var f=a.clone();f.value=null===f.value?f._normalize(c):b(f.value,c);return f},"Unit, Unit":function(a,b){return a.multiply(b)}});return b}},function(n,h,g){h.name="algorithm11";h.factory=function(h,c,a,b){var d=a(g(36)),e=h.SparseMatrix;return function(a,c,m,w){var x=a._values,g=a._index,h=a._ptr,s=a._size,l=a._datatype;if(!x)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var v=s[0],s=s[1],t;a=d;var r=0,q=m;"string"===typeof l&&(t=l,a=b.find(d,[t,t]),r=b.convert(0,
t),c=b.convert(c,t),q=b.find(m,[t,t]));m=[];var l=[],n=[];t=new e({values:m,index:l,ptr:n,size:[v,s],datatype:t});for(v=0;v<s;v++){n[v]=l.length;for(var y=h[v+1],E=h[v];E<y;E++){var B=g[E],C=w?q(c,x[E]):q(x[E],c);a(C,r)||(l.push(B),m.push(C))}}n[s]=l.length;return t}}},function(n,h,g){var q=g(25);h.name="fraction";h.factory=function(c,a,b,d){var e=d("fraction",{number:function(a){if(!isFinite(a)||isNaN(a))throw Error(a+" cannot be represented as a fraction");return new c.Fraction(a)},string:function(a){return new c.Fraction(a)},
"number, number":function(a,b){return new c.Fraction(a,b)},BigNumber:function(a){return new c.Fraction(a.toString())},Fraction:function(a){return a},Object:function(a){return new c.Fraction(a)},"Array | Matrix":function(a){return q(a,e)}});return e}},function(n,h,g){var q=g(25);h.name="number";h.factory=function(c,a,b,d){var e=d("number",{"":function(){return 0},number:function(a){return a},string:function(a){var b=Number(a);if(isNaN(b))throw new SyntaxError('String "'+a+'" is no valid number');return b},
BigNumber:function(a){return a.toNumber()},Fraction:function(a){return a.valueOf()},Unit:function(a){throw Error("Second argument with valueless unit expected");},"Unit, string | Unit":function(a,b){return a.toNumber(b)},"Array | Matrix":function(a){return q(a,e)}});e.toTex={0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"};return e}},function(n,h,g){var q=g(6).nearlyEqual,c=g(37);h.name="larger";h.factory=function(a,b,d,e){var f=d(g(31)),k=d(g(49)),m=d(g(50)),
w=d(g(51)),x=d(g(39)),p=d(g(40));a=g(33);var h=e("larger",{"boolean, boolean":function(a,b){return a>b},"number, number":function(a,d){return a>d&&!q(a,d,b.epsilon)},"BigNumber, BigNumber":function(a,d){return a.gt(d)&&!c(a,d,b.epsilon)},"Fraction, Fraction":function(a,b){return 1===a.compare(b)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers");},"Unit, Unit":function(a,b){if(!a.equalBase(b))throw Error("Cannot compare units with different base");
return h(a.value,b.value)},"string, string":function(a,b){return a>b},"Matrix, Matrix":function(a,b){var d;switch(a.storage()){case "sparse":switch(b.storage()){case "sparse":d=m(a,b,h);break;default:d=k(b,a,h,!0)}break;default:switch(b.storage()){case "sparse":d=k(a,b,h,!1);break;default:d=x(a,b,h)}}return d},"Array, Array":function(a,b){return h(f(a),f(b)).valueOf()},"Array, Matrix":function(a,b){return h(f(a),b)},"Matrix, Array":function(a,b){return h(a,f(b))},"Matrix, any":function(a,b){var d;
switch(a.storage()){case "sparse":d=w(a,b,h,!1);break;default:d=p(a,b,h,!1)}return d},"any, Matrix":function(a,b){var d;switch(b.storage()){case "sparse":d=w(b,a,h,!0);break;default:d=p(b,a,h,!0)}return d},"Array, any":function(a,b){return p(f(a),b,h,!1).valueOf()},"any, Array":function(a,b){return p(f(b),a,h,!0).valueOf()}});h.toTex={2:"\\left(${args[0]}"+a.operators.larger+"${args[1]}\\right)"};return h}},function(n,h,g){var q=g(19);h.name="algorithm03";h.factory=function(c,a,b,d){var e=c.DenseMatrix;
return function(a,b,c,w){var x=a._data,g=a._size,h=a._datatype;a=b._values;var s=b._index,l=b._ptr,v=b._size,t=b._datatype;if(g.length!==v.length)throw new q(g.length,v.length);if(g[0]!==v[0]||g[1]!==v[1])throw new RangeError("Dimension mismatch. Matrix A ("+g+") must match Matrix B ("+v+")");if(!a)throw Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");b=g[0];var g=g[1],r,v=0,n=c;"string"===typeof h&&h===t&&(r=h,v=d.convert(0,r),n=d.find(c,[r,r]));c=[];for(h=0;h<b;h++)c[h]=
[];for(var h=[],t=[],z=0;z<g;z++){for(var y=z+1,E=l[z+1],B=l[z];B<E;B++){var C=s[B];h[C]=w?n(a[B],x[C][z]):n(x[C][z],a[B]);t[C]=y}for(E=0;E<b;E++)c[E][z]=t[E]===y?h[E]:w?n(v,x[E][z]):n(x[E][z],v)}return new e({data:c,size:[b,g],datatype:r})}}},function(n,h,g){var q=g(19);h.name="algorithm07";h.factory=function(c,a,b,d){var e=c.DenseMatrix,f=function(a,b,d,c,e){var f=a._values,g=a._index,l=a._ptr;a=l[b];for(b=l[b+1];a<b;a++)l=g[a],d[l]=e,c[l]=f[a]};return function(a,b,c){var g=a._size,p=a._datatype,
h=b._size,s=b._datatype;if(g.length!==h.length)throw new q(g.length,h.length);if(g[0]!==h[0]||g[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+g+") must match Matrix B ("+h+")");var h=g[0],g=g[1],l,v=0,t=c;"string"===typeof p&&p===s&&(l=p,v=d.convert(0,l),t=d.find(c,[l,l]));p=[];for(c=0;c<h;c++)p[c]=[];var s=new e({data:p,size:[h,g],datatype:l}),r=[],n=[],z=[],y=[];for(l=0;l<g;l++){var E=l+1;f(a,l,z,r,E);f(b,l,y,n,E);for(c=0;c<h;c++)p[c][l]=t(z[c]===E?r[c]:v,y[c]===E?n[c]:v)}return s}}},
function(n,h){h.name="algorithm12";h.factory=function(g,h,c,a){var b=g.DenseMatrix;return function(d,c,f,k){var m=d._values,w=d._index,g=d._ptr,p=d._size,h=d._datatype;if(!m)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");d=p[0];var p=p[1],s,l=f;"string"===typeof h&&(s=h,c=a.convert(c,s),l=a.find(f,[s,s]));f=[];s=new b({data:f,size:[d,p],datatype:s});for(var h=[],v=[],t=0;t<p;t++){for(var r=t+1,q=g[t+1],n=g[t];n<q;n++){var y=w[n];h[y]=m[n];v[y]=r}for(q=0;q<d;q++)0===
t&&(f[q]=[]),f[q][t]=v[q]===r?k?l(c,h[q]):l(h[q],c):k?l(c,0):l(0,c)}return s}}},function(n,h,g){var q=g(6).nearlyEqual,c=g(37);h.name="smaller";h.factory=function(a,b,d,e){var f=d(g(31)),k=d(g(49)),m=d(g(50)),w=d(g(51)),x=d(g(39)),p=d(g(40));a=g(33);var h=e("smaller",{"boolean, boolean":function(a,b){return a<b},"number, number":function(a,d){return a<d&&!q(a,d,b.epsilon)},"BigNumber, BigNumber":function(a,d){return a.lt(d)&&!c(a,d,b.epsilon)},"Fraction, Fraction":function(a,b){return-1===a.compare(b)},
"Complex, Complex":function(a,b){throw new TypeError("No ordering relation is defined for complex numbers");},"Unit, Unit":function(a,b){if(!a.equalBase(b))throw Error("Cannot compare units with different base");return h(a.value,b.value)},"string, string":function(a,b){return a<b},"Matrix, Matrix":function(a,b){var d;switch(a.storage()){case "sparse":switch(b.storage()){case "sparse":d=m(a,b,h);break;default:d=k(b,a,h,!0)}break;default:switch(b.storage()){case "sparse":d=k(a,b,h,!1);break;default:d=
x(a,b,h)}}return d},"Array, Array":function(a,b){return h(f(a),f(b)).valueOf()},"Array, Matrix":function(a,b){return h(f(a),b)},"Matrix, Array":function(a,b){return h(a,f(b))},"Matrix, any":function(a,b){var d;switch(a.storage()){case "sparse":d=w(a,b,h,!1);break;default:d=p(a,b,h,!1)}return d},"any, Matrix":function(a,b){var d;switch(b.storage()){case "sparse":d=w(b,a,h,!0);break;default:d=p(b,a,h,!0)}return d},"Array, any":function(a,b){return p(f(a),b,h,!1).valueOf()},"any, Array":function(a,b){return p(f(b),
a,h,!0).valueOf()}});h.toTex={2:"\\left(${args[0]}"+a.operators.smaller+"${args[1]}\\right)"};return h}},function(n,h,g){var q=g(3).clone,c=g(16).format;h.name="trace";h.factory=function(a,b,d,e){var f=d(g(31)),k=d(g(30)),m=e("trace",{Array:function(a){return m(f(a))},Matrix:function(a){var b;switch(a.storage()){case "dense":a:{var d=a._size;b=a._data;switch(d.length){case 1:if(1==d[0]){b=q(b[0]);break a}throw new RangeError("Matrix must be square (size: "+c(d)+")");case 2:var e=d[0];if(e===d[1]){for(a=
d=0;a<e;a++)d=k(d,b[a][a]);b=d;break a}throw new RangeError("Matrix must be square (size: "+c(d)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+c(d)+")");}}break;case "sparse":b=a._values;var e=a._index,d=a._ptr,f=a._size;a=f[1];if(f[0]===a){f=0;if(0<b.length)for(var m=0;m<a;m++)for(var g=d[m+1],h=d[m];h<g;h++){var r=e[h];if(r===m){f=k(f,b[h]);break}if(r>m)break}b=f}else throw new RangeError("Matrix must be square (size: "+c(f)+")");}return b},any:q});m.toTex={1:"\\mathrm{tr}\\left(${args[0]}\\right)"};
return m}},function(n,h,g){var q=g(3).clone,c=g(16).format;h.name="transpose";h.factory=function(a,b,d,e){b=g(33);var f=d(g(31)),k=a.DenseMatrix,m=a.SparseMatrix,w=e("transpose",{Array:function(a){return w(f(a)).valueOf()},Matrix:function(a){var b=a.size(),d;switch(b.length){case 1:d=a.clone();break;case 2:var e=b[0],f=b[1];if(0===f)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+c(b)+")");switch(a.storage()){case "dense":b=a._data;d=[];for(var w,g=0;g<f;g++){w=d[g]=[];
for(var h=0;h<e;h++)w[h]=q(b[h][g])}d=new k({data:d,size:[f,e],datatype:a._datatype});break;case "sparse":b=a._values;d=a._index;w=a._ptr;for(var g=b?[]:void 0,h=[],n=[],z=[],y=0;y<e;y++)z[y]=0;var E,y=0;for(E=d.length;y<E;y++)z[d[y]]++;for(E=y=0;E<e;E++)n.push(y),y+=z[E],z[E]=n[E];n.push(y);for(y=0;y<f;y++){E=w[y+1];for(var B=w[y];B<E;B++){var C=z[d[B]]++;h[C]=y;b&&(g[C]=q(b[B]))}}d=new m({values:g,index:h,ptr:n,size:[f,e],datatype:a._datatype})}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+
c(this._size)+")");}return d},any:function(a){return q(a)}});w.toTex={1:"\\left(${args[0]}\\right)"+b.operators.transpose};return w}},function(n,h,g){var q=g(3).extend;h.name="divide";h.factory=function(c,a,b,d){var e=b(g(56)),f=b(g(43)),k=b(g(57)),m=b(g(31)),w=b(g(45)),h=b(g(40));c=d("divide",q({"Array | Matrix, Array | Matrix":function(a,b){return f(a,k(b))},"Matrix, any":function(a,b){var d;switch(a.storage()){case "sparse":d=w(a,b,e,!1);break;case "dense":d=h(a,b,e,!1)}return d},"Array, any":function(a,
b){return h(m(a),b,e,!1).valueOf()},"any, Array | Matrix":function(a,b){return f(a,k(b))}},e.signatures));c.toTex={2:"\\frac{${args[0]}}{${args[1]}}"};return c}},function(n,h,g){h.factory=function(h,c,a,b){var d=a(g(44)),e=b("divide",{"number, number":function(a,b){return a/b},"Complex, Complex":function(a,b){return a.div(b)},"BigNumber, BigNumber":function(a,b){return a.div(b)},"Fraction, Fraction":function(a,b){return a.div(b)},"Unit, number | Fraction | BigNumber":function(a,b){var d=a.clone();
d.value=e(null===d.value?d._normalize(1):d.value,b);return d},"number | Fraction | BigNumber, Unit":function(a,b){var c=b.pow(-1);c.value=d(null===c.value?c._normalize(1):c.value,a);return c},"Unit, Unit":function(a,b){return a.divide(b)}});return e}},function(n,h,g){var q=g(14);h.name="inv";h.factory=function(c,a,b,d){function e(a,b,d){var c,e;if(1==b){b=a[0][0];if(0==b)throw Error("Cannot calculate inverse, determinant is zero");return[[k(1,b)]]}if(2==b){b=p(a);if(0==b)throw Error("Cannot calculate inverse, determinant is zero");
return[[k(a[1][1],b),k(h(a[0][1]),b)],[k(h(a[1][0]),b),k(a[0][0],b)]]}var f=a.concat();for(a=0;a<b;a++)f[a]=f[a].concat();for(var g=u(b).valueOf(),q=0;q<d;q++){for(a=q;a<b&&0==f[a][q];)a++;if(a==b||0==f[a][q])throw Error("Cannot calculate inverse, determinant is zero");a!=q&&(c=f[q],f[q]=f[a],f[a]=c,c=g[q],g[q]=g[a],g[a]=c);var n=f[q],B=g[q];for(a=0;a<b;a++){var C=f[a],F=g[a];if(a!=q){if(0!=C[q]){e=k(h(C[q]),n[q]);for(c=q;c<d;c++)C[c]=m(C[c],w(e,n[c]));for(c=0;c<d;c++)F[c]=m(F[c],w(e,B[c]))}}else{e=
n[q];for(c=q;c<d;c++)C[c]=k(C[c],e);for(c=0;c<d;c++)F[c]=k(F[c],e)}}}return g}var f=b(g(31)),k=b(g(56)),m=b(g(32)),w=b(g(43)),h=b(g(58)),p=b(g(59)),u=b(g(42));c=d("inv",{"Array | Matrix":function(a){var b=!0===a.isMatrix?a.size():q.array.size(a);switch(b.length){case 1:if(1==b[0])return!0===a.isMatrix?f([k(1,a.valueOf()[0])]):[k(1,a[0])];throw new RangeError("Matrix must be square (size: "+q.string.format(b)+")");case 2:var d=b[0],c=b[1];if(d==c)return!0===a.isMatrix?f(e(a.valueOf(),d,c),a.storage()):
e(a,d,c);throw new RangeError("Matrix must be square (size: "+q.string.format(b)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+q.string.format(b)+")");}},any:function(a){return k(1,a)}});c.toTex={1:"\\left(${args[0]}\\right)^{-1}"};return c}},function(n,h,g){var q=g(25);h.name="unaryMinus";h.factory=function(c,a,b,d){c=g(33);var e=d("unaryMinus",{number:function(a){return-a},Complex:function(a){return a.neg()},BigNumber:function(a){return a.neg()},Fraction:function(a){return a.neg()},
Unit:function(a){var b=a.clone();b.value=e(a.value);return b},"Array | Matrix":function(a){return q(a,e,!0)}});e.toTex={1:c.operators.unaryMinus+"\\left(${args[0]}\\right)"};return e}},function(n,h,g){n=g(14);var q=n.object,c=n.string;h.name="det";h.factory=function(a,b,d,e){var f=d(g(31)),k=d(g(30)),m=d(g(60)),w=d(g(43)),h=d(g(58));a=e("det",{any:function(a){return q.clone(a)},"Array | Matrix":function(a){var b;a&&!0===a.isMatrix?b=a.size():Array.isArray(a)?(a=f(a),b=a.size()):b=[];switch(b.length){case 0:return q.clone(a);
case 1:if(1==b[0])return q.clone(a.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+c.format(b)+")");case 2:var d=b[0];if(d==b[1]){a=a.clone().valueOf();if(1==d)d=q.clone(a[0][0]);else if(2==d)d=m(w(a[0][0],a[1][1]),w(a[1][0],a[0][1]));else{var e=a;for(b=0;b<d-1;b++){for(var g=void 0,t=void 0,r=Array(e.length),n=0,g=1;g<e.length;g++)n=k(n,e[g][g]);for(g=0;g<e.length;g++){r[g]=Array(e.length);r[g][g]=h(n);for(t=0;t<g;t++)r[g][t]=0;for(t=g+1;t<e.length;t++)r[g][t]=e[g][t];g+1<e.length&&
(n=m(n,e[g+1][g+1]))}e=w(r,a)}d=0==d%2?h(e[0][0]):e[0][0]}return d}throw new RangeError("Matrix must be square (size: "+c.format(b)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+c.format(b)+")");}}});a.toTex={1:"\\det\\left(${args[0]}\\right)"};return a}},function(n,h,g){var q=g(19);h.name="subtract";h.factory=function(c,a,b,d){c=g(33);var e=b(g(31)),f=b(g(32)),k=b(g(58)),m=b(g(34)),w=b(g(49)),h=b(g(61)),p=b(g(38)),u=b(g(39)),s=b(g(40)),l=d("subtract",{"number, number":function(a,
b){return a-b},"Complex, Complex":function(a,b){return a.sub(b)},"BigNumber, BigNumber":function(a,b){return a.minus(b)},"Fraction, Fraction":function(a,b){return a.sub(b)},"Unit, Unit":function(a,b){if(null==a.value)throw Error("Parameter x contains a unit with undefined value");if(null==b.value)throw Error("Parameter y contains a unit with undefined value");if(!a.equalBase(b))throw Error("Units do not match");var d=a.clone();d.value=l(d.value,b.value);d.fixPrefix=!1;return d},"Matrix, Matrix":function(a,
b){var d=a.size(),c=b.size();if(d.length!==c.length)throw new q(d.length,c.length);switch(a.storage()){case "sparse":switch(b.storage()){case "sparse":d=h(a,b,l);break;default:d=w(b,a,l,!0)}break;default:switch(b.storage()){case "sparse":d=m(a,b,l,!1);break;default:d=u(a,b,l)}}return d},"Array, Array":function(a,b){return l(e(a),e(b)).valueOf()},"Array, Matrix":function(a,b){return l(e(a),b)},"Matrix, Array":function(a,b){return l(a,e(b))},"Matrix, any":function(a,b){var d;switch(a.storage()){case "sparse":d=
p(a,k(b),f);break;default:d=s(a,b,l)}return d},"any, Matrix":function(a,b){var d;switch(b.storage()){case "sparse":d=p(b,a,l,!0);break;default:d=s(b,a,l,!0)}return d},"Array, any":function(a,b){return s(e(a),b,l,!1).valueOf()},"any, Array":function(a,b){return s(e(b),a,l,!0).valueOf()}});l.toTex={2:"\\left(${args[0]}"+c.operators.subtract+"${args[1]}\\right)"};return l}},function(n,h,g){var q=g(19);h.name="algorithm05";h.factory=function(c,a,b,d){var e=b(g(36)),f=c.SparseMatrix;return function(a,
b,c){var g=a._values,h=a._index,u=a._ptr,s=a._size,l=a._datatype;a=b._values;var v=b._index,t=b._ptr,r=b._size,n=b._datatype;if(s.length!==r.length)throw new q(s.length,r.length);if(s[0]!==r[0]||s[1]!==r[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+r+")");var z=s[0],s=s[1],y;b=e;var r=0,E=c;"string"===typeof l&&l===n&&(y=l,b=d.find(e,[y,y]),r=d.convert(0,y),E=d.find(c,[y,y]));c=g&&a?[]:void 0;l=[];n=[];y=new f({values:c,index:l,ptr:n,size:[z,s],datatype:y});
var z=c?[]:void 0,B=c?[]:void 0,C=[],F=[],H,G,K,O;for(G=0;G<s;G++){n[G]=l.length;var P=G+1;K=u[G];for(O=u[G+1];K<O;K++)H=h[K],l.push(H),C[H]=P,z&&(z[H]=g[K]);K=t[G];for(O=t[G+1];K<O;K++)H=v[K],C[H]!==P&&l.push(H),F[H]=P,B&&(B[H]=a[K]);if(c)for(K=n[G];K<l.length;){H=l[K];O=C[H];var N=F[H];if(O===P||N===P)H=E(O===P?z[H]:r,N===P?B[H]:r),b(H,r)?l.splice(K,1):(c.push(H),K++)}}n[s]=l.length;return y}}},function(n,h,g){var q=g(15).size;h.name="cross";h.factory=function(c,a,b,d){function e(a,b){var d=q(a),
c=q(b);if(1!=d.length||1!=c.length||3!=d[0]||3!=c[0])throw new RangeError("Vectors with length 3 expected (Size A = ["+d.join(", ")+"], B = ["+c.join(", ")+"])");return[k(m(a[1],b[2]),m(a[2],b[1])),k(m(a[2],b[0]),m(a[0],b[2])),k(m(a[0],b[1]),m(a[1],b[0]))]}var f=b(g(31)),k=b(g(60)),m=b(g(43));c=d("cross",{"Matrix, Matrix":function(a,b){return f(e(a.toArray(),b.toArray()))},"Matrix, Array":function(a,b){return f(e(a.toArray(),b))},"Array, Matrix":function(a,b){return f(e(a,b.toArray()))},"Array, Array":e});
c.toTex={2:"\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)"};return c}},function(n,h,g){var q=g(15).size;h.name="dot";h.factory=function(c,a,b,d){function e(a,b){var d=q(a),c=q(b),e=d[0];if(1!==d.length||1!==c.length)throw new RangeError("Vector expected");if(d[0]!=c[0])throw new RangeError("Vectors must have equal length ("+d[0]+" != "+c[0]+")");if(0==e)throw new RangeError("Cannot calculate the dot product of empty vectors");for(c=d=0;c<e;c++)d=f(d,k(a[c],b[c]));return d}var f=b(g(30)),
k=b(g(43));c=d("dot",{"Matrix, Matrix":function(a,b){return e(a.toArray(),b.toArray())},"Matrix, Array":function(a,b){return e(a.toArray(),b)},"Array, Matrix":function(a,b){return e(a,b.toArray())},"Array, Array":e});c.toTex={2:"\\left(${args[0]}\\cdot${args[1]}\\right)"};return c}}])})},function(J,Q,S){var n,h,g;(function(q){function c(a){return"[object Function]"===O.call(a)}function a(a){return"[object Array]"===O.call(a)}function b(a,b){if(a){var d;for(d=0;d<a.length&&(!a[d]||!b(a[d],d,a));d+=
1);}}function d(a,b){if(a){var d;for(d=a.length-1;-1<d&&(!a[d]||!b(a[d],d,a));d-=1);}}function e(a,b){return P.call(a,b)}function f(a,b){return e(a,b)&&a[b]}function k(a,b){for(var d in a)if(e(a,d)&&b(a[d],d))break}function m(b,d,f,g){d&&k(d,function(d,k){if(f||!e(b,k))!g||"object"!==typeof d||!d||a(d)||c(d)||d instanceof RegExp?b[k]=d:(b[k]||(b[k]={}),m(b[k],d,f,g))});return b}function w(a,b){return function(){return b.apply(a,arguments)}}function x(a){throw a;}function p(a){if(!a)return a;var d=
q;b(a.split("."),function(a){d=d[a]});return d}function u(a,b,d,c){b=Error(b+"\nhttp://requirejs.org/docs/errors.html#"+a);b.requireType=a;b.requireModules=c;d&&(b.originalError=d);return b}function s(g){function h(a,b,d){var c,e,k,m,g,w,l,x;b=b&&b.split("/");var p=X.map,r=p&&p["*"];if(a){a=a.split("/");e=a.length-1;X.nodeIdCompat&&G.test(a[e])&&(a[e]=a[e].replace(G,""));"."===a[0].charAt(0)&&b&&(e=b.slice(0,b.length-1),a=e.concat(a));e=a;for(k=0;k<e.length;k++)(m=e[k],"."===m)?(e.splice(k,1),k-=
1):".."===m&&0!==k&&(1!==k||".."!==e[2])&&".."!==e[k-1]&&0<k&&(e.splice(k-1,2),k-=2);a=a.join("/")}if(d&&p&&(b||r)){e=a.split("/");k=e.length;a:for(;0<k;k-=1){g=e.slice(0,k).join("/");if(b)for(m=b.length;0<m;m-=1)if(d=f(p,b.slice(0,m).join("/")))if(d=f(d,g)){c=d;w=k;break a}!l&&r&&f(r,g)&&(l=f(r,g),x=k)}!c&&l&&(c=l,w=x);c&&(e.splice(0,w,c),a=e.join("/"))}return(c=f(X.pkgs,a))?c:a}function r(a){N&&b(document.getElementsByTagName("script"),function(b){if(b.getAttribute("data-requiremodule")===a&&b.getAttribute("data-requirecontext")===
R.contextName)return b.parentNode.removeChild(b),!0})}function t(b){var d=f(X.paths,b);if(d&&a(d)&&1<d.length)return d.shift(),R.require.undef(b),R.makeRequire(null,{skipMap:!0})([b]),!0}function s(a){var b,d=a?a.indexOf("!"):-1;-1<d&&(b=a.substring(0,d),a=a.substring(d+1,a.length));return[b,a]}function v(a,b,d,c){var e,k,m=null,g=b?b.name:null,w=a,l=!0,x="";a||(l=!1,a="_@r"+(pa+=1));a=s(a);m=a[0];a=a[1];m&&(m=h(m,g,c),k=f(V,m));a&&(m?x=k&&k.normalize?k.normalize(a,function(a){return h(a,g,c)}):-1===
a.indexOf("!")?h(a,g,c):a:(x=h(a,g,c),a=s(x),m=a[0],x=a[1],d=!0,e=R.nameToUrl(x)));d=!m||k||d?"":"_unnormalized"+(Ba+=1);return{prefix:m,name:x,parentMap:b,unnormalized:!!d,url:e,originalName:w,isDefine:l,id:(m?m+"!"+x:x)+d}}function n(a){var b=a.id,d=f(aa,b);d||(d=aa[b]=new R.Module(a));return d}function z(a,b,d){var c=a.id,k=f(aa,c);if(!e(V,c)||k&&!k.defineEmitComplete)if(k=n(a),k.error&&"error"===b)d(k.error);else k.on(b,d);else"defined"===b&&d(V[c])}function F(a,d){var c=a.requireModules,e=!1;
if(d)d(a);else if(b(c,function(b){if(b=f(aa,b))b.error=a,b.events.error&&(e=!0,b.emit("error",a))}),!e)l.onError(a)}function U(){I.length&&(b(I,function(a){var b=a[0];"string"===typeof b&&(R.defQueueMap[b]=!0);ca.push(a)}),I=[])}function B(a){delete aa[a];delete J[a]}function C(a,d,c){var e=a.map.id;a.error?a.emit("error",a.error):(d[e]=!0,b(a.depMaps,function(b,e){var k=b.id,m=f(aa,k);m&&!a.depMatched[e]&&!c[k]&&(f(d,k)?(a.defineDep(e,V[k]),a.check()):C(m,d,c))}),c[e]=!0)}function D(){var a,d,c=
(a=1E3*X.waitSeconds)&&R.startTime+a<(new Date).getTime(),e=[],f=[],m=!1,g=!0;if(!O){O=!0;k(J,function(a){var b=a.map,k=b.id;if(a.enabled&&(b.isDefine||f.push(a),!a.error))if(!a.inited&&c)t(k)?m=d=!0:(e.push(k),r(k));else if(!a.inited&&a.fetched&&b.isDefine&&(m=!0,!b.prefix))return g=!1});if(c&&e.length)return a=u("timeout","Load timeout for modules: "+e,null,e),a.contextName=R.contextName,F(a);g&&b(f,function(a){C(a,{},{})});c&&!d||!m||!N&&!A||Q||(Q=setTimeout(function(){Q=0;D()},50));O=!1}}function H(a){e(V,
a[0])||n(v(a[0],null,!0)).init(a[1],a[2])}function E(a){a=a.currentTarget||a.srcElement;var b=R.onScriptLoad;a.detachEvent&&!T?a.detachEvent("onreadystatechange",b):a.removeEventListener("load",b,!1);b=R.onScriptError;a.detachEvent&&!T||a.removeEventListener("error",b,!1);return{node:a,id:a&&a.getAttribute("data-requiremodule")}}function P(){var a;for(U();ca.length;){a=ca.shift();if(null===a[0])return F(u("mismatch","Mismatched anonymous define() module: "+a[a.length-1]));H(a)}R.defQueueMap={}}var O,
ba,R,Y,Q,X={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},aa={},J={},S={},ca=[],V={},fa={},Aa={},pa=1,Ba=1;Y={require:function(a){return a.require?a.require:a.require=R.makeRequire(a.map)},exports:function(a){a.usingExports=!0;if(a.map.isDefine)return a.exports?V[a.map.id]=a.exports:a.exports=V[a.map.id]={}},module:function(a){return a.module?a.module:a.module={id:a.map.id,uri:a.map.url,config:function(){return f(X.config,a.map.id)||{}},exports:a.exports||(a.exports={})}}};
ba=function(a){this.events=f(S,a.id)||{};this.map=a;this.shim=f(X.shim,a.id);this.depExports=[];this.depMaps=[];this.depMatched=[];this.pluginMaps={};this.depCount=0};ba.prototype={init:function(a,b,d,c){c=c||{};if(!this.inited){this.factory=b;if(d)this.on("error",d);else this.events.error&&(d=w(this,function(a){this.emit("error",a)}));this.depMaps=a&&a.slice(0);this.errback=d;this.inited=!0;this.ignore=c.ignore;c.enabled||this.enabled?this.enable():this.check()}},defineDep:function(a,b){this.depMatched[a]||
(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(!this.fetched){this.fetched=!0;R.startTime=(new Date).getTime();var a=this.map;if(this.shim)R.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],w(this,function(){return a.prefix?this.callPlugin():this.load()}));else return a.prefix?this.callPlugin():this.load()}},load:function(){var a=this.map.url;fa[a]||(fa[a]=!0,R.load(this.map.id,a))},check:function(){if(this.enabled&&!this.enabling){var a,b,d=this.map.id;
b=this.depExports;var f=this.exports,k=this.factory;if(this.inited)if(this.error)this.emit("error",this.error);else{if(!this.defining){this.defining=!0;if(1>this.depCount&&!this.defined){if(c(k)){if(this.events.error&&this.map.isDefine||l.onError!==x)try{f=R.execCb(d,k,b,f)}catch(m){a=m}else f=R.execCb(d,k,b,f);this.map.isDefine&&void 0===f&&((b=this.module)?f=b.exports:this.usingExports&&(f=this.exports));if(a)return a.requireMap=this.map,a.requireModules=this.map.isDefine?[this.map.id]:null,a.requireType=
this.map.isDefine?"define":"require",F(this.error=a)}else f=k;this.exports=f;if(this.map.isDefine&&!this.ignore&&(V[d]=f,l.onResourceLoad))l.onResourceLoad(R,this.map,this.depMaps);B(d);this.defined=!0}this.defining=!1;this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else e(R.defQueueMap,d)||this.fetch()}},callPlugin:function(){var a=this.map,b=a.id,d=v(a.prefix);this.depMaps.push(d);z(d,"defined",w(this,function(d){var c,m;m=
f(Aa,this.map.id);var g=this.map.name,x=this.map.parentMap?this.map.parentMap.name:null,p=R.makeRequire(a.parentMap,{enableBuildCallback:!0});if(this.map.unnormalized){if(d.normalize&&(g=d.normalize(g,function(a){return h(a,x,!0)})||""),d=v(a.prefix+"!"+g,this.map.parentMap),z(d,"defined",w(this,function(a){this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),m=f(aa,d.id)){this.depMaps.push(d);if(this.events.error)m.on("error",w(this,function(a){this.emit("error",a)}));m.enable()}}else m?
(this.map.url=R.nameToUrl(m),this.load()):(c=w(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),c.error=w(this,function(a){this.inited=!0;this.error=a;a.requireModules=[b];k(aa,function(a){0===a.map.id.indexOf(b+"_unnormalized")&&B(a.map.id)});F(a)}),c.fromText=w(this,function(d,f){var k=a.name,m=v(k),g=Z;f&&(d=f);g&&(Z=!1);n(m);e(X.config,b)&&(X.config[k]=X.config[b]);try{l.exec(d)}catch(w){return F(u("fromtexteval","fromText eval for "+b+" failed: "+w,w,[b]))}g&&(Z=!0);this.depMaps.push(m);
R.completeLoad(k);p([k],c)}),d.load(a.name,p,c,X))}));R.enable(d,this);this.pluginMaps[d.id]=d},enable:function(){J[this.map.id]=this;this.enabling=this.enabled=!0;b(this.depMaps,w(this,function(a,b){var d,c;if("string"===typeof a){a=v(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap);this.depMaps[b]=a;if(d=f(Y,a.id)){this.depExports[b]=d(this);return}this.depCount+=1;z(a,"defined",w(this,function(a){this.undefed||(this.defineDep(b,a),this.check())}));this.errback?z(a,"error",w(this,
this.errback)):this.events.error&&z(a,"error",w(this,function(a){this.emit("error",a)}))}d=a.id;c=aa[d];!e(Y,d)&&c&&!c.enabled&&R.enable(a,this)}));k(this.pluginMaps,w(this,function(a){var b=f(aa,a.id);b&&!b.enabled&&R.enable(a,this)}));this.enabling=!1;this.check()},on:function(a,b){var d=this.events[a];d||(d=this.events[a]=[]);d.push(b)},emit:function(a,d){b(this.events[a],function(a){a(d)});"error"===a&&delete this.events[a]}};R={config:X,contextName:g,registry:aa,defined:V,urlFetched:fa,defQueue:ca,
defQueueMap:{},Module:ba,makeModuleMap:v,nextTick:l.nextTick,onError:F,configure:function(d){d.baseUrl&&"/"!==d.baseUrl.charAt(d.baseUrl.length-1)&&(d.baseUrl+="/");var c=X.shim,e={paths:!0,bundles:!0,config:!0,map:!0};k(d,function(a,b){e[b]?(X[b]||(X[b]={}),m(X[b],a,!0,!0)):X[b]=a});d.bundles&&k(d.bundles,function(a,d){b(a,function(a){a!==d&&(Aa[a]=d)})});d.shim&&(k(d.shim,function(b,d){a(b)&&(b={deps:b});!b.exports&&!b.init||b.exportsFn||(b.exportsFn=R.makeShimExports(b));c[d]=b}),X.shim=c);d.packages&&
b(d.packages,function(a){var b;a="string"===typeof a?{name:a}:a;b=a.name;a.location&&(X.paths[b]=a.location);X.pkgs[b]=a.name+"/"+(a.main||"main").replace(K,"").replace(G,"")});k(aa,function(a,b){a.inited||a.map.unnormalized||(a.map=v(b,null,!0))});(d.deps||d.callback)&&R.require(d.deps||[],d.callback)},makeShimExports:function(a){return function(){var b;a.init&&(b=a.init.apply(q,arguments));return b||a.exports&&p(a.exports)}},makeRequire:function(a,b){function k(d,f,m){var w,h;b.enableBuildCallback&&
f&&c(f)&&(f.__requireJsBuild=!0);if("string"===typeof d){if(c(f))return F(u("requireargs","Invalid require call"),m);if(a&&e(Y,d))return Y[d](aa[a.id]);if(l.get)return l.get(R,d,a,k);w=v(d,a,!1,!0);w=w.id;return e(V,w)?V[w]:F(u("notloaded",'Module name "'+w+'" has not been loaded yet for context: '+g+(a?"":". Use require([])")))}P();R.nextTick(function(){P();h=n(v(null,a));h.skipMap=b.skipMap;h.init(d,f,m,{enabled:!0});D()});return k}b=b||{};m(k,{isBrowser:N,toUrl:function(b){var d,c=b.lastIndexOf("."),
e=b.split("/")[0];-1!==c&&("."!==e&&".."!==e||1<c)&&(d=b.substring(c,b.length),b=b.substring(0,c));return R.nameToUrl(h(b,a&&a.id,!0),d,!0)},defined:function(b){return e(V,v(b,a,!1,!0).id)},specified:function(b){b=v(b,a,!1,!0).id;return e(V,b)||e(aa,b)}});a||(k.undef=function(b){U();var c=v(b,a,!0),e=f(aa,b);e.undefed=!0;r(b);delete V[b];delete fa[c.url];delete S[b];d(ca,function(a,d){a[0]===b&&ca.splice(d,1)});delete R.defQueueMap[b];e&&(e.events.defined&&(S[b]=e.events),B(b))});return k},enable:function(a){f(aa,
a.id)&&n(a).enable()},completeLoad:function(a){var b,d,c=f(X.shim,a)||{},k=c.exports;for(U();ca.length;){d=ca.shift();if(null===d[0]){d[0]=a;if(b)break;b=!0}else d[0]===a&&(b=!0);H(d)}R.defQueueMap={};d=f(aa,a);if(!b&&!e(V,a)&&d&&!d.inited){if(X.enforceDefine&&(!k||!p(k)))return t(a)?void 0:F(u("nodefine","No define call for "+a,null,[a]));H([a,c.deps||[],c.exportsFn])}D()},nameToUrl:function(b,d,c){var e,k,m;(e=f(X.pkgs,b))&&(b=e);if(e=f(Aa,b))return R.nameToUrl(e,d,c);if(l.jsExtRegExp.test(b))e=
b+(d||"");else{e=X.paths;b=b.split("/");for(k=b.length;0<k;k-=1)if(m=b.slice(0,k).join("/"),m=f(e,m)){a(m)&&(m=m[0]);b.splice(0,k,m);break}e=b.join("/");e+=d||(/^data\:|\?/.test(e)||c?"":".js");e=("/"===e.charAt(0)||e.match(/^[\w\+\.\-]+:/)?"":X.baseUrl)+e}return X.urlArgs?e+((-1===e.indexOf("?")?"?":"&")+X.urlArgs):e},load:function(a,b){l.load(R,a,b)},execCb:function(a,b,d,c){return b.apply(c,d)},onScriptLoad:function(a){if("load"===a.type||L.test((a.currentTarget||a.srcElement).readyState))y=null,
a=E(a),R.completeLoad(a.id)},onScriptError:function(a){var b=E(a);if(!t(b.id))return F(u("scripterror","Script error for: "+b.id,a,[b.id]))}};R.require=R.makeRequire();return R}var l,v,t,r,D,z,y,E,B,C,F=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,H=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,G=/\.js$/,K=/^\.\//;v=Object.prototype;var O=v.toString,P=v.hasOwnProperty,N=!("undefined"===typeof window||"undefined"===typeof navigator||!window.document),A=!N&&"undefined"!==typeof importScripts,L=N&&
"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,T="undefined"!==typeof opera&&"[object Opera]"===opera.toString(),Y={},U={},I=[],Z=!1;if("undefined"===typeof g){if("undefined"!==typeof h){if(c(h))return;U=h;h=void 0}"undefined"!==typeof n&&!c(n)&&(U=n,n=void 0);l=h=function(b,d,c,e){var k,m="_";!a(b)&&"string"!==typeof b&&(k=b,a(d)?(b=d,d=c,c=e):b=[]);k&&k.context&&(m=k.context);(e=f(Y,m))||(e=Y[m]=l.s.newContext(m));k&&e.configure(k);return e.require(b,d,c)};l.config=function(a){return l(a)};
l.nextTick="undefined"!==typeof setTimeout?function(a){setTimeout(a,4)}:function(a){a()};n||(n=l);l.version="2.1.20";l.jsExtRegExp=/^\/|:|\?|\.js$/;l.isBrowser=N;v=l.s={contexts:Y,newContext:s};l({});b(["toUrl","undef","defined","specified"],function(a){l[a]=function(){var b=Y._;return b.require[a].apply(b,arguments)}});N&&(t=v.head=document.getElementsByTagName("head")[0],r=document.getElementsByTagName("base")[0])&&(t=v.head=r.parentNode);l.onError=x;l.createNode=function(a){var b=a.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml",
"html:script"):document.createElement("script");b.type=a.scriptType||"text/javascript";b.charset="utf-8";b.async=!0;return b};l.load=function(a,b,d){var c=a&&a.config||{},e;if(N){e=l.createNode(c,b,d);if(c.onNodeCreated)c.onNodeCreated(e,c,b,d);e.setAttribute("data-requirecontext",a.contextName);e.setAttribute("data-requiremodule",b);!e.attachEvent||e.attachEvent.toString&&0>e.attachEvent.toString().indexOf("[native code")||T?(e.addEventListener("load",a.onScriptLoad,!1),e.addEventListener("error",
a.onScriptError,!1)):(Z=!0,e.attachEvent("onreadystatechange",a.onScriptLoad));e.src=d;E=e;r?t.insertBefore(e,r):t.appendChild(e);E=null;return e}if(A)try{importScripts(d),a.completeLoad(b)}catch(f){a.onError(u("importscripts","importScripts failed for "+b+" at "+d,f,[b]))}};N&&!U.skipDataMain&&d(document.getElementsByTagName("script"),function(a){t||(t=a.parentNode);if(D=a.getAttribute("data-main"))return B=D,U.baseUrl||(z=B.split("/"),B=z.pop(),C=z.length?z.join("/")+"/":"./",U.baseUrl=C),B=B.replace(G,
""),l.jsExtRegExp.test(B)&&(B=D),U.deps=U.deps?U.deps.concat(B):[B],!0});g=function(b,e,f){var k,m;"string"!==typeof b&&(f=e,e=b,b=null);a(e)||(f=e,e=null);!e&&c(f)&&(e=[],f.length&&(f.toString().replace(F,"").replace(H,function(a,b){e.push(b)}),e=(1===f.length?["require"]:["require","exports","module"]).concat(e)));Z&&((k=E)||(y&&"interactive"===y.readyState||d(document.getElementsByTagName("script"),function(a){if("interactive"===a.readyState)return y=a}),k=y),k&&(b||(b=k.getAttribute("data-requiremodule")),
m=Y[k.getAttribute("data-requirecontext")]));m?(m.defQueue.push([b,e,f]),m.defQueueMap[b]=!0):I.push([b,e,f])};g.amd={jQuery:!0};l.exec=function(a){return eval(a)};l(U)}})(this)},function(J,Q,S){var n,h,g;(function(q,c){!(h=[Q],n=c,g="function"===typeof n?n.apply(Q,h):n,void 0!==g&&(J.exports=g))})(this,function(h){var c={REVISION:"76"};!(n=c,g="function"===typeof n?n.call(h,S,h,J):n,void 0!==g&&(J.exports=g));void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52));void 0===Math.sign&&(Math.sign=
function(a){return 0>a?-1:0<a?1:+a});void 0===Function.prototype.name&&void 0!==Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}});void 0===Object.assign&&Object.defineProperty(Object,"assign",{writable:!0,configurable:!0,value:function(a){if(void 0===a||null===a)throw new TypeError("Cannot convert first argument to object");for(var b=Object(a),d=1,c=arguments.length;d!==c;++d){var f=arguments[d];if(void 0!==
f&&null!==f)for(var f=Object(f),k=Object.keys(f),m=0,g=k.length;m!==g;++m){var h=k[m],p=Object.getOwnPropertyDescriptor(f,h);void 0!==p&&p.enumerable&&(b[h]=f[h])}}return b}});c.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2};c.CullFaceNone=0;c.CullFaceBack=1;c.CullFaceFront=2;c.CullFaceFrontBack=3;c.FrontFaceDirectionCW=0;c.FrontFaceDirectionCCW=1;c.BasicShadowMap=0;c.PCFShadowMap=1;c.PCFSoftShadowMap=2;c.FrontSide=0;c.BackSide=1;c.DoubleSide=2;c.FlatShading=1;c.SmoothShading=2;c.NoColors=0;c.FaceColors=1;c.VertexColors=
2;c.NoBlending=0;c.NormalBlending=1;c.AdditiveBlending=2;c.SubtractiveBlending=3;c.MultiplyBlending=4;c.CustomBlending=5;c.AddEquation=100;c.SubtractEquation=101;c.ReverseSubtractEquation=102;c.MinEquation=103;c.MaxEquation=104;c.ZeroFactor=200;c.OneFactor=201;c.SrcColorFactor=202;c.OneMinusSrcColorFactor=203;c.SrcAlphaFactor=204;c.OneMinusSrcAlphaFactor=205;c.DstAlphaFactor=206;c.OneMinusDstAlphaFactor=207;c.DstColorFactor=208;c.OneMinusDstColorFactor=209;c.SrcAlphaSaturateFactor=210;c.NeverDepth=
0;c.AlwaysDepth=1;c.LessDepth=2;c.LessEqualDepth=3;c.EqualDepth=4;c.GreaterEqualDepth=5;c.GreaterDepth=6;c.NotEqualDepth=7;c.MultiplyOperation=0;c.MixOperation=1;c.AddOperation=2;c.NoToneMapping=0;c.LinearToneMapping=1;c.ReinhardToneMapping=2;c.Uncharted2ToneMapping=3;c.CineonToneMapping=4;c.UVMapping=300;c.CubeReflectionMapping=301;c.CubeRefractionMapping=302;c.EquirectangularReflectionMapping=303;c.EquirectangularRefractionMapping=304;c.SphericalReflectionMapping=305;c.CubeUVReflectionMapping=306;
c.CubeUVRefractionMapping=307;c.RepeatWrapping=1E3;c.ClampToEdgeWrapping=1001;c.MirroredRepeatWrapping=1002;c.NearestFilter=1003;c.NearestMipMapNearestFilter=1004;c.NearestMipMapLinearFilter=1005;c.LinearFilter=1006;c.LinearMipMapNearestFilter=1007;c.LinearMipMapLinearFilter=1008;c.UnsignedByteType=1009;c.ByteType=1010;c.ShortType=1011;c.UnsignedShortType=1012;c.IntType=1013;c.UnsignedIntType=1014;c.FloatType=1015;c.HalfFloatType=1025;c.UnsignedShort4444Type=1016;c.UnsignedShort5551Type=1017;c.UnsignedShort565Type=
1018;c.AlphaFormat=1019;c.RGBFormat=1020;c.RGBAFormat=1021;c.LuminanceFormat=1022;c.LuminanceAlphaFormat=1023;c.RGBEFormat=c.RGBAFormat;c.DepthFormat=1026;c.RGB_S3TC_DXT1_Format=2001;c.RGBA_S3TC_DXT1_Format=2002;c.RGBA_S3TC_DXT3_Format=2003;c.RGBA_S3TC_DXT5_Format=2004;c.RGB_PVRTC_4BPPV1_Format=2100;c.RGB_PVRTC_2BPPV1_Format=2101;c.RGBA_PVRTC_4BPPV1_Format=2102;c.RGBA_PVRTC_2BPPV1_Format=2103;c.RGB_ETC1_Format=2151;c.LoopOnce=2200;c.LoopRepeat=2201;c.LoopPingPong=2202;c.InterpolateDiscrete=2300;c.InterpolateLinear=
2301;c.InterpolateSmooth=2302;c.ZeroCurvatureEnding=2400;c.ZeroSlopeEnding=2401;c.WrapAroundEnding=2402;c.TrianglesDrawMode=0;c.TriangleStripDrawMode=1;c.TriangleFanDrawMode=2;c.LinearEncoding=3E3;c.sRGBEncoding=3001;c.GammaEncoding=3007;c.RGBEEncoding=3002;c.LogLuvEncoding=3003;c.RGBM7Encoding=3004;c.RGBM16Encoding=3005;c.RGBDEncoding=3006;c.BasicDepthPacking=3200;c.RGBADepthPacking=3201;c.Color=function(a){return 3===arguments.length?this.fromArray(arguments):this.set(a)};c.Color.prototype={constructor:c.Color,
r:1,g:1,b:1,set:function(a){a instanceof c.Color?this.copy(a):"number"===typeof a?this.setHex(a):"string"===typeof a&&this.setStyle(a);return this},setScalar:function(a){this.b=this.g=this.r=a},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},setRGB:function(a,b,d){this.r=a;this.g=b;this.b=d;return this},setHSL:function(){function a(a,d,c){0>c&&(c+=1);1<c&&(c-=1);return c<1/6?a+6*(d-a)*c:.5>c?d:c<2/3?a+6*(d-a)*(2/3-c):a}return function(b,
d,e){b=c.Math.euclideanModulo(b,1);d=c.Math.clamp(d,0,1);e=c.Math.clamp(e,0,1);0===d?this.r=this.g=this.b=e:(d=.5>=e?e*(1+d):e+d-e*d,e=2*e-d,this.r=a(e,d,b+1/3),this.g=a(e,d,b),this.b=a(e,d,b-1/3));return this}}(),setStyle:function(a){function b(b){void 0!==b&&1>parseFloat(b)&&console.warn("THREE.Color: Alpha component of "+a+" will be ignored.")}var d;if(d=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(a)){var e=d[2];switch(d[1]){case "rgb":case "rgba":if(d=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(e))return this.r=
Math.min(255,parseInt(d[1],10))/255,this.g=Math.min(255,parseInt(d[2],10))/255,this.b=Math.min(255,parseInt(d[3],10))/255,b(d[5]),this;if(d=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(e))return this.r=Math.min(100,parseInt(d[1],10))/100,this.g=Math.min(100,parseInt(d[2],10))/100,this.b=Math.min(100,parseInt(d[3],10))/100,b(d[5]),this;break;case "hsl":case "hsla":if(d=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(e)){var e=parseFloat(d[1])/
360,f=parseInt(d[2],10)/100,k=parseInt(d[3],10)/100;b(d[5]);return this.setHSL(e,f,k)}}}else if(d=/^\#([A-Fa-f0-9]+)$/.exec(a)){d=d[1];e=d.length;if(3===e)return this.r=parseInt(d.charAt(0)+d.charAt(0),16)/255,this.g=parseInt(d.charAt(1)+d.charAt(1),16)/255,this.b=parseInt(d.charAt(2)+d.charAt(2),16)/255,this;if(6===e)return this.r=parseInt(d.charAt(0)+d.charAt(1),16)/255,this.g=parseInt(d.charAt(2)+d.charAt(3),16)/255,this.b=parseInt(d.charAt(4)+d.charAt(5),16)/255,this}a&&0<a.length&&(d=c.ColorKeywords[a],
void 0!==d?this.setHex(d):console.warn("THREE.Color: Unknown color "+a));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(a){this.r=a.r;this.g=a.g;this.b=a.b;return this},copyGammaToLinear:function(a,b){void 0===b&&(b=2);this.r=Math.pow(a.r,b);this.g=Math.pow(a.g,b);this.b=Math.pow(a.b,b);return this},copyLinearToGamma:function(a,b){void 0===b&&(b=2);var d=0<b?1/b:1;this.r=Math.pow(a.r,d);this.g=Math.pow(a.g,d);this.b=Math.pow(a.b,d);return this},convertGammaToLinear:function(){var a=
this.r,b=this.g,d=this.b;this.r=a*a;this.g=b*b;this.b=d*d;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(a){a=a||{h:0,s:0,l:0};var b=this.r,d=this.g,c=this.b,f=Math.max(b,d,c),k=Math.min(b,d,c),m,g=(k+f)/2;if(k===f)k=m=0;else{var h=f-k,k=.5>=g?h/(f+k):
h/(2-f-k);switch(f){case b:m=(d-c)/h+(d<c?6:0);break;case d:m=(c-b)/h+2;break;case c:m=(b-d)/h+4}m/=6}a.h=m;a.s=k;a.l=g;return a},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(a,b,d){var c=this.getHSL();c.h+=a;c.s+=b;c.l+=d;this.setHSL(c.h,c.s,c.l);return this},add:function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this},addColors:function(a,b){this.r=a.r+b.r;this.g=a.g+b.g;this.b=a.b+b.b;return this},addScalar:function(a){this.r+=
a;this.g+=a;this.b+=a;return this},multiply:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this},multiplyScalar:function(a){this.r*=a;this.g*=a;this.b*=a;return this},lerp:function(a,b){this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;this.b+=(a.b-this.b)*b;return this},equals:function(a){return a.r===this.r&&a.g===this.g&&a.b===this.b},fromArray:function(a,b){void 0===b&&(b=0);this.r=a[b];this.g=a[b+1];this.b=a[b+2];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=
this.r;a[b+1]=this.g;a[b+2]=this.b;return a}};c.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,
darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,
green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,
lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,
palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,
teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};c.Quaternion=function(a,b,d,c){this._x=a||0;this._y=b||0;this._z=d||0;this._w=void 0!==c?c:1};c.Quaternion.prototype={constructor:c.Quaternion,get x(){return this._x},set x(a){this._x=a;this.onChangeCallback()},get y(){return this._y},set y(a){this._y=a;this.onChangeCallback()},get z(){return this._z},set z(a){this._z=a;this.onChangeCallback()},
get w(){return this._w},set w(a){this._w=a;this.onChangeCallback()},set:function(a,b,d,c){this._x=a;this._y=b;this._z=d;this._w=c;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(a){this._x=a.x;this._y=a.y;this._z=a.z;this._w=a.w;this.onChangeCallback();return this},setFromEuler:function(a,b){if(!1===a instanceof c.Euler)throw Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");
var d=Math.cos(a._x/2),e=Math.cos(a._y/2),f=Math.cos(a._z/2),k=Math.sin(a._x/2),m=Math.sin(a._y/2),g=Math.sin(a._z/2),h=a.order;"XYZ"===h?(this._x=k*e*f+d*m*g,this._y=d*m*f-k*e*g,this._z=d*e*g+k*m*f,this._w=d*e*f-k*m*g):"YXZ"===h?(this._x=k*e*f+d*m*g,this._y=d*m*f-k*e*g,this._z=d*e*g-k*m*f,this._w=d*e*f+k*m*g):"ZXY"===h?(this._x=k*e*f-d*m*g,this._y=d*m*f+k*e*g,this._z=d*e*g+k*m*f,this._w=d*e*f-k*m*g):"ZYX"===h?(this._x=k*e*f-d*m*g,this._y=d*m*f+k*e*g,this._z=d*e*g-k*m*f,this._w=d*e*f+k*m*g):"YZX"===
h?(this._x=k*e*f+d*m*g,this._y=d*m*f+k*e*g,this._z=d*e*g-k*m*f,this._w=d*e*f-k*m*g):"XZY"===h&&(this._x=k*e*f-d*m*g,this._y=d*m*f-k*e*g,this._z=d*e*g+k*m*f,this._w=d*e*f+k*m*g);if(!1!==b)this.onChangeCallback();return this},setFromAxisAngle:function(a,b){var d=b/2,c=Math.sin(d);this._x=a.x*c;this._y=a.y*c;this._z=a.z*c;this._w=Math.cos(d);this.onChangeCallback();return this},setFromRotationMatrix:function(a){var b=a.elements,d=b[0];a=b[4];var c=b[8],f=b[1],k=b[5],m=b[9],g=b[2],h=b[6],b=b[10],p=d+
k+b;0<p?(d=.5/Math.sqrt(p+1),this._w=.25/d,this._x=(h-m)*d,this._y=(c-g)*d,this._z=(f-a)*d):d>k&&d>b?(d=2*Math.sqrt(1+d-k-b),this._w=(h-m)/d,this._x=.25*d,this._y=(a+f)/d,this._z=(c+g)/d):k>b?(d=2*Math.sqrt(1+k-d-b),this._w=(c-g)/d,this._x=(a+f)/d,this._y=.25*d,this._z=(m+h)/d):(d=2*Math.sqrt(1+b-d-k),this._w=(f-a)/d,this._x=(c+g)/d,this._y=(m+h)/d,this._z=.25*d);this.onChangeCallback();return this},setFromUnitVectors:function(){var a,b;return function(d,e){void 0===a&&(a=new c.Vector3);b=d.dot(e)+
1;1E-6>b?(b=0,Math.abs(d.x)>Math.abs(d.z)?a.set(-d.y,d.x,0):a.set(0,-d.z,d.y)):a.crossVectors(d,e);this._x=a.x;this._y=a.y;this._z=a.z;this._w=b;this.normalize();return this}}(),inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this.onChangeCallback();return this},dot:function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},
length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();0===a?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a);this.onChangeCallback();return this},multiply:function(a,b){return void 0!==b?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},
multiplyQuaternions:function(a,b){var d=a._x,c=a._y,f=a._z,k=a._w,m=b._x,g=b._y,h=b._z,p=b._w;this._x=d*p+k*m+c*h-f*g;this._y=c*p+k*g+f*m-d*h;this._z=f*p+k*h+d*g-c*m;this._w=k*p-d*m-c*g-f*h;this.onChangeCallback();return this},slerp:function(a,b){if(0===b)return this;if(1===b)return this.copy(a);var d=this._x,c=this._y,f=this._z,k=this._w,m=k*a._w+d*a._x+c*a._y+f*a._z;0>m?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,m=-m):this.copy(a);if(1<=m)return this._w=k,this._x=d,this._y=c,this._z=
f,this;var g=Math.sqrt(1-m*m);if(.001>Math.abs(g))return this._w=.5*(k+this._w),this._x=.5*(d+this._x),this._y=.5*(c+this._y),this._z=.5*(f+this._z),this;var h=Math.atan2(g,m),m=Math.sin((1-b)*h)/g,g=Math.sin(b*h)/g;this._w=k*m+this._w*g;this._x=d*m+this._x*g;this._y=c*m+this._y*g;this._z=f*m+this._z*g;this.onChangeCallback();return this},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},fromArray:function(a,b){void 0===b&&(b=0);this._x=a[b];this._y=a[b+1];
this._z=a[b+2];this._w=a[b+3];this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._w;return a},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}};Object.assign(c.Quaternion,{slerp:function(a,b,d,c){return d.copy(a).slerp(b,c)},slerpFlat:function(a,b,d,c,f,k,m){var g=d[c+0],h=d[c+1],p=d[c+2];d=d[c+3];c=f[k+0];var u=f[k+1],s=f[k+2];f=f[k+3];if(d!==f||g!==c||h!==u||
p!==s){k=1-m;var l=g*c+h*u+p*s+d*f,v=0<=l?1:-1,t=1-l*l;t>Number.EPSILON&&(t=Math.sqrt(t),l=Math.atan2(t,l*v),k=Math.sin(k*l)/t,m=Math.sin(m*l)/t);v*=m;g=g*k+c*v;h=h*k+u*v;p=p*k+s*v;d=d*k+f*v;k===1-m&&(m=1/Math.sqrt(g*g+h*h+p*p+d*d),g*=m,h*=m,p*=m,d*=m)}a[b]=g;a[b+1]=h;a[b+2]=p;a[b+3]=d}});c.Vector2=function(a,b){this.x=a||0;this.y=b||0};c.Vector2.prototype={constructor:c.Vector2,get width(){return this.x},set width(a){this.x=a},get height(){return this.y},set height(a){this.y=a},set:function(a,b){this.x=
a;this.y=b;return this},setScalar:function(a){this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(a){this.x=a.x;
this.y=a.y;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;return this},addScalar:function(a){this.x+=a;this.y+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
this.subVectors(a,b);this.x-=a.x;this.y-=a.y;return this},subScalar:function(a){this.x-=a;this.y-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},multiply:function(a){this.x*=a.x;this.y*=a.y;return this},multiplyScalar:function(a){isFinite(a)?(this.x*=a,this.y*=a):this.y=this.x=0;return this},divide:function(a){this.x/=a.x;this.y/=a.y;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,
a.y);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);return this},clamp:function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));return this},clampScalar:function(){var a,b;return function(d,e){void 0===a&&(a=new c.Vector2,b=new c.Vector2);a.set(d,d);b.set(e,e);return this.clamp(a,b)}}(),clampLength:function(a,b){var d=this.length();this.multiplyScalar(Math.max(a,Math.min(b,d))/d);return this},floor:function(){this.x=Math.floor(this.x);
this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){this.x=-this.x;this.y=-this.y;return this},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},
length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var a=Math.atan2(this.y,this.x);0>a&&(a+=2*Math.PI);return a},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},setLength:function(a){return this.multiplyScalar(a/this.length())},lerp:function(a,
b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this},lerpVectors:function(a,b,d){this.subVectors(b,a).multiplyScalar(d).add(a);return this},equals:function(a){return a.x===this.x&&a.y===this.y},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;return a},fromAttribute:function(a,b,d){void 0===d&&(d=0);b=b*a.itemSize+d;this.x=a.array[b];this.y=a.array[b+1];return this},rotateAround:function(a,
b){var d=Math.cos(b),c=Math.sin(b),f=this.x-a.x,k=this.y-a.y;this.x=f*d-k*c+a.x;this.y=f*c+k*d+a.y;return this}};c.Vector3=function(a,b,d){this.x=a||0;this.y=b||0;this.z=d||0};c.Vector3.prototype={constructor:c.Vector3,set:function(a,b,d){this.x=a;this.y=b;this.z=d;return this},setScalar:function(a){this.z=this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=
b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),
this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=a.z*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;
return this},subScalar:function(a){this.x-=a;this.y-=a;this.z-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(a,b);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){isFinite(a)?(this.x*=a,this.y*=a,this.z*=a):this.z=this.y=this.x=0;return this},multiplyVectors:function(a,
b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyEuler:function(){var a;return function(b){!1===b instanceof c.Euler&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.");void 0===a&&(a=new c.Quaternion);this.applyQuaternion(a.setFromEuler(b));return this}}(),applyAxisAngle:function(){var a;return function(b,d){void 0===a&&(a=new c.Quaternion);this.applyQuaternion(a.setFromAxisAngle(b,d));return this}}(),applyMatrix3:function(a){var b=
this.x,d=this.y,c=this.z;a=a.elements;this.x=a[0]*b+a[3]*d+a[6]*c;this.y=a[1]*b+a[4]*d+a[7]*c;this.z=a[2]*b+a[5]*d+a[8]*c;return this},applyMatrix4:function(a){var b=this.x,d=this.y,c=this.z;a=a.elements;this.x=a[0]*b+a[4]*d+a[8]*c+a[12];this.y=a[1]*b+a[5]*d+a[9]*c+a[13];this.z=a[2]*b+a[6]*d+a[10]*c+a[14];return this},applyProjection:function(a){var b=this.x,d=this.y,c=this.z;a=a.elements;var f=1/(a[3]*b+a[7]*d+a[11]*c+a[15]);this.x=(a[0]*b+a[4]*d+a[8]*c+a[12])*f;this.y=(a[1]*b+a[5]*d+a[9]*c+a[13])*
f;this.z=(a[2]*b+a[6]*d+a[10]*c+a[14])*f;return this},applyQuaternion:function(a){var b=this.x,d=this.y,c=this.z,f=a.x,k=a.y,m=a.z;a=a.w;var g=a*b+k*c-m*d,h=a*d+m*b-f*c,p=a*c+f*d-k*b,b=-f*b-k*d-m*c;this.x=g*a+b*-f+h*-m-p*-k;this.y=h*a+b*-k+p*-f-g*-m;this.z=p*a+b*-m+g*-k-h*-f;return this},project:function(){var a;return function(b){void 0===a&&(a=new c.Matrix4);a.multiplyMatrices(b.projectionMatrix,a.getInverse(b.matrixWorld));return this.applyProjection(a)}}(),unproject:function(){var a;return function(b){void 0===
a&&(a=new c.Matrix4);a.multiplyMatrices(b.matrixWorld,a.getInverse(b.projectionMatrix));return this.applyProjection(a)}}(),transformDirection:function(a){var b=this.x,d=this.y,c=this.z;a=a.elements;this.x=a[0]*b+a[4]*d+a[8]*c;this.y=a[1]*b+a[5]*d+a[9]*c;this.z=a[2]*b+a[6]*d+a[10]*c;this.normalize();return this},divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,
a.y);this.z=Math.min(this.z,a.z);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);return this},clamp:function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));this.z=Math.max(a.z,Math.min(b.z,this.z));return this},clampScalar:function(){var a,b;return function(d,e){void 0===a&&(a=new c.Vector3,b=new c.Vector3);a.set(d,d,d);b.set(e,e,e);return this.clamp(a,b)}}(),clampLength:function(a,b){var d=
this.length();this.multiplyScalar(Math.max(a,Math.min(b,d))/d);return this},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):
Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},
setLength:function(a){return this.multiplyScalar(a/this.length())},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},lerpVectors:function(a,b,d){this.subVectors(b,a).multiplyScalar(d).add(a);return this},cross:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,b);var d=this.x,c=this.y,f=this.z;this.x=c*a.z-f*a.y;this.y=f*a.x-d*a.z;this.z=
d*a.y-c*a.x;return this},crossVectors:function(a,b){var d=a.x,c=a.y,f=a.z,k=b.x,m=b.y,g=b.z;this.x=c*g-f*m;this.y=f*k-d*g;this.z=d*m-c*k;return this},projectOnVector:function(){var a,b;return function(d){void 0===a&&(a=new c.Vector3);a.copy(d).normalize();b=this.dot(a);return this.copy(a).multiplyScalar(b)}}(),projectOnPlane:function(){var a;return function(b){void 0===a&&(a=new c.Vector3);a.copy(this).projectOnVector(b);return this.sub(a)}}(),reflect:function(){var a;return function(b){void 0===
a&&(a=new c.Vector3);return this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),angleTo:function(a){a=this.dot(a)/Math.sqrt(this.lengthSq()*a.lengthSq());return Math.acos(c.Math.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,d=this.y-a.y;a=this.z-a.z;return b*b+d*d+a*a},setFromSpherical:function(a){var b=Math.sin(a.phi)*a.radius;this.x=b*Math.sin(a.theta);this.y=Math.cos(a.phi)*a.radius;this.z=b*Math.cos(a.theta);
return this},setFromMatrixPosition:function(a){return this.setFromMatrixColumn(a,3)},setFromMatrixScale:function(a){var b=this.setFromMatrixColumn(a,0).length(),d=this.setFromMatrixColumn(a,1).length();a=this.setFromMatrixColumn(a,2).length();this.x=b;this.y=d;this.z=a;return this},setFromMatrixColumn:function(a,b){"number"===typeof a&&(console.warn("THREE.Vector3: setFromMatrixColumn now expects ( matrix, index )."),b=a=b);return this.fromArray(a.elements,4*b)},equals:function(a){return a.x===this.x&&
a.y===this.y&&a.z===this.z},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;return a},fromAttribute:function(a,b,d){void 0===d&&(d=0);b=b*a.itemSize+d;this.x=a.array[b];this.y=a.array[b+1];this.z=a.array[b+2];return this}};c.Vector4=function(a,b,d,c){this.x=a||0;this.y=b||0;this.z=d||0;this.w=void 0!==c?c:1};c.Vector4.prototype={constructor:c.Vector4,set:function(a,
b,d,c){this.x=a;this.y=b;this.z=d;this.w=c;return this},setScalar:function(a){this.w=this.z=this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setW:function(a){this.w=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;
case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},
addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=a.z*b;this.w+=a.w*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},subScalar:function(a){this.x-=
a;this.y-=a;this.z-=a;this.w-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},multiplyScalar:function(a){isFinite(a)?(this.x*=a,this.y*=a,this.z*=a,this.w*=a):this.w=this.z=this.y=this.x=0;return this},applyMatrix4:function(a){var b=this.x,d=this.y,c=this.z,f=this.w;a=a.elements;this.x=a[0]*b+a[4]*d+a[8]*c+a[12]*f;this.y=a[1]*b+a[5]*d+a[9]*c+a[13]*f;this.z=a[2]*b+a[6]*d+a[10]*c+a[14]*f;this.w=a[3]*b+a[7]*d+a[11]*c+a[15]*f;return this},
divideScalar:function(a){return this.multiplyScalar(1/a)},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);1E-4>b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b);return this},setAxisAngleFromRotationMatrix:function(a){var b,d,c;a=a.elements;var f=a[0];c=a[4];var k=a[8],m=a[1],g=a[5],h=a[9];d=a[2];b=a[6];var p=a[10];if(.01>Math.abs(c-m)&&.01>Math.abs(k-d)&&.01>Math.abs(h-b)){if(.1>Math.abs(c+m)&&.1>Math.abs(k+d)&&.1>Math.abs(h+b)&&.1>Math.abs(f+
g+p-3))return this.set(1,0,0,0),this;a=Math.PI;f=(f+1)/2;g=(g+1)/2;p=(p+1)/2;c=(c+m)/4;k=(k+d)/4;h=(h+b)/4;f>g&&f>p?.01>f?(b=0,c=d=.707106781):(b=Math.sqrt(f),d=c/b,c=k/b):g>p?.01>g?(b=.707106781,d=0,c=.707106781):(d=Math.sqrt(g),b=c/d,c=h/d):.01>p?(d=b=.707106781,c=0):(c=Math.sqrt(p),b=k/c,d=h/c);this.set(b,d,c,a);return this}a=Math.sqrt((b-h)*(b-h)+(k-d)*(k-d)+(m-c)*(m-c));.001>Math.abs(a)&&(a=1);this.x=(b-h)/a;this.y=(k-d)/a;this.z=(m-c)/a;this.w=Math.acos((f+g+p-1)/2);return this},min:function(a){this.x=
Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);this.w=Math.min(this.w,a.w);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);this.w=Math.max(this.w,a.w);return this},clamp:function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));this.z=Math.max(a.z,Math.min(b.z,this.z));this.w=Math.max(a.w,Math.min(b.w,this.w));return this},clampScalar:function(){var a,b;return function(d,
e){void 0===a&&(a=new c.Vector4,b=new c.Vector4);a.set(d,d,d,d);b.set(e,e,e,e);return this.clamp(a,b)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this},
roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*
this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){return this.multiplyScalar(a/this.length())},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},lerpVectors:function(a,b,d){this.subVectors(b,a).multiplyScalar(d).add(a);return this},equals:function(a){return a.x===
this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];this.w=a[b+3];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;a[b+3]=this.w;return a},fromAttribute:function(a,b,d){void 0===d&&(d=0);b=b*a.itemSize+d;this.x=a.array[b];this.y=a.array[b+1];this.z=a.array[b+2];this.w=a.array[b+3];return this}};c.Euler=function(a,b,d,e){this._x=a||0;this._y=b||0;this._z=d||
0;this._order=e||c.Euler.DefaultOrder};c.Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");c.Euler.DefaultOrder="XYZ";c.Euler.prototype={constructor:c.Euler,get x(){return this._x},set x(a){this._x=a;this.onChangeCallback()},get y(){return this._y},set y(a){this._y=a;this.onChangeCallback()},get z(){return this._z},set z(a){this._z=a;this.onChangeCallback()},get order(){return this._order},set order(a){this._order=a;this.onChangeCallback()},set:function(a,b,d,c){this._x=a;this._y=b;this._z=
d;this._order=c||this._order;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(a){this._x=a._x;this._y=a._y;this._z=a._z;this._order=a._order;this.onChangeCallback();return this},setFromRotationMatrix:function(a,b,d){var e=c.Math.clamp,f=a.elements;a=f[0];var k=f[4],m=f[8],g=f[1],h=f[5],p=f[9],u=f[2],s=f[6],f=f[10];b=b||this._order;"XYZ"===b?(this._y=Math.asin(e(m,-1,1)),.99999>Math.abs(m)?(this._x=Math.atan2(-p,f),
this._z=Math.atan2(-k,a)):(this._x=Math.atan2(s,h),this._z=0)):"YXZ"===b?(this._x=Math.asin(-e(p,-1,1)),.99999>Math.abs(p)?(this._y=Math.atan2(m,f),this._z=Math.atan2(g,h)):(this._y=Math.atan2(-u,a),this._z=0)):"ZXY"===b?(this._x=Math.asin(e(s,-1,1)),.99999>Math.abs(s)?(this._y=Math.atan2(-u,f),this._z=Math.atan2(-k,h)):(this._y=0,this._z=Math.atan2(g,a))):"ZYX"===b?(this._y=Math.asin(-e(u,-1,1)),.99999>Math.abs(u)?(this._x=Math.atan2(s,f),this._z=Math.atan2(g,a)):(this._x=0,this._z=Math.atan2(-k,
h))):"YZX"===b?(this._z=Math.asin(e(g,-1,1)),.99999>Math.abs(g)?(this._x=Math.atan2(-p,h),this._y=Math.atan2(-u,a)):(this._x=0,this._y=Math.atan2(m,f))):"XZY"===b?(this._z=Math.asin(-e(k,-1,1)),.99999>Math.abs(k)?(this._x=Math.atan2(s,h),this._y=Math.atan2(m,a)):(this._x=Math.atan2(-p,f),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+b);this._order=b;if(!1!==d)this.onChangeCallback();return this},setFromQuaternion:function(){var a;return function(b,d,e){void 0===
a&&(a=new c.Matrix4);a.makeRotationFromQuaternion(b);this.setFromRotationMatrix(a,d,e);return this}}(),setFromVector3:function(a,b){return this.set(a.x,a.y,a.z,b||this._order)},reorder:function(){var a=new c.Quaternion;return function(b){a.setFromEuler(this);this.setFromQuaternion(a,b)}}(),equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];void 0!==a[3]&&(this._order=a[3]);this.onChangeCallback();
return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._order;return a},toVector3:function(a){return a?a.set(this._x,this._y,this._z):new c.Vector3(this._x,this._y,this._z)},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}};c.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]);0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")};
c.Matrix3.prototype={constructor:c.Matrix3,set:function(a,b,d,c,f,k,m,g,h){var p=this.elements;p[0]=a;p[1]=c;p[2]=m;p[3]=b;p[4]=f;p[5]=g;p[6]=d;p[7]=k;p[8]=h;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(a){a=a.elements;this.set(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]);return this},setFromMatrix4:function(a){a=a.elements;this.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]);return this},
applyToVector3Array:function(){var a;return function(b,d,e){void 0===a&&(a=new c.Vector3);void 0===d&&(d=0);void 0===e&&(e=b.length);for(var f=0;f<e;f+=3,d+=3)a.fromArray(b,d),a.applyMatrix3(this),a.toArray(b,d);return b}}(),applyToBuffer:function(){var a;return function(b,d,e){void 0===a&&(a=new c.Vector3);void 0===d&&(d=0);void 0===e&&(e=b.length/b.itemSize);for(var f=0;f<e;f++,d++)a.x=b.getX(d),a.y=b.getY(d),a.z=b.getZ(d),a.applyMatrix3(this),b.setXYZ(a.x,a.y,a.z);return b}}(),multiplyScalar:function(a){var b=
this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},determinant:function(){var a=this.elements,b=a[0],d=a[1],c=a[2],f=a[3],k=a[4],m=a[5],g=a[6],h=a[7],a=a[8];return b*k*a-b*m*h-d*f*a+d*m*g+c*f*h-c*k*g},getInverse:function(a,b){a instanceof c.Matrix4&&console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var d=a.elements,e=this.elements,f=d[0],k=d[1],m=d[2],g=d[3],h=d[4],p=d[5],u=d[6],s=d[7],d=d[8],l=d*h-p*s,v=p*u-d*g,t=s*g-h*u,
r=f*l+k*v+m*t;if(0===r){if(b)throw Error("THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0");console.warn("THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0");return this.identity()}e[0]=l;e[1]=m*s-d*k;e[2]=p*k-m*h;e[3]=v;e[4]=d*f-m*u;e[5]=m*g-p*f;e[6]=t;e[7]=k*u-s*f;e[8]=h*f-k*g;return this.multiplyScalar(1/r)},transpose:function(){var a,b=this.elements;a=b[1];b[1]=b[3];b[3]=a;a=b[2];b[2]=b[6];b[6]=a;a=b[5];b[5]=b[7];b[7]=a;return this},flattenToArrayOffset:function(a,
b){console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead.");return this.toArray(a,b)},getNormalMatrix:function(a){return this.setFromMatrix4(a).getInverse(this).transpose()},transposeIntoArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this},fromArray:function(a){this.elements.set(a);return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);var d=this.elements;
a[b]=d[0];a[b+1]=d[1];a[b+2]=d[2];a[b+3]=d[3];a[b+4]=d[4];a[b+5]=d[5];a[b+6]=d[6];a[b+7]=d[7];a[b+8]=d[8];return a}};c.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")};c.Matrix4.prototype={constructor:c.Matrix4,set:function(a,b,d,c,f,k,m,g,h,p,u,s,l,v,t,r){var n=this.elements;n[0]=a;n[4]=b;n[8]=d;n[12]=c;n[1]=f;n[5]=k;n[9]=m;n[13]=g;n[2]=h;n[6]=p;
n[10]=u;n[14]=s;n[3]=l;n[7]=v;n[11]=t;n[15]=r;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},clone:function(){return(new c.Matrix4).fromArray(this.elements)},copy:function(a){this.elements.set(a.elements);return this},copyPosition:function(a){var b=this.elements;a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this},extractBasis:function(a,b,d){a.setFromMatrixColumn(this,0);b.setFromMatrixColumn(this,1);d.setFromMatrixColumn(this,2);return this},makeBasis:function(a,
b,d){this.set(a.x,b.x,d.x,0,a.y,b.y,d.y,0,a.z,b.z,d.z,0,0,0,0,1);return this},extractRotation:function(){var a;return function(b){void 0===a&&(a=new c.Vector3);var d=this.elements,e=b.elements,f=1/a.setFromMatrixColumn(b,0).length(),k=1/a.setFromMatrixColumn(b,1).length();b=1/a.setFromMatrixColumn(b,2).length();d[0]=e[0]*f;d[1]=e[1]*f;d[2]=e[2]*f;d[4]=e[4]*k;d[5]=e[5]*k;d[6]=e[6]*k;d[8]=e[8]*b;d[9]=e[9]*b;d[10]=e[10]*b;return this}}(),makeRotationFromEuler:function(a){!1===a instanceof c.Euler&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");
var b=this.elements,d=a.x,e=a.y,f=a.z,k=Math.cos(d),d=Math.sin(d),m=Math.cos(e),e=Math.sin(e),g=Math.cos(f),f=Math.sin(f);if("XYZ"===a.order){a=k*g;var h=k*f,p=d*g,u=d*f;b[0]=m*g;b[4]=-m*f;b[8]=e;b[1]=h+p*e;b[5]=a-u*e;b[9]=-d*m;b[2]=u-a*e;b[6]=p+h*e;b[10]=k*m}else"YXZ"===a.order?(a=m*g,h=m*f,p=e*g,u=e*f,b[0]=a+u*d,b[4]=p*d-h,b[8]=k*e,b[1]=k*f,b[5]=k*g,b[9]=-d,b[2]=h*d-p,b[6]=u+a*d,b[10]=k*m):"ZXY"===a.order?(a=m*g,h=m*f,p=e*g,u=e*f,b[0]=a-u*d,b[4]=-k*f,b[8]=p+h*d,b[1]=h+p*d,b[5]=k*g,b[9]=u-a*d,b[2]=
-k*e,b[6]=d,b[10]=k*m):"ZYX"===a.order?(a=k*g,h=k*f,p=d*g,u=d*f,b[0]=m*g,b[4]=p*e-h,b[8]=a*e+u,b[1]=m*f,b[5]=u*e+a,b[9]=h*e-p,b[2]=-e,b[6]=d*m,b[10]=k*m):"YZX"===a.order?(a=k*m,h=k*e,p=d*m,u=d*e,b[0]=m*g,b[4]=u-a*f,b[8]=p*f+h,b[1]=f,b[5]=k*g,b[9]=-d*g,b[2]=-e*g,b[6]=h*f+p,b[10]=a-u*f):"XZY"===a.order&&(a=k*m,h=k*e,p=d*m,u=d*e,b[0]=m*g,b[4]=-f,b[8]=e*g,b[1]=a*f+u,b[5]=k*g,b[9]=h*f-p,b[2]=p*f-h,b[6]=d*g,b[10]=u*f+a);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},makeRotationFromQuaternion:function(a){var b=
this.elements,d=a.x,c=a.y,f=a.z,k=a.w,m=d+d,g=c+c,h=f+f;a=d*m;var p=d*g,d=d*h,u=c*g,c=c*h,f=f*h,m=k*m,g=k*g,k=k*h;b[0]=1-(u+f);b[4]=p-k;b[8]=d+g;b[1]=p+k;b[5]=1-(a+f);b[9]=c-m;b[2]=d-g;b[6]=c+m;b[10]=1-(a+u);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},lookAt:function(){var a,b,d;return function(e,f,k){void 0===a&&(a=new c.Vector3);void 0===b&&(b=new c.Vector3);void 0===d&&(d=new c.Vector3);var m=this.elements;d.subVectors(e,f).normalize();0===d.lengthSq()&&(d.z=1);a.crossVectors(k,
d).normalize();0===a.lengthSq()&&(d.x+=1E-4,a.crossVectors(k,d).normalize());b.crossVectors(d,a);m[0]=a.x;m[4]=b.x;m[8]=d.x;m[1]=a.y;m[5]=b.y;m[9]=d.y;m[2]=a.z;m[6]=b.z;m[10]=d.z;return this}}(),multiply:function(a,b){return void 0!==b?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},premultiply:function(a){return this.multiplyMatrices(a,this)},multiplyMatrices:function(a,b){var d=
a.elements,c=b.elements,f=this.elements,k=d[0],m=d[4],g=d[8],h=d[12],p=d[1],u=d[5],s=d[9],l=d[13],v=d[2],t=d[6],r=d[10],n=d[14],q=d[3],y=d[7],E=d[11],d=d[15],B=c[0],C=c[4],F=c[8],H=c[12],G=c[1],K=c[5],O=c[9],P=c[13],N=c[2],A=c[6],L=c[10],T=c[14],Y=c[3],U=c[7],I=c[11],c=c[15];f[0]=k*B+m*G+g*N+h*Y;f[4]=k*C+m*K+g*A+h*U;f[8]=k*F+m*O+g*L+h*I;f[12]=k*H+m*P+g*T+h*c;f[1]=p*B+u*G+s*N+l*Y;f[5]=p*C+u*K+s*A+l*U;f[9]=p*F+u*O+s*L+l*I;f[13]=p*H+u*P+s*T+l*c;f[2]=v*B+t*G+r*N+n*Y;f[6]=v*C+t*K+r*A+n*U;f[10]=v*F+t*O+
r*L+n*I;f[14]=v*H+t*P+r*T+n*c;f[3]=q*B+y*G+E*N+d*Y;f[7]=q*C+y*K+E*A+d*U;f[11]=q*F+y*O+E*L+d*I;f[15]=q*H+y*P+E*T+d*c;return this},multiplyToArray:function(a,b,d){var c=this.elements;this.multiplyMatrices(a,b);d[0]=c[0];d[1]=c[1];d[2]=c[2];d[3]=c[3];d[4]=c[4];d[5]=c[5];d[6]=c[6];d[7]=c[7];d[8]=c[8];d[9]=c[9];d[10]=c[10];d[11]=c[11];d[12]=c[12];d[13]=c[13];d[14]=c[14];d[15]=c[15];return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=
a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},applyToVector3Array:function(){var a;return function(b,d,e){void 0===a&&(a=new c.Vector3);void 0===d&&(d=0);void 0===e&&(e=b.length);for(var f=0;f<e;f+=3,d+=3)a.fromArray(b,d),a.applyMatrix4(this),a.toArray(b,d);return b}}(),applyToBuffer:function(){var a;return function(b,d,e){void 0===a&&(a=new c.Vector3);void 0===d&&(d=0);void 0===e&&(e=b.length/b.itemSize);for(var f=0;f<e;f++,d++)a.x=b.getX(d),a.y=b.getY(d),a.z=
b.getZ(d),a.applyMatrix4(this),b.setXYZ(a.x,a.y,a.z);return b}}(),determinant:function(){var a=this.elements,b=a[0],d=a[4],c=a[8],f=a[12],k=a[1],m=a[5],g=a[9],h=a[13],p=a[2],u=a[6],s=a[10],l=a[14];return a[3]*(+f*g*u-c*h*u-f*m*s+d*h*s+c*m*l-d*g*l)+a[7]*(+b*g*l-b*h*s+f*k*s-c*k*l+c*h*p-f*g*p)+a[11]*(+b*h*u-b*m*l-f*k*u+d*k*l+f*m*p-d*h*p)+a[15]*(-c*m*p-b*g*u+b*m*s+c*k*u-d*k*s+d*g*p)},transpose:function(){var a=this.elements,b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];
a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},flattenToArrayOffset:function(a,b){console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead.");return this.toArray(a,b)},getPosition:function(){var a;return function(){void 0===a&&(a=new c.Vector3);console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");return a.setFromMatrixColumn(this,3)}}(),setPosition:function(a){var b=
this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var d=this.elements,c=a.elements,f=c[0],k=c[1],m=c[2],g=c[3],h=c[4],p=c[5],u=c[6],s=c[7],l=c[8],v=c[9],t=c[10],r=c[11],n=c[12],q=c[13],y=c[14],c=c[15],E=v*y*s-q*t*s+q*u*r-p*y*r-v*u*c+p*t*c,B=n*t*s-l*y*s-n*u*r+h*y*r+l*u*c-h*t*c,C=l*q*s-n*v*s+n*p*r-h*q*r-l*p*c+h*v*c,F=n*v*u-l*q*u-n*p*t+h*q*t+l*p*y-h*v*y,H=f*E+k*B+m*C+g*F;if(0===H){if(b)throw Error("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");console.warn("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");
return this.identity()}d[0]=E;d[1]=q*t*g-v*y*g-q*m*r+k*y*r+v*m*c-k*t*c;d[2]=p*y*g-q*u*g+q*m*s-k*y*s-p*m*c+k*u*c;d[3]=v*u*g-p*t*g-v*m*s+k*t*s+p*m*r-k*u*r;d[4]=B;d[5]=l*y*g-n*t*g+n*m*r-f*y*r-l*m*c+f*t*c;d[6]=n*u*g-h*y*g-n*m*s+f*y*s+h*m*c-f*u*c;d[7]=h*t*g-l*u*g+l*m*s-f*t*s-h*m*r+f*u*r;d[8]=C;d[9]=n*v*g-l*q*g-n*k*r+f*q*r+l*k*c-f*v*c;d[10]=h*q*g-n*p*g+n*k*s-f*q*s-h*k*c+f*p*c;d[11]=l*p*g-h*v*g-l*k*s+f*v*s+h*k*r-f*p*r;d[12]=F;d[13]=l*q*m-n*v*m+n*k*t-f*q*t-l*k*y+f*v*y;d[14]=n*p*m-h*q*m-n*k*u+f*q*u+h*k*y-
f*p*y;d[15]=h*v*m-l*p*m+l*k*u-f*v*u-h*k*t+f*p*t;return this.multiplyScalar(1/H)},scale:function(a){var b=this.elements,c=a.x,e=a.y;a=a.z;b[0]*=c;b[4]*=e;b[8]*=a;b[1]*=c;b[5]*=e;b[9]*=a;b[2]*=c;b[6]*=e;b[10]*=a;b[3]*=c;b[7]*=e;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))},makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},
makeRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=Math.cos(b),e=Math.sin(b),f=1-c,k=a.x,m=a.y,g=a.z,h=f*k,p=f*m;this.set(h*k+c,h*m-e*g,h*g+e*m,0,h*m+e*g,p*m+c,p*g-e*k,0,h*g-
e*m,p*g+e*k,f*g*g+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},compose:function(a,b,c){this.makeRotationFromQuaternion(b);this.scale(c);this.setPosition(a);return this},decompose:function(){var a,b;return function(d,e,f){void 0===a&&(a=new c.Vector3);void 0===b&&(b=new c.Matrix4);var k=this.elements,m=a.set(k[0],k[1],k[2]).length(),g=a.set(k[4],k[5],k[6]).length(),h=a.set(k[8],k[9],k[10]).length();0>this.determinant()&&(m=-m);d.x=k[12];
d.y=k[13];d.z=k[14];b.elements.set(this.elements);d=1/m;var k=1/g,p=1/h;b.elements[0]*=d;b.elements[1]*=d;b.elements[2]*=d;b.elements[4]*=k;b.elements[5]*=k;b.elements[6]*=k;b.elements[8]*=p;b.elements[9]*=p;b.elements[10]*=p;e.setFromRotationMatrix(b);f.x=m;f.y=g;f.z=h;return this}}(),makeFrustum:function(a,b,c,e,f,k){var m=this.elements;m[0]=2*f/(b-a);m[4]=0;m[8]=(b+a)/(b-a);m[12]=0;m[1]=0;m[5]=2*f/(e-c);m[9]=(e+c)/(e-c);m[13]=0;m[2]=0;m[6]=0;m[10]=-(k+f)/(k-f);m[14]=-2*k*f/(k-f);m[3]=0;m[7]=0;
m[11]=-1;m[15]=0;return this},makePerspective:function(a,b,d,e){a=d*Math.tan(c.Math.DEG2RAD*a*.5);var f=-a;return this.makeFrustum(f*b,a*b,f,a,d,e)},makeOrthographic:function(a,b,c,e,f,k){var m=this.elements,g=1/(b-a),h=1/(c-e),p=1/(k-f);m[0]=2*g;m[4]=0;m[8]=0;m[12]=-((b+a)*g);m[1]=0;m[5]=2*h;m[9]=0;m[13]=-((c+e)*h);m[2]=0;m[6]=0;m[10]=-2*p;m[14]=-((k+f)*p);m[3]=0;m[7]=0;m[11]=0;m[15]=1;return this},equals:function(a){var b=this.elements;a=a.elements;for(var c=0;16>c;c++)if(b[c]!==a[c])return!1;return!0},
fromArray:function(a){this.elements.set(a);return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a}};c.Ray=function(a,b){this.origin=void 0!==a?a:new c.Vector3;this.direction=void 0!==b?b:new c.Vector3};c.Ray.prototype={constructor:c.Ray,set:function(a,b){this.origin.copy(a);
this.direction.copy(b);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},at:function(a,b){return(b||new c.Vector3).copy(this.direction).multiplyScalar(a).add(this.origin)},lookAt:function(a){this.direction.copy(a).sub(this.origin).normalize()},recast:function(){var a=new c.Vector3;return function(b){this.origin.copy(this.at(b,a));return this}}(),closestPointToPoint:function(a,b){var d=b||
new c.Vector3;d.subVectors(a,this.origin);var e=d.dot(this.direction);return 0>e?d.copy(this.origin):d.copy(this.direction).multiplyScalar(e).add(this.origin)},distanceToPoint:function(a){return Math.sqrt(this.distanceSqToPoint(a))},distanceSqToPoint:function(){var a=new c.Vector3;return function(b){var c=a.subVectors(b,this.origin).dot(this.direction);if(0>c)return this.origin.distanceToSquared(b);a.copy(this.direction).multiplyScalar(c).add(this.origin);return a.distanceToSquared(b)}}(),distanceSqToSegment:function(){var a=
new c.Vector3,b=new c.Vector3,d=new c.Vector3;return function(c,f,k,m){a.copy(c).add(f).multiplyScalar(.5);b.copy(f).sub(c).normalize();d.copy(this.origin).sub(a);var g=.5*c.distanceTo(f),h=-this.direction.dot(b),p=d.dot(this.direction),n=-d.dot(b),s=d.lengthSq(),l=Math.abs(1-h*h),v;0<l?(c=h*n-p,f=h*p-n,v=g*l,0<=c?f>=-v?f<=v?(g=1/l,c*=g,f*=g,h=c*(c+h*f+2*p)+f*(h*c+f+2*n)+s):(f=g,c=Math.max(0,-(h*f+p)),h=-c*c+f*(f+2*n)+s):(f=-g,c=Math.max(0,-(h*f+p)),h=-c*c+f*(f+2*n)+s):f<=-v?(c=Math.max(0,-(-h*g+
p)),f=0<c?-g:Math.min(Math.max(-g,-n),g),h=-c*c+f*(f+2*n)+s):f<=v?(c=0,f=Math.min(Math.max(-g,-n),g),h=f*(f+2*n)+s):(c=Math.max(0,-(h*g+p)),f=0<c?g:Math.min(Math.max(-g,-n),g),h=-c*c+f*(f+2*n)+s)):(f=0<h?-g:g,c=Math.max(0,-(h*f+p)),h=-c*c+f*(f+2*n)+s);k&&k.copy(this.direction).multiplyScalar(c).add(this.origin);m&&m.copy(b).multiplyScalar(f).add(a);return h}}(),intersectSphere:function(){var a=new c.Vector3;return function(b,c){a.subVectors(b.center,this.origin);var e=a.dot(this.direction),f=a.dot(a)-
e*e,k=b.radius*b.radius;if(f>k)return null;k=Math.sqrt(k-f);f=e-k;e+=k;return 0>f&&0>e?null:0>f?this.at(e,c):this.at(f,c)}}(),intersectsSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},distanceToPlane:function(a){var b=a.normal.dot(this.direction);if(0===b)return 0===a.distanceToPoint(this.origin)?0:null;a=-(this.origin.dot(a.normal)+a.constant)/b;return 0<=a?a:null},intersectPlane:function(a,b){var c=this.distanceToPlane(a);return null===c?null:this.at(c,b)},intersectsPlane:function(a){var b=
a.distanceToPoint(this.origin);return 0===b||0>a.normal.dot(this.direction)*b?!0:!1},intersectBox:function(a,b){var c,e,f,k,g;e=1/this.direction.x;k=1/this.direction.y;g=1/this.direction.z;var h=this.origin;0<=e?(c=(a.min.x-h.x)*e,e*=a.max.x-h.x):(c=(a.max.x-h.x)*e,e*=a.min.x-h.x);0<=k?(f=(a.min.y-h.y)*k,k*=a.max.y-h.y):(f=(a.max.y-h.y)*k,k*=a.min.y-h.y);if(c>k||f>e)return null;if(f>c||c!==c)c=f;if(k<e||e!==e)e=k;0<=g?(f=(a.min.z-h.z)*g,g*=a.max.z-h.z):(f=(a.max.z-h.z)*g,g*=a.min.z-h.z);if(c>g||f>
e)return null;if(f>c||c!==c)c=f;if(g<e||e!==e)e=g;return 0>e?null:this.at(0<=c?c:e,b)},intersectsBox:function(){var a=new c.Vector3;return function(b){return null!==this.intersectBox(b,a)}}(),intersectTriangle:function(){var a=new c.Vector3,b=new c.Vector3,d=new c.Vector3,e=new c.Vector3;return function(c,k,g,h,n){b.subVectors(k,c);d.subVectors(g,c);e.crossVectors(b,d);k=this.direction.dot(e);if(0<k){if(h)return null;h=1}else if(0>k)h=-1,k=-k;else return null;a.subVectors(this.origin,c);c=h*this.direction.dot(d.crossVectors(a,
d));if(0>c)return null;g=h*this.direction.dot(b.cross(a));if(0>g||c+g>k)return null;c=-h*a.dot(e);return 0>c?null:this.at(c/k,n)}}(),applyMatrix4:function(a){this.direction.add(this.origin).applyMatrix4(a);this.origin.applyMatrix4(a);this.direction.sub(this.origin);this.direction.normalize();return this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)}};c.Box2=function(a,b){this.min=void 0!==a?a:new c.Vector2(Infinity,Infinity);this.max=void 0!==b?b:new c.Vector2(-Infinity,
-Infinity)};c.Box2.prototype={constructor:c.Box2,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new c.Vector2;return function(b,c){var e=a.copy(c).multiplyScalar(.5);this.min.copy(b).sub(e);this.max.copy(b).add(e);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);
return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(a){return(a||new c.Vector2).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(a){return(a||new c.Vector2).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);
this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y?!0:!1},getParameter:function(a,b){return(b||new c.Vector2).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y?
!1:!0},clampPoint:function(a,b){return(b||new c.Vector2).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new c.Vector2;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}};
c.Box3=function(a,b){this.min=void 0!==a?a:new c.Vector3(Infinity,Infinity,Infinity);this.max=void 0!==b?b:new c.Vector3(-Infinity,-Infinity,-Infinity)};c.Box3.prototype={constructor:c.Box3,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromArray:function(a){for(var b=Infinity,c=Infinity,e=Infinity,f=-Infinity,k=-Infinity,g=-Infinity,h=0,n=a.length;h<n;h+=3){var p=a[h],u=a[h+1],s=a[h+2];p<b&&(b=p);u<c&&(c=u);s<e&&(e=s);p>f&&(f=p);u>k&&(k=u);s>g&&(g=s)}this.min.set(b,c,e);this.max.set(f,
k,g)},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new c.Vector3;return function(b,c){var e=a.copy(c).multiplyScalar(.5);this.min.copy(b).sub(e);this.max.copy(b).add(e);return this}}(),setFromObject:function(){var a=new c.Vector3;return function(b){var d=this;b.updateMatrixWorld(!0);this.makeEmpty();b.traverse(function(b){var f=b.geometry;if(void 0!==f)if(f instanceof c.Geometry)for(var k=f.vertices,
f=0,g=k.length;f<g;f++)a.copy(k[f]),a.applyMatrix4(b.matrixWorld),d.expandByPoint(a);else if(f instanceof c.BufferGeometry&&void 0!==f.attributes.position)for(k=f.attributes.position.array,f=0,g=k.length;f<g;f+=3)a.fromArray(k,f),a.applyMatrix4(b.matrixWorld),d.expandByPoint(a)});return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=
this.max.y=this.max.z=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(a){return(a||new c.Vector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(a){return(a||new c.Vector3).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);
return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z?!0:!1},getParameter:function(a,b){return(b||new c.Vector3).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(a){return a.max.x<
this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},intersectsSphere:function(){var a;return function(b){void 0===a&&(a=new c.Vector3);this.clampPoint(b.center,a);return a.distanceToSquared(b.center)<=b.radius*b.radius}}(),intersectsPlane:function(a){var b,c;0<a.normal.x?(b=a.normal.x*this.min.x,c=a.normal.x*this.max.x):(b=a.normal.x*this.max.x,c=a.normal.x*this.min.x);0<a.normal.y?(b+=a.normal.y*this.min.y,c+=a.normal.y*this.max.y):
(b+=a.normal.y*this.max.y,c+=a.normal.y*this.min.y);0<a.normal.z?(b+=a.normal.z*this.min.z,c+=a.normal.z*this.max.z):(b+=a.normal.z*this.max.z,c+=a.normal.z*this.min.z);return b<=a.constant&&c>=a.constant},clampPoint:function(a,b){return(b||new c.Vector3).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new c.Vector3;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),getBoundingSphere:function(){var a=new c.Vector3;return function(b){b=b||new c.Sphere;
b.center=this.center();b.radius=.5*this.size(a).length();return b}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);this.isEmpty()&&this.makeEmpty();return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},applyMatrix4:function(){var a=[new c.Vector3,new c.Vector3,new c.Vector3,new c.Vector3,new c.Vector3,new c.Vector3,new c.Vector3,new c.Vector3];return function(b){if(this.isEmpty())return this;a[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(b);
a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b);a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b);a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b);a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(b);a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b);a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(b);a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b);this.setFromPoints(a);return this}}(),translate:function(a){this.min.add(a);this.max.add(a);
return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}};c.Sphere=function(a,b){this.center=void 0!==a?a:new c.Vector3;this.radius=void 0!==b?b:0};c.Sphere.prototype={constructor:c.Sphere,set:function(a,b){this.center.copy(a);this.radius=b;return this},setFromPoints:function(){var a=new c.Box3;return function(b,c){var e=this.center;void 0!==c?e.copy(c):a.setFromPoints(b).center(e);for(var f=0,k=0,g=b.length;k<g;k++)f=Math.max(f,e.distanceToSquared(b[k]));this.radius=
Math.sqrt(f);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(a){return a.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},intersectsBox:function(a){return a.intersectsSphere(this)},
intersectsPlane:function(a){return Math.abs(this.center.dot(a.normal)-a.constant)<=this.radius},clampPoint:function(a,b){var d=this.center.distanceToSquared(a),e=b||new c.Vector3;e.copy(a);d>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center));return e},getBoundingBox:function(a){a=a||new c.Box3;a.set(this.center,this.center);a.expandByScalar(this.radius);return a},applyMatrix4:function(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScaleOnAxis();
return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius}};c.Plane=function(a,b){this.normal=void 0!==a?a:new c.Vector3(1,0,0);this.constant=void 0!==b?b:0};c.Plane.prototype={constructor:c.Plane,set:function(a,b){this.normal.copy(a);this.constant=b;return this},setComponents:function(a,b,c,e){this.normal.set(a,b,c);this.constant=e;return this},setFromNormalAndCoplanarPoint:function(a,b){this.normal.copy(a);this.constant=
-b.dot(this.normal);return this},setFromCoplanarPoints:function(){var a=new c.Vector3,b=new c.Vector3;return function(c,e,f){e=a.subVectors(f,e).cross(b.subVectors(c,e)).normalize();this.setFromNormalAndCoplanarPoint(e,c);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.normal.copy(a.normal);this.constant=a.constant;return this},normalize:function(){var a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this},negate:function(){this.constant*=
-1;this.normal.negate();return this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){return this.orthoPoint(a,b).sub(a).negate()},orthoPoint:function(a,b){var d=this.distanceToPoint(a);return(b||new c.Vector3).copy(this.normal).multiplyScalar(d)},intersectLine:function(){var a=new c.Vector3;return function(b,d){var e=d||new c.Vector3,f=b.delta(a),k=this.normal.dot(f);if(0===
k){if(0===this.distanceToPoint(b.start))return e.copy(b.start)}else return k=-(b.start.dot(this.normal)+this.constant)/k,0>k||1<k?void 0:e.copy(f).multiplyScalar(k).add(b.start)}}(),intersectsLine:function(a){var b=this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b},intersectsBox:function(a){return a.intersectsPlane(this)},intersectsSphere:function(a){return a.intersectsPlane(this)},coplanarPoint:function(a){return(a||new c.Vector3).copy(this.normal).multiplyScalar(-this.constant)},
applyMatrix4:function(){var a=new c.Vector3,b=new c.Matrix3;return function(c,e){var f=this.coplanarPoint(a).applyMatrix4(c),k=e||b.getNormalMatrix(c),k=this.normal.applyMatrix3(k).normalize();this.constant=-f.dot(k);return this}}(),translate:function(a){this.constant-=a.dot(this.normal);return this},equals:function(a){return a.normal.equals(this.normal)&&a.constant===this.constant}};c.Frustum=function(a,b,d,e,f,k){this.planes=[void 0!==a?a:new c.Plane,void 0!==b?b:new c.Plane,void 0!==d?d:new c.Plane,
void 0!==e?e:new c.Plane,void 0!==f?f:new c.Plane,void 0!==k?k:new c.Plane]};c.Frustum.prototype={constructor:c.Frustum,set:function(a,b,c,e,f,k){var g=this.planes;g[0].copy(a);g[1].copy(b);g[2].copy(c);g[3].copy(e);g[4].copy(f);g[5].copy(k);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){for(var b=this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.elements;a=c[0];var e=c[1],f=c[2],k=c[3],g=c[4],h=c[5],
n=c[6],p=c[7],u=c[8],s=c[9],l=c[10],v=c[11],t=c[12],r=c[13],q=c[14],c=c[15];b[0].setComponents(k-a,p-g,v-u,c-t).normalize();b[1].setComponents(k+a,p+g,v+u,c+t).normalize();b[2].setComponents(k+e,p+h,v+s,c+r).normalize();b[3].setComponents(k-e,p-h,v-s,c-r).normalize();b[4].setComponents(k-f,p-n,v-l,c-q).normalize();b[5].setComponents(k+f,p+n,v+l,c+q).normalize();return this},intersectsObject:function(){var a=new c.Sphere;return function(b){var c=b.geometry;null===c.boundingSphere&&c.computeBoundingSphere();
a.copy(c.boundingSphere);a.applyMatrix4(b.matrixWorld);return this.intersectsSphere(a)}}(),intersectsSphere:function(a){var b=this.planes,c=a.center;a=-a.radius;for(var e=0;6>e;e++)if(b[e].distanceToPoint(c)<a)return!1;return!0},intersectsBox:function(){var a=new c.Vector3,b=new c.Vector3;return function(c){for(var e=this.planes,f=0;6>f;f++){var k=e[f];a.x=0<k.normal.x?c.min.x:c.max.x;b.x=0<k.normal.x?c.max.x:c.min.x;a.y=0<k.normal.y?c.min.y:c.max.y;b.y=0<k.normal.y?c.max.y:c.min.y;a.z=0<k.normal.z?
c.min.z:c.max.z;b.z=0<k.normal.z?c.max.z:c.min.z;var g=k.distanceToPoint(a),k=k.distanceToPoint(b);if(0>g&&0>k)return!1}return!0}}(),containsPoint:function(a){for(var b=this.planes,c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;return!0}};c.Math={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),b=Array(36),c=0,e;return function(){for(var f=0;36>f;f++)8===f||13===f||18===f||23===f?b[f]="-":14===f?b[f]=
"4":(2>=c&&(c=33554432+16777216*Math.random()|0),e=c&15,c>>=4,b[f]=a[19===f?e&3|8:e]);return b.join("")}}(),clamp:function(a,b,c){return Math.max(b,Math.min(c,a))},euclideanModulo:function(a,b){return(a%b+b)%b},mapLinear:function(a,b,c,e,f){return e+(a-b)*(f-e)/(c-b)},smoothstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*(3-2*a)},smootherstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*a*(a*(6*a-15)+10)},random16:function(){console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead.");
return Math.random()},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(.5-Math.random())},degToRad:function(a){return a*c.Math.DEG2RAD},radToDeg:function(a){return a*c.Math.RAD2DEG},isPowerOfTwo:function(a){return 0===(a&a-1)&&0!==a},nearestPowerOfTwo:function(a){return Math.pow(2,Math.round(Math.log(a)/Math.LN2))},nextPowerOfTwo:function(a){a--;a|=a>>1;a|=a>>2;a|=a>>4;a|=a>>8;a|=a>>16;a++;
return a}};c.Triangle=function(a,b,d){this.a=void 0!==a?a:new c.Vector3;this.b=void 0!==b?b:new c.Vector3;this.c=void 0!==d?d:new c.Vector3};c.Triangle.normal=function(){var a=new c.Vector3;return function(b,d,e,f){f=f||new c.Vector3;f.subVectors(e,d);a.subVectors(b,d);f.cross(a);b=f.lengthSq();return 0<b?f.multiplyScalar(1/Math.sqrt(b)):f.set(0,0,0)}}();c.Triangle.barycoordFromPoint=function(){var a=new c.Vector3,b=new c.Vector3,d=new c.Vector3;return function(e,f,k,g,h){a.subVectors(g,f);b.subVectors(k,
f);d.subVectors(e,f);e=a.dot(a);f=a.dot(b);k=a.dot(d);var n=b.dot(b);g=b.dot(d);var p=e*n-f*f;h=h||new c.Vector3;if(0===p)return h.set(-2,-1,-1);p=1/p;n=(n*k-f*g)*p;e=(e*g-f*k)*p;return h.set(1-n-e,e,n)}}();c.Triangle.containsPoint=function(){var a=new c.Vector3;return function(b,d,e,f){b=c.Triangle.barycoordFromPoint(b,d,e,f,a);return 0<=b.x&&0<=b.y&&1>=b.x+b.y}}();c.Triangle.prototype={constructor:c.Triangle,set:function(a,b,c){this.a.copy(a);this.b.copy(b);this.c.copy(c);return this},setFromPointsAndIndices:function(a,
b,c,e){this.a.copy(a[b]);this.b.copy(a[c]);this.c.copy(a[e]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},area:function(){var a=new c.Vector3,b=new c.Vector3;return function(){a.subVectors(this.c,this.b);b.subVectors(this.a,this.b);return.5*a.cross(b).length()}}(),midpoint:function(a){return(a||new c.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(a){return c.Triangle.normal(this.a,
this.b,this.c,a)},plane:function(a){return(a||new c.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(a,b){return c.Triangle.barycoordFromPoint(a,this.a,this.b,this.c,b)},containsPoint:function(a){return c.Triangle.containsPoint(a,this.a,this.b,this.c)},closestPointToPoint:function(){var a,b,d,e;return function(f,k){void 0===a&&(a=new c.Plane,b=[new c.Line3,new c.Line3,new c.Line3],d=new c.Vector3,e=new c.Vector3);var g=k||new c.Vector3,h=Infinity;a.setFromCoplanarPoints(this.a,
this.b,this.c);a.projectPoint(f,d);if(!0===this.containsPoint(d))g.copy(d);else{b[0].set(this.a,this.b);b[1].set(this.b,this.c);b[2].set(this.c,this.a);for(var n=0;n<b.length;n++){b[n].closestPointToPoint(d,!0,e);var p=d.distanceToSquared(e);p<h&&(h=p,g.copy(e))}}return g}}(),equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)}};c.EventDispatcher=function(){};c.EventDispatcher.prototype={constructor:c.EventDispatcher,apply:function(a){a.addEventListener=c.EventDispatcher.prototype.addEventListener;
a.hasEventListener=c.EventDispatcher.prototype.hasEventListener;a.removeEventListener=c.EventDispatcher.prototype.removeEventListener;a.dispatchEvent=c.EventDispatcher.prototype.dispatchEvent},addEventListener:function(a,b){void 0===this._listeners&&(this._listeners={});var c=this._listeners;void 0===c[a]&&(c[a]=[]);-1===c[a].indexOf(b)&&c[a].push(b)},hasEventListener:function(a,b){if(void 0===this._listeners)return!1;var c=this._listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)?!0:!1},removeEventListener:function(a,
b){if(void 0!==this._listeners){var c=this._listeners[a];if(void 0!==c){var e=c.indexOf(b);-1!==e&&c.splice(e,1)}}},dispatchEvent:function(a){if(void 0!==this._listeners){var b=this._listeners[a.type];if(void 0!==b){a.target=this;for(var c=[],e=b.length,f=0;f<e;f++)c[f]=b[f];for(f=0;f<e;f++)c[f].call(this,a)}}}};(function(a){function b(a,b){return a.distance-b.distance}function c(a,b,k,g){if(!1!==a.visible&&(a.raycast(b,k),!0===g)){a=a.children;g=0;for(var h=a.length;g<h;g++)c(a[g],b,k,!0)}}a.Raycaster=
function(b,c,d,g){this.ray=new a.Ray(b,c);this.near=d||0;this.far=g||Infinity;this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}};Object.defineProperties(this.params,{PointCloud:{get:function(){console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points.");return this.Points}}})};a.Raycaster.prototype={constructor:a.Raycaster,linePrecision:1,set:function(a,b){this.ray.set(a,b)},setFromCamera:function(b,c){c instanceof a.PerspectiveCamera?(this.ray.origin.setFromMatrixPosition(c.matrixWorld),
this.ray.direction.set(b.x,b.y,.5).unproject(c).sub(this.ray.origin).normalize()):c instanceof a.OrthographicCamera?(this.ray.origin.set(b.x,b.y,-1).unproject(c),this.ray.direction.set(0,0,-1).transformDirection(c.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(a,f){var k=[];c(a,this,k,f);k.sort(b);return k},intersectObjects:function(a,f){var k=[];if(!1===Array.isArray(a))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),
k;for(var g=0,h=a.length;g<h;g++)c(a[g],this,k,f);k.sort(b);return k}}})(c);c.Object3D=function(){Object.defineProperty(this,"id",{value:c.Object3DIdCount++});this.uuid=c.Math.generateUUID();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=c.Object3D.DefaultUp.clone();var a=new c.Vector3,b=new c.Euler,d=new c.Quaternion,e=new c.Vector3(1,1,1);b.onChange(function(){d.setFromEuler(b,!1)});d.onChange(function(){b.setFromQuaternion(d,void 0,!1)});Object.defineProperties(this,
{position:{enumerable:!0,value:a},rotation:{enumerable:!0,value:b},quaternion:{enumerable:!0,value:d},scale:{enumerable:!0,value:e},modelViewMatrix:{value:new c.Matrix4},normalMatrix:{value:new c.Matrix3}});this.rotationAutoUpdate=!0;this.matrix=new c.Matrix4;this.matrixWorld=new c.Matrix4;this.matrixAutoUpdate=c.Object3D.DefaultMatrixAutoUpdate;this.matrixWorldNeedsUpdate=!1;this.layers=new c.Layers;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.renderOrder=0;this.userData=
{}};c.Object3D.DefaultUp=new c.Vector3(0,1,0);c.Object3D.DefaultMatrixAutoUpdate=!0;c.Object3D.prototype={constructor:c.Object3D,applyMatrix:function(a){this.matrix.multiplyMatrices(a,this.matrix);this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(a,b){this.quaternion.setFromAxisAngle(a,b)},setRotationFromEuler:function(a){this.quaternion.setFromEuler(a,!0)},setRotationFromMatrix:function(a){this.quaternion.setFromRotationMatrix(a)},setRotationFromQuaternion:function(a){this.quaternion.copy(a)},
rotateOnAxis:function(){var a=new c.Quaternion;return function(b,c){a.setFromAxisAngle(b,c);this.quaternion.multiply(a);return this}}(),rotateX:function(){var a=new c.Vector3(1,0,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateY:function(){var a=new c.Vector3(0,1,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateZ:function(){var a=new c.Vector3(0,0,1);return function(b){return this.rotateOnAxis(a,b)}}(),translateOnAxis:function(){var a=new c.Vector3;return function(b,c){a.copy(b).applyQuaternion(this.quaternion);
this.position.add(a.multiplyScalar(c));return this}}(),translateX:function(){var a=new c.Vector3(1,0,0);return function(b){return this.translateOnAxis(a,b)}}(),translateY:function(){var a=new c.Vector3(0,1,0);return function(b){return this.translateOnAxis(a,b)}}(),translateZ:function(){var a=new c.Vector3(0,0,1);return function(b){return this.translateOnAxis(a,b)}}(),localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var a=new c.Matrix4;return function(b){return b.applyMatrix4(a.getInverse(this.matrixWorld))}}(),
lookAt:function(){var a=new c.Matrix4;return function(b){a.lookAt(b,this.position,this.up);this.quaternion.setFromRotationMatrix(a)}}(),add:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}if(a===this)return console.error("THREE.Object3D.add: object can't be added as a child of itself.",a),this;a instanceof c.Object3D?(null!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"}),this.children.push(a)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",
a);return this},remove:function(a){if(1<arguments.length)for(var b=0;b<arguments.length;b++)this.remove(arguments[b]);b=this.children.indexOf(a);-1!==b&&(a.parent=null,a.dispatchEvent({type:"removed"}),this.children.splice(b,1))},getObjectById:function(a){return this.getObjectByProperty("id",a)},getObjectByName:function(a){return this.getObjectByProperty("name",a)},getObjectByProperty:function(a,b){if(this[a]===b)return this;for(var c=0,e=this.children.length;c<e;c++){var f=this.children[c].getObjectByProperty(a,
b);if(void 0!==f)return f}},getWorldPosition:function(a){a=a||new c.Vector3;this.updateMatrixWorld(!0);return a.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var a=new c.Vector3,b=new c.Vector3;return function(d){d=d||new c.Quaternion;this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,d,b);return d}}(),getWorldRotation:function(){var a=new c.Quaternion;return function(b){b=b||new c.Euler;this.getWorldQuaternion(a);return b.setFromQuaternion(a,this.rotation.order,!1)}}(),
getWorldScale:function(){var a=new c.Vector3,b=new c.Quaternion;return function(d){d=d||new c.Vector3;this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,b,d);return d}}(),getWorldDirection:function(){var a=new c.Quaternion;return function(b){b=b||new c.Vector3;this.getWorldQuaternion(a);return b.set(0,0,1).applyQuaternion(a)}}(),raycast:function(){},traverse:function(a){a(this);for(var b=this.children,c=0,e=b.length;c<e;c++)b[c].traverse(a)},traverseVisible:function(a){if(!1!==this.visible){a(this);
for(var b=this.children,c=0,e=b.length;c<e;c++)b[c].traverseVisible(a)}},traverseAncestors:function(a){var b=this.parent;null!==b&&(a(b),b.traverseAncestors(a))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===a)null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,
this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0;for(var b=0,c=this.children.length;b<c;b++)this.children[b].updateMatrixWorld(a)},toJSON:function(a){function b(a){var b=[],c;for(c in a){var d=a[c];delete d.metadata;b.push(d)}return b}var c=void 0===a||""===a,e={};c&&(a={geometries:{},materials:{},textures:{},images:{}},e.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});var f={};f.uuid=this.uuid;f.type=this.type;""!==this.name&&(f.name=this.name);"{}"!==JSON.stringify(this.userData)&&
(f.userData=this.userData);!0===this.castShadow&&(f.castShadow=!0);!0===this.receiveShadow&&(f.receiveShadow=!0);!1===this.visible&&(f.visible=!1);f.matrix=this.matrix.toArray();void 0!==this.geometry&&(void 0===a.geometries[this.geometry.uuid]&&(a.geometries[this.geometry.uuid]=this.geometry.toJSON(a)),f.geometry=this.geometry.uuid);void 0!==this.material&&(void 0===a.materials[this.material.uuid]&&(a.materials[this.material.uuid]=this.material.toJSON(a)),f.material=this.material.uuid);if(0<this.children.length){f.children=
[];for(var k=0;k<this.children.length;k++)f.children.push(this.children[k].toJSON(a).object)}if(c){var c=b(a.geometries),k=b(a.materials),g=b(a.textures);a=b(a.images);0<c.length&&(e.geometries=c);0<k.length&&(e.materials=k);0<g.length&&(e.textures=g);0<a.length&&(e.images=a)}e.object=f;return e},clone:function(a){return(new this.constructor).copy(this,a)},copy:function(a,b){void 0===b&&(b=!0);this.name=a.name;this.up.copy(a.up);this.position.copy(a.position);this.quaternion.copy(a.quaternion);this.scale.copy(a.scale);
this.rotationAutoUpdate=a.rotationAutoUpdate;this.matrix.copy(a.matrix);this.matrixWorld.copy(a.matrixWorld);this.matrixAutoUpdate=a.matrixAutoUpdate;this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate;this.visible=a.visible;this.castShadow=a.castShadow;this.receiveShadow=a.receiveShadow;this.frustumCulled=a.frustumCulled;this.renderOrder=a.renderOrder;this.userData=JSON.parse(JSON.stringify(a.userData));if(!0===b)for(var c=0;c<a.children.length;c++)this.add(a.children[c].clone());return this}};
c.EventDispatcher.prototype.apply(c.Object3D.prototype);c.Object3DIdCount=0;c.Face3=function(a,b,d,e,f,k){this.a=a;this.b=b;this.c=d;this.normal=e instanceof c.Vector3?e:new c.Vector3;this.vertexNormals=Array.isArray(e)?e:[];this.color=f instanceof c.Color?f:new c.Color;this.vertexColors=Array.isArray(f)?f:[];this.materialIndex=void 0!==k?k:0};c.Face3.prototype={constructor:c.Face3,clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.a=a.a;this.b=a.b;this.c=a.c;this.normal.copy(a.normal);
this.color.copy(a.color);this.materialIndex=a.materialIndex;for(var b=0,c=a.vertexNormals.length;b<c;b++)this.vertexNormals[b]=a.vertexNormals[b].clone();b=0;for(c=a.vertexColors.length;b<c;b++)this.vertexColors[b]=a.vertexColors[b].clone();return this}};c.Layers=function(){this.mask=1};c.Layers.prototype={constructor:c.Layers,set:function(a){this.mask=1<<a},enable:function(a){this.mask|=1<<a},toggle:function(a){this.mask^=1<<a},disable:function(a){this.mask&=~(1<<a)},test:function(a){return 0!==
(this.mask&a.mask)}};c.BufferAttribute=function(a,b,d){this.uuid=c.Math.generateUUID();this.array=a;this.itemSize=b;this.dynamic=!1;this.updateRange={offset:0,count:-1};this.version=0;this.normalized=!0===d};c.BufferAttribute.prototype={constructor:c.BufferAttribute,get count(){return this.array.length/this.itemSize},set needsUpdate(a){!0===a&&this.version++},setDynamic:function(a){this.dynamic=a;return this},copy:function(a){this.array=new a.array.constructor(a.array);this.itemSize=a.itemSize;this.dynamic=
a.dynamic;return this},copyAt:function(a,b,c){a*=this.itemSize;c*=b.itemSize;for(var e=0,f=this.itemSize;e<f;e++)this.array[a+e]=b.array[c+e];return this},copyArray:function(a){this.array.set(a);return this},copyColorsArray:function(a){for(var b=this.array,d=0,e=0,f=a.length;e<f;e++){var k=a[e];void 0===k&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",e),k=new c.Color);b[d++]=k.r;b[d++]=k.g;b[d++]=k.b}return this},copyIndicesArray:function(a){for(var b=this.array,c=0,
e=0,f=a.length;e<f;e++){var k=a[e];b[c++]=k.a;b[c++]=k.b;b[c++]=k.c}return this},copyVector2sArray:function(a){for(var b=this.array,d=0,e=0,f=a.length;e<f;e++){var k=a[e];void 0===k&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",e),k=new c.Vector2);b[d++]=k.x;b[d++]=k.y}return this},copyVector3sArray:function(a){for(var b=this.array,d=0,e=0,f=a.length;e<f;e++){var k=a[e];void 0===k&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",e),
k=new c.Vector3);b[d++]=k.x;b[d++]=k.y;b[d++]=k.z}return this},copyVector4sArray:function(a){for(var b=this.array,d=0,e=0,f=a.length;e<f;e++){var k=a[e];void 0===k&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",e),k=new c.Vector4);b[d++]=k.x;b[d++]=k.y;b[d++]=k.z;b[d++]=k.w}return this},set:function(a,b){void 0===b&&(b=0);this.array.set(a,b);return this},getX:function(a){return this.array[a*this.itemSize]},setX:function(a,b){this.array[a*this.itemSize]=b;return this},
getY:function(a){return this.array[a*this.itemSize+1]},setY:function(a,b){this.array[a*this.itemSize+1]=b;return this},getZ:function(a){return this.array[a*this.itemSize+2]},setZ:function(a,b){this.array[a*this.itemSize+2]=b;return this},getW:function(a){return this.array[a*this.itemSize+3]},setW:function(a,b){this.array[a*this.itemSize+3]=b;return this},setXY:function(a,b,c){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;return this},setXYZ:function(a,b,c,e){a*=this.itemSize;this.array[a+0]=
b;this.array[a+1]=c;this.array[a+2]=e;return this},setXYZW:function(a,b,c,e,f){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;this.array[a+2]=e;this.array[a+3]=f;return this},clone:function(){return(new this.constructor).copy(this)}};c.Int8Attribute=function(a,b){return new c.BufferAttribute(new Int8Array(a),b)};c.Uint8Attribute=function(a,b){return new c.BufferAttribute(new Uint8Array(a),b)};c.Uint8ClampedAttribute=function(a,b){return new c.BufferAttribute(new Uint8ClampedArray(a),b)};c.Int16Attribute=
function(a,b){return new c.BufferAttribute(new Int16Array(a),b)};c.Uint16Attribute=function(a,b){return new c.BufferAttribute(new Uint16Array(a),b)};c.Int32Attribute=function(a,b){return new c.BufferAttribute(new Int32Array(a),b)};c.Uint32Attribute=function(a,b){return new c.BufferAttribute(new Uint32Array(a),b)};c.Float32Attribute=function(a,b){return new c.BufferAttribute(new Float32Array(a),b)};c.Float64Attribute=function(a,b){return new c.BufferAttribute(new Float64Array(a),b)};c.DynamicBufferAttribute=
function(a,b){console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.");return(new c.BufferAttribute(a,b)).setDynamic(!0)};c.Geometry=function(){Object.defineProperty(this,"id",{value:c.GeometryIdCount++});this.uuid=c.Math.generateUUID();this.name="";this.type="Geometry";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=
[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.elementsNeedUpdate=this.verticesNeedUpdate=!1};c.Geometry.prototype={constructor:c.Geometry,applyMatrix:function(a){for(var b=(new c.Matrix3).getNormalMatrix(a),d=0,e=this.vertices.length;d<e;d++)this.vertices[d].applyMatrix4(a);d=0;for(e=this.faces.length;d<e;d++){a=this.faces[d];a.normal.applyMatrix3(b).normalize();for(var f=0,k=a.vertexNormals.length;f<
k;f++)a.vertexNormals[f].applyMatrix3(b).normalize()}null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();this.normalsNeedUpdate=this.verticesNeedUpdate=!0;return this},rotateX:function(){var a;return function(b){void 0===a&&(a=new c.Matrix4);a.makeRotationX(b);this.applyMatrix(a);return this}}(),rotateY:function(){var a;return function(b){void 0===a&&(a=new c.Matrix4);a.makeRotationY(b);this.applyMatrix(a);return this}}(),rotateZ:function(){var a;
return function(b){void 0===a&&(a=new c.Matrix4);a.makeRotationZ(b);this.applyMatrix(a);return this}}(),translate:function(){var a;return function(b,d,e){void 0===a&&(a=new c.Matrix4);a.makeTranslation(b,d,e);this.applyMatrix(a);return this}}(),scale:function(){var a;return function(b,d,e){void 0===a&&(a=new c.Matrix4);a.makeScale(b,d,e);this.applyMatrix(a);return this}}(),lookAt:function(){var a;return function(b){void 0===a&&(a=new c.Object3D);a.lookAt(b);a.updateMatrix();this.applyMatrix(a.matrix)}}(),
fromBufferGeometry:function(a){function b(a,b,e,f){var k=void 0!==g?[u[a].clone(),u[b].clone(),u[e].clone()]:[],r=void 0!==h?[d.colors[a].clone(),d.colors[b].clone(),d.colors[e].clone()]:[];f=new c.Face3(a,b,e,k,r,f);d.faces.push(f);void 0!==n&&d.faceVertexUvs[0].push([s[a].clone(),s[b].clone(),s[e].clone()]);void 0!==p&&d.faceVertexUvs[1].push([l[a].clone(),l[b].clone(),l[e].clone()])}var d=this,e=null!==a.index?a.index.array:void 0,f=a.attributes,k=f.position.array,g=void 0!==f.normal?f.normal.array:
void 0,h=void 0!==f.color?f.color.array:void 0,n=void 0!==f.uv?f.uv.array:void 0,p=void 0!==f.uv2?f.uv2.array:void 0;void 0!==p&&(this.faceVertexUvs[1]=[]);for(var u=[],s=[],l=[],v=f=0;f<k.length;f+=3,v+=2)d.vertices.push(new c.Vector3(k[f],k[f+1],k[f+2])),void 0!==g&&u.push(new c.Vector3(g[f],g[f+1],g[f+2])),void 0!==h&&d.colors.push(new c.Color(h[f],h[f+1],h[f+2])),void 0!==n&&s.push(new c.Vector2(n[v],n[v+1])),void 0!==p&&l.push(new c.Vector2(p[v],p[v+1]));if(void 0!==e)if(k=a.groups,0<k.length)for(f=
0;f<k.length;f++)for(var t=k[f],r=t.start,q=t.count,v=r,r=r+q;v<r;v+=3)b(e[v],e[v+1],e[v+2],t.materialIndex);else for(f=0;f<e.length;f+=3)b(e[f],e[f+1],e[f+2]);else for(f=0;f<k.length/3;f+=3)b(f,f+1,f+2);this.computeFaceNormals();null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());return this},center:function(){this.computeBoundingBox();var a=this.boundingBox.center().negate();this.translate(a.x,a.y,a.z);return a},
normalize:function(){this.computeBoundingSphere();var a=this.boundingSphere.center,b=this.boundingSphere.radius,b=0===b?1:1/b,d=new c.Matrix4;d.set(b,0,0,-b*a.x,0,b,0,-b*a.y,0,0,b,-b*a.z,0,0,0,1);this.applyMatrix(d);return this},computeFaceNormals:function(){for(var a=new c.Vector3,b=new c.Vector3,d=0,e=this.faces.length;d<e;d++){var f=this.faces[d],k=this.vertices[f.a],g=this.vertices[f.b];a.subVectors(this.vertices[f.c],g);b.subVectors(k,g);a.cross(b);a.normalize();f.normal.copy(a)}},computeVertexNormals:function(a){void 0===
a&&(a=!0);var b,d,e;e=Array(this.vertices.length);b=0;for(d=this.vertices.length;b<d;b++)e[b]=new c.Vector3;if(a){var f,k,g,h=new c.Vector3,n=new c.Vector3;a=0;for(b=this.faces.length;a<b;a++)d=this.faces[a],f=this.vertices[d.a],k=this.vertices[d.b],g=this.vertices[d.c],h.subVectors(g,k),n.subVectors(f,k),h.cross(n),e[d.a].add(h),e[d.b].add(h),e[d.c].add(h)}else for(a=0,b=this.faces.length;a<b;a++)d=this.faces[a],e[d.a].add(d.normal),e[d.b].add(d.normal),e[d.c].add(d.normal);b=0;for(d=this.vertices.length;b<
d;b++)e[b].normalize();a=0;for(b=this.faces.length;a<b;a++)d=this.faces[a],f=d.vertexNormals,3===f.length?(f[0].copy(e[d.a]),f[1].copy(e[d.b]),f[2].copy(e[d.c])):(f[0]=e[d.a].clone(),f[1]=e[d.b].clone(),f[2]=e[d.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var a,b,d,e,f;d=0;for(e=this.faces.length;d<e;d++)for(f=this.faces[d],f.__originalFaceNormal?f.__originalFaceNormal.copy(f.normal):f.__originalFaceNormal=f.normal.clone(),f.__originalVertexNormals||
(f.__originalVertexNormals=[]),a=0,b=f.vertexNormals.length;a<b;a++)f.__originalVertexNormals[a]?f.__originalVertexNormals[a].copy(f.vertexNormals[a]):f.__originalVertexNormals[a]=f.vertexNormals[a].clone();var k=new c.Geometry;k.faces=this.faces;a=0;for(b=this.morphTargets.length;a<b;a++){if(!this.morphNormals[a]){this.morphNormals[a]={};this.morphNormals[a].faceNormals=[];this.morphNormals[a].vertexNormals=[];f=this.morphNormals[a].faceNormals;var g=this.morphNormals[a].vertexNormals,h,n;d=0;for(e=
this.faces.length;d<e;d++)h=new c.Vector3,n={a:new c.Vector3,b:new c.Vector3,c:new c.Vector3},f.push(h),g.push(n)}g=this.morphNormals[a];k.vertices=this.morphTargets[a].vertices;k.computeFaceNormals();k.computeVertexNormals();d=0;for(e=this.faces.length;d<e;d++)f=this.faces[d],h=g.faceNormals[d],n=g.vertexNormals[d],h.copy(f.normal),n.a.copy(f.vertexNormals[0]),n.b.copy(f.vertexNormals[1]),n.c.copy(f.vertexNormals[2])}d=0;for(e=this.faces.length;d<e;d++)f=this.faces[d],f.normal=f.__originalFaceNormal,
f.vertexNormals=f.__originalVertexNormals},computeTangents:function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){for(var a=0,b=this.vertices,c=0,e=b.length;c<e;c++)0<c&&(a+=b[c].distanceTo(b[c-1])),this.lineDistances[c]=a},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new c.Box3);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new c.Sphere);
this.boundingSphere.setFromPoints(this.vertices)},merge:function(a,b,d){if(!1===a instanceof c.Geometry)console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",a);else{var e,f=this.vertices.length,k=this.vertices,g=a.vertices,h=this.faces,n=a.faces,p=this.faceVertexUvs[0];a=a.faceVertexUvs[0];void 0===d&&(d=0);void 0!==b&&(e=(new c.Matrix3).getNormalMatrix(b));for(var u=0,s=g.length;u<s;u++){var l=g[u].clone();void 0!==b&&l.applyMatrix4(b);k.push(l)}u=0;for(s=n.length;u<
s;u++){var g=n[u],v,t=g.vertexNormals,r=g.vertexColors,l=new c.Face3(g.a+f,g.b+f,g.c+f);l.normal.copy(g.normal);void 0!==e&&l.normal.applyMatrix3(e).normalize();b=0;for(k=t.length;b<k;b++)v=t[b].clone(),void 0!==e&&v.applyMatrix3(e).normalize(),l.vertexNormals.push(v);l.color.copy(g.color);b=0;for(k=r.length;b<k;b++)v=r[b],l.vertexColors.push(v.clone());l.materialIndex=g.materialIndex+d;h.push(l)}u=0;for(s=a.length;u<s;u++)if(d=a[u],e=[],void 0!==d){b=0;for(k=d.length;b<k;b++)e.push(d[b].clone());
p.push(e)}}},mergeMesh:function(a){!1===a instanceof c.Mesh?console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",a):(a.matrixAutoUpdate&&a.updateMatrix(),this.merge(a.geometry,a.matrix))},mergeVertices:function(){var a={},b=[],c=[],e,f=Math.pow(10,4),k,g;k=0;for(g=this.vertices.length;k<g;k++)e=this.vertices[k],e=Math.round(e.x*f)+"_"+Math.round(e.y*f)+"_"+Math.round(e.z*f),void 0===a[e]?(a[e]=k,b.push(this.vertices[k]),c[k]=b.length-1):c[k]=c[a[e]];a=[];k=0;for(g=this.faces.length;k<
g;k++)for(f=this.faces[k],f.a=c[f.a],f.b=c[f.b],f.c=c[f.c],f=[f.a,f.b,f.c],e=0;3>e;e++)if(f[e]===f[(e+1)%3]){a.push(k);break}for(k=a.length-1;0<=k;k--)for(f=a[k],this.faces.splice(f,1),c=0,g=this.faceVertexUvs.length;c<g;c++)this.faceVertexUvs[c].splice(f,1);k=this.vertices.length-b.length;this.vertices=b;return k},sortFacesByMaterialIndex:function(){for(var a=this.faces,b=a.length,c=0;c<b;c++)a[c]._id=c;a.sort(function(a,b){return a.materialIndex-b.materialIndex});var e=this.faceVertexUvs[0],f=this.faceVertexUvs[1],
k,g;e&&e.length===b&&(k=[]);f&&f.length===b&&(g=[]);for(c=0;c<b;c++){var h=a[c]._id;k&&k.push(e[h]);g&&g.push(f[h])}k&&(this.faceVertexUvs[0]=k);g&&(this.faceVertexUvs[1]=g)},toJSON:function(){function a(a,b,c){return c?a|1<<b:a&~(1<<b)}function b(a){var b=a.x.toString()+a.y.toString()+a.z.toString();if(void 0!==p[b])return p[b];p[b]=q.length/3;q.push(a.x,a.y,a.z);return p[b]}function c(a){var b=a.r.toString()+a.g.toString()+a.b.toString();if(void 0!==s[b])return s[b];s[b]=u.length;u.push(a.getHex());
return s[b]}function e(a){var b=a.x.toString()+a.y.toString();if(void 0!==v[b])return v[b];v[b]=l.length/2;l.push(a.x,a.y);return v[b]}var f={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};f.uuid=this.uuid;f.type=this.type;""!==this.name&&(f.name=this.name);if(void 0!==this.parameters){var g=this.parameters,h;for(h in g)void 0!==g[h]&&(f[h]=g[h]);return f}g=[];for(h=0;h<this.vertices.length;h++){var n=this.vertices[h];g.push(n.x,n.y,n.z)}var n=[],q=[],p={},u=[],s={},l=[],v={};
for(h=0;h<this.faces.length;h++){var t=this.faces[h],r=void 0!==this.faceVertexUvs[0][h],D=0<t.normal.length(),z=0<t.vertexNormals.length,y=1!==t.color.r||1!==t.color.g||1!==t.color.b,E=0<t.vertexColors.length,B=0,B=a(B,0,0),B=a(B,1,!0),B=a(B,2,!1),B=a(B,3,r),B=a(B,4,D),B=a(B,5,z),B=a(B,6,y),B=a(B,7,E);n.push(B);n.push(t.a,t.b,t.c);n.push(t.materialIndex);r&&(r=this.faceVertexUvs[0][h],n.push(e(r[0]),e(r[1]),e(r[2])));D&&n.push(b(t.normal));z&&(D=t.vertexNormals,n.push(b(D[0]),b(D[1]),b(D[2])));y&&
n.push(c(t.color));E&&(t=t.vertexColors,n.push(c(t[0]),c(t[1]),c(t[2])))}f.data={};f.data.vertices=g;f.data.normals=q;0<u.length&&(f.data.colors=u);0<l.length&&(f.data.uvs=[l]);f.data.faces=n;return f},clone:function(){return(new c.Geometry).copy(this)},copy:function(a){this.vertices=[];this.faces=[];this.faceVertexUvs=[[]];for(var b=a.vertices,c=0,e=b.length;c<e;c++)this.vertices.push(b[c].clone());b=a.faces;c=0;for(e=b.length;c<e;c++)this.faces.push(b[c].clone());c=0;for(e=a.faceVertexUvs.length;c<
e;c++){b=a.faceVertexUvs[c];void 0===this.faceVertexUvs[c]&&(this.faceVertexUvs[c]=[]);for(var f=0,g=b.length;f<g;f++){for(var h=b[f],n=[],q=0,p=h.length;q<p;q++)n.push(h[q].clone());this.faceVertexUvs[c].push(n)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}};c.EventDispatcher.prototype.apply(c.Geometry.prototype);c.GeometryIdCount=0;c.BufferGeometry=function(){Object.defineProperty(this,"id",{value:c.GeometryIdCount++});this.uuid=c.Math.generateUUID();this.name="";this.type=
"BufferGeometry";this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;this.drawRange={start:0,count:Infinity}};c.BufferGeometry.prototype={constructor:c.BufferGeometry,getIndex:function(){return this.index},setIndex:function(a){this.index=a},addAttribute:function(a,b,d){if(!1===b instanceof c.BufferAttribute&&!1===b instanceof c.InterleavedBufferAttribute)console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),
this.addAttribute(a,new c.BufferAttribute(b,d));else if("index"===a)console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(b);else return this.attributes[a]=b,this},getAttribute:function(a){return this.attributes[a]},removeAttribute:function(a){delete this.attributes[a];return this},addGroup:function(a,b,c){this.groups.push({start:a,count:b,materialIndex:void 0!==c?c:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(a,b){this.drawRange.start=
a;this.drawRange.count=b},applyMatrix:function(a){var b=this.attributes.position;void 0!==b&&(a.applyToVector3Array(b.array),b.needsUpdate=!0);b=this.attributes.normal;void 0!==b&&((new c.Matrix3).getNormalMatrix(a).applyToVector3Array(b.array),b.needsUpdate=!0);null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();return this},rotateX:function(){var a;return function(b){void 0===a&&(a=new c.Matrix4);a.makeRotationX(b);this.applyMatrix(a);return this}}(),
rotateY:function(){var a;return function(b){void 0===a&&(a=new c.Matrix4);a.makeRotationY(b);this.applyMatrix(a);return this}}(),rotateZ:function(){var a;return function(b){void 0===a&&(a=new c.Matrix4);a.makeRotationZ(b);this.applyMatrix(a);return this}}(),translate:function(){var a;return function(b,d,e){void 0===a&&(a=new c.Matrix4);a.makeTranslation(b,d,e);this.applyMatrix(a);return this}}(),scale:function(){var a;return function(b,d,e){void 0===a&&(a=new c.Matrix4);a.makeScale(b,d,e);this.applyMatrix(a);
return this}}(),lookAt:function(){var a;return function(b){void 0===a&&(a=new c.Object3D);a.lookAt(b);a.updateMatrix();this.applyMatrix(a.matrix)}}(),center:function(){this.computeBoundingBox();var a=this.boundingBox.center().negate();this.translate(a.x,a.y,a.z);return a},setFromObject:function(a){var b=a.geometry;if(a instanceof c.Points||a instanceof c.Line){a=new c.Float32Attribute(3*b.vertices.length,3);var d=new c.Float32Attribute(3*b.colors.length,3);this.addAttribute("position",a.copyVector3sArray(b.vertices));
this.addAttribute("color",d.copyColorsArray(b.colors));b.lineDistances&&b.lineDistances.length===b.vertices.length&&(a=new c.Float32Attribute(b.lineDistances.length,1),this.addAttribute("lineDistance",a.copyArray(b.lineDistances)));null!==b.boundingSphere&&(this.boundingSphere=b.boundingSphere.clone());null!==b.boundingBox&&(this.boundingBox=b.boundingBox.clone())}else a instanceof c.Mesh&&b instanceof c.Geometry&&this.fromGeometry(b);return this},updateFromObject:function(a){var b=a.geometry;if(a instanceof
c.Mesh){var d=b.__directGeometry;if(void 0===d)return this.fromGeometry(b);d.verticesNeedUpdate=b.verticesNeedUpdate;d.normalsNeedUpdate=b.normalsNeedUpdate;d.colorsNeedUpdate=b.colorsNeedUpdate;d.uvsNeedUpdate=b.uvsNeedUpdate;d.groupsNeedUpdate=b.groupsNeedUpdate;b.verticesNeedUpdate=!1;b.normalsNeedUpdate=!1;b.colorsNeedUpdate=!1;b.uvsNeedUpdate=!1;b.groupsNeedUpdate=!1;b=d}!0===b.verticesNeedUpdate&&(d=this.attributes.position,void 0!==d&&(d.copyVector3sArray(b.vertices),d.needsUpdate=!0),b.verticesNeedUpdate=
!1);!0===b.normalsNeedUpdate&&(d=this.attributes.normal,void 0!==d&&(d.copyVector3sArray(b.normals),d.needsUpdate=!0),b.normalsNeedUpdate=!1);!0===b.colorsNeedUpdate&&(d=this.attributes.color,void 0!==d&&(d.copyColorsArray(b.colors),d.needsUpdate=!0),b.colorsNeedUpdate=!1);b.uvsNeedUpdate&&(d=this.attributes.uv,void 0!==d&&(d.copyVector2sArray(b.uvs),d.needsUpdate=!0),b.uvsNeedUpdate=!1);b.lineDistancesNeedUpdate&&(d=this.attributes.lineDistance,void 0!==d&&(d.copyArray(b.lineDistances),d.needsUpdate=
!0),b.lineDistancesNeedUpdate=!1);b.groupsNeedUpdate&&(b.computeGroups(a.geometry),this.groups=b.groups,b.groupsNeedUpdate=!1);return this},fromGeometry:function(a){a.__directGeometry=(new c.DirectGeometry).fromGeometry(a);return this.fromDirectGeometry(a.__directGeometry)},fromDirectGeometry:function(a){var b=new Float32Array(3*a.vertices.length);this.addAttribute("position",(new c.BufferAttribute(b,3)).copyVector3sArray(a.vertices));0<a.normals.length&&(b=new Float32Array(3*a.normals.length),this.addAttribute("normal",
(new c.BufferAttribute(b,3)).copyVector3sArray(a.normals)));0<a.colors.length&&(b=new Float32Array(3*a.colors.length),this.addAttribute("color",(new c.BufferAttribute(b,3)).copyColorsArray(a.colors)));0<a.uvs.length&&(b=new Float32Array(2*a.uvs.length),this.addAttribute("uv",(new c.BufferAttribute(b,2)).copyVector2sArray(a.uvs)));0<a.uvs2.length&&(b=new Float32Array(2*a.uvs2.length),this.addAttribute("uv2",(new c.BufferAttribute(b,2)).copyVector2sArray(a.uvs2)));0<a.indices.length&&(b=new (65535<
a.vertices.length?Uint32Array:Uint16Array)(3*a.indices.length),this.setIndex((new c.BufferAttribute(b,1)).copyIndicesArray(a.indices)));this.groups=a.groups;for(var d in a.morphTargets){for(var b=[],e=a.morphTargets[d],f=0,g=e.length;f<g;f++){var h=e[f],n=new c.Float32Attribute(3*h.length,3);b.push(n.copyVector3sArray(h))}this.morphAttributes[d]=b}0<a.skinIndices.length&&(d=new c.Float32Attribute(4*a.skinIndices.length,4),this.addAttribute("skinIndex",d.copyVector4sArray(a.skinIndices)));0<a.skinWeights.length&&
(d=new c.Float32Attribute(4*a.skinWeights.length,4),this.addAttribute("skinWeight",d.copyVector4sArray(a.skinWeights)));null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());return this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new c.Box3);var a=this.attributes.position.array;void 0!==a?this.boundingBox.setFromArray(a):this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||
isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var a=new c.Box3,b=new c.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new c.Sphere);var d=this.attributes.position.array;if(d){var e=this.boundingSphere.center;a.setFromArray(d);a.center(e);for(var f=0,g=0,h=d.length;g<h;g+=3)b.fromArray(d,g),f=Math.max(f,
e.distanceToSquared(b));this.boundingSphere.radius=Math.sqrt(f);isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var a=this.index,b=this.attributes,d=this.groups;if(b.position){var e=b.position.array;if(void 0===b.normal)this.addAttribute("normal",new c.BufferAttribute(new Float32Array(e.length),3));
else for(var f=b.normal.array,g=0,h=f.length;g<h;g++)f[g]=0;var f=b.normal.array,n,q,p,u=new c.Vector3,s=new c.Vector3,l=new c.Vector3,v=new c.Vector3,t=new c.Vector3;if(a){a=a.array;0===d.length&&this.addGroup(0,a.length);for(var r=0,D=d.length;r<D;++r)for(g=d[r],h=g.start,n=g.count,g=h,h+=n;g<h;g+=3)n=3*a[g+0],q=3*a[g+1],p=3*a[g+2],u.fromArray(e,n),s.fromArray(e,q),l.fromArray(e,p),v.subVectors(l,s),t.subVectors(u,s),v.cross(t),f[n]+=v.x,f[n+1]+=v.y,f[n+2]+=v.z,f[q]+=v.x,f[q+1]+=v.y,f[q+2]+=v.z,
f[p]+=v.x,f[p+1]+=v.y,f[p+2]+=v.z}else for(g=0,h=e.length;g<h;g+=9)u.fromArray(e,g),s.fromArray(e,g+3),l.fromArray(e,g+6),v.subVectors(l,s),t.subVectors(u,s),v.cross(t),f[g]=v.x,f[g+1]=v.y,f[g+2]=v.z,f[g+3]=v.x,f[g+4]=v.y,f[g+5]=v.z,f[g+6]=v.x,f[g+7]=v.y,f[g+8]=v.z;this.normalizeNormals();b.normal.needsUpdate=!0}},merge:function(a,b){if(!1===a instanceof c.BufferGeometry)console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",a);else{void 0===b&&(b=0);var d=
this.attributes,e;for(e in d)if(void 0!==a.attributes[e])for(var f=d[e].array,g=a.attributes[e],h=g.array,n=0,g=g.itemSize*b;n<h.length;n++,g++)f[g]=h[n];return this}},normalizeNormals:function(){for(var a=this.attributes.normal.array,b,c,e,f=0,g=a.length;f<g;f+=3)b=a[f],c=a[f+1],e=a[f+2],b=1/Math.sqrt(b*b+c*c+e*e),a[f]*=b,a[f+1]*=b,a[f+2]*=b},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var a=new c.BufferGeometry,
b=this.index.array,d=this.attributes,e;for(e in d){for(var f=d[e],g=f.array,f=f.itemSize,h=new g.constructor(b.length*f),n=0,q=0,p=0,u=b.length;p<u;p++)for(var n=b[p]*f,s=0;s<f;s++)h[q++]=g[n++];a.addAttribute(e,new c.BufferAttribute(h,f))}return a},toJSON:function(){var a={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};a.uuid=this.uuid;a.type=this.type;""!==this.name&&(a.name=this.name);if(void 0!==this.parameters){var b=this.parameters,c;for(c in b)void 0!==b[c]&&
(a[c]=b[c]);return a}a.data={attributes:{}};var e=this.index;null!==e&&(b=Array.prototype.slice.call(e.array),a.data.index={type:e.array.constructor.name,array:b});e=this.attributes;for(c in e){var f=e[c],b=Array.prototype.slice.call(f.array);a.data.attributes[c]={itemSize:f.itemSize,type:f.array.constructor.name,array:b,normalized:f.normalized}}c=this.groups;0<c.length&&(a.data.groups=JSON.parse(JSON.stringify(c)));c=this.boundingSphere;null!==c&&(a.data.boundingSphere={center:c.center.toArray(),
radius:c.radius});return a},clone:function(){return(new c.BufferGeometry).copy(this)},copy:function(a){var b=a.index;null!==b&&this.setIndex(b.clone());var b=a.attributes,c;for(c in b)this.addAttribute(c,b[c].clone());a=a.groups;c=0;for(b=a.length;c<b;c++){var e=a[c];this.addGroup(e.start,e.count,e.materialIndex)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}};c.EventDispatcher.prototype.apply(c.BufferGeometry.prototype);c.BufferGeometry.MaxIndex=65535;c.Camera=function(){c.Object3D.call(this);
this.type="Camera";this.matrixWorldInverse=new c.Matrix4;this.projectionMatrix=new c.Matrix4};c.Camera.prototype=Object.create(c.Object3D.prototype);c.Camera.prototype.constructor=c.Camera;c.Camera.prototype.getWorldDirection=function(){var a=new c.Quaternion;return function(b){b=b||new c.Vector3;this.getWorldQuaternion(a);return b.set(0,0,-1).applyQuaternion(a)}}();c.Camera.prototype.lookAt=function(){var a=new c.Matrix4;return function(b){a.lookAt(this.position,b,this.up);this.quaternion.setFromRotationMatrix(a)}}();
c.Camera.prototype.clone=function(){return(new this.constructor).copy(this)};c.Camera.prototype.copy=function(a){c.Object3D.prototype.copy.call(this,a);this.matrixWorldInverse.copy(a.matrixWorldInverse);this.projectionMatrix.copy(a.projectionMatrix);return this};c.PerspectiveCamera=function(a,b,d,e){c.Camera.call(this);this.type="PerspectiveCamera";this.fov=void 0!==a?a:50;this.zoom=1;this.near=void 0!==d?d:.1;this.far=void 0!==e?e:2E3;this.focus=10;this.aspect=void 0!==b?b:1;this.view=null;this.filmGauge=
35;this.filmOffset=0;this.updateProjectionMatrix()};c.PerspectiveCamera.prototype=Object.create(c.Camera.prototype);c.PerspectiveCamera.prototype.constructor=c.PerspectiveCamera;c.PerspectiveCamera.prototype.setLens=function(a,b){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup.");void 0!==b&&(this.filmGauge=b);this.setFocalLength(a)};c.PerspectiveCamera.prototype.setFocalLength=function(a){a=.5*this.getFilmHeight()/a;this.fov=
2*c.Math.RAD2DEG*Math.atan(a);this.updateProjectionMatrix()};c.PerspectiveCamera.prototype.getFocalLength=function(){var a=Math.tan(.5*c.Math.DEG2RAD*this.fov);return.5*this.getFilmHeight()/a};c.PerspectiveCamera.prototype.getEffectiveFOV=function(){return 2*c.Math.RAD2DEG*Math.atan(Math.tan(.5*c.Math.DEG2RAD*this.fov)/this.zoom)};c.PerspectiveCamera.prototype.getFilmWidth=function(){return this.filmGauge*Math.min(this.aspect,1)};c.PerspectiveCamera.prototype.getFilmHeight=function(){return this.filmGauge/
Math.max(this.aspect,1)};c.PerspectiveCamera.prototype.setViewOffset=function(a,b,c,e,f,g){this.aspect=a/b;this.view={fullWidth:a,fullHeight:b,offsetX:c,offsetY:e,width:f,height:g};this.updateProjectionMatrix()};c.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var a=this.near,b=a*Math.tan(.5*c.Math.DEG2RAD*this.fov)/this.zoom,d=2*b,e=this.aspect*d,f=-.5*e,g=this.view;if(null!==g)var h=g.fullWidth,n=g.fullHeight,f=f+g.offsetX*e/h,b=b-g.offsetY*d/n,e=g.width/h*e,d=g.height/n*d;g=this.filmOffset;
0!==g&&(f+=a*g/this.getFilmWidth());this.projectionMatrix.makeFrustum(f,f+e,b-d,b,a,this.far)};c.PerspectiveCamera.prototype.copy=function(a){c.Camera.prototype.copy.call(this,a);this.fov=a.fov;this.zoom=a.zoom;this.near=a.near;this.far=a.far;this.focus=a.focus;this.aspect=a.aspect;this.view=null===a.view?null:Object.assign({},a.view);this.filmGauge=a.filmGauge;this.filmOffset=a.filmOffset;return this};c.PerspectiveCamera.prototype.toJSON=function(a){a=c.Object3D.prototype.toJSON.call(this,a);a.object.fov=
this.fov;a.object.zoom=this.zoom;a.object.near=this.near;a.object.far=this.far;a.object.focus=this.focus;a.object.aspect=this.aspect;null!==this.view&&(a.object.view=Object.assign({},this.view));a.object.filmGauge=this.filmGauge;a.object.filmOffset=this.filmOffset;return a};c.Light=function(a,b){c.Object3D.call(this);this.type="Light";this.color=new c.Color(a);this.intensity=void 0!==b?b:1;this.receiveShadow=void 0};c.Light.prototype=Object.create(c.Object3D.prototype);c.Light.prototype.constructor=
c.Light;c.Light.prototype.copy=function(a){c.Object3D.prototype.copy.call(this,a);this.color.copy(a.color);this.intensity=a.intensity;return this};c.Light.prototype.toJSON=function(a){a=c.Object3D.prototype.toJSON.call(this,a);a.object.color=this.color.getHex();a.object.intensity=this.intensity;void 0!==this.groundColor&&(a.object.groundColor=this.groundColor.getHex());void 0!==this.distance&&(a.object.distance=this.distance);void 0!==this.angle&&(a.object.angle=this.angle);void 0!==this.decay&&(a.object.decay=
this.decay);void 0!==this.penumbra&&(a.object.penumbra=this.penumbra);return a};c.AmbientLight=function(a,b){c.Light.call(this,a,b);this.type="AmbientLight";this.castShadow=void 0};c.AmbientLight.prototype=Object.create(c.Light.prototype);c.AmbientLight.prototype.constructor=c.AmbientLight;c.PointLight=function(a,b,d,e){c.Light.call(this,a,b);this.type="PointLight";this.distance=void 0!==d?d:0;this.decay=void 0!==e?e:1;this.shadow=new c.LightShadow(new c.PerspectiveCamera(90,1,.5,500))};c.PointLight.prototype=
Object.create(c.Light.prototype);c.PointLight.prototype.constructor=c.PointLight;Object.defineProperty(c.PointLight.prototype,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(a){this.intensity=a/(4*Math.PI)}});c.PointLight.prototype.copy=function(a){c.Light.prototype.copy.call(this,a);this.distance=a.distance;this.decay=a.decay;this.shadow=a.shadow.clone();return this};c.DirectionalLight=function(a,b){c.Light.call(this,a,b);this.type="DirectionalLight";this.position.set(0,1,0);
this.updateMatrix();this.target=new c.Object3D;this.shadow=new c.DirectionalLightShadow};c.DirectionalLight.prototype=Object.create(c.Light.prototype);c.DirectionalLight.prototype.constructor=c.DirectionalLight;c.DirectionalLight.prototype.copy=function(a){c.Light.prototype.copy.call(this,a);this.target=a.target.clone();this.shadow=a.shadow.clone();return this};c.LightShadow=function(a){this.camera=a;this.bias=0;this.radius=1;this.mapSize=new c.Vector2(512,512);this.map=null;this.matrix=new c.Matrix4};
c.LightShadow.prototype={constructor:c.LightShadow,copy:function(a){this.camera=a.camera.clone();this.bias=a.bias;this.radius=a.radius;this.mapSize.copy(a.mapSize);return this},clone:function(){return(new this.constructor).copy(this)}};c.Material=function(){Object.defineProperty(this,"id",{value:c.MaterialIdCount++});this.uuid=c.Math.generateUUID();this.name="";this.type="Material";this.side=c.FrontSide;this.opacity=1;this.transparent=!1;this.blending=c.NormalBlending;this.blendSrc=c.SrcAlphaFactor;
this.blendDst=c.OneMinusSrcAlphaFactor;this.blendEquation=c.AddEquation;this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null;this.depthFunc=c.LessEqualDepth;this.depthWrite=this.depthTest=!0;this.clippingPlanes=null;this.clipShadows=!1;this.colorWrite=!0;this.precision=null;this.polygonOffset=!1;this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.premultipliedAlpha=!1;this.overdraw=0;this._needsUpdate=this.visible=!0};c.Material.prototype={constructor:c.Material,get needsUpdate(){return this._needsUpdate},
set needsUpdate(a){!0===a&&this.update();this._needsUpdate=a},setValues:function(a){if(void 0!==a)for(var b in a){var d=a[b];if(void 0===d)console.warn("THREE.Material: '"+b+"' parameter is undefined.");else{var e=this[b];void 0===e?console.warn("THREE."+this.type+": '"+b+"' is not a property of this material."):e instanceof c.Color?e.set(d):e instanceof c.Vector3&&d instanceof c.Vector3?e.copy(d):this[b]="overdraw"===b?Number(d):d}}},toJSON:function(a){function b(a){var b=[],c;for(c in a){var d=
a[c];delete d.metadata;b.push(d)}return b}var d=void 0===a;d&&(a={textures:{},images:{}});var e={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};e.uuid=this.uuid;e.type=this.type;""!==this.name&&(e.name=this.name);this.color instanceof c.Color&&(e.color=this.color.getHex());.5!==this.roughness&&(e.roughness=this.roughness);.5!==this.metalness&&(e.metalness=this.metalness);this.emissive instanceof c.Color&&(e.emissive=this.emissive.getHex());this.specular instanceof c.Color&&(e.specular=
this.specular.getHex());void 0!==this.shininess&&(e.shininess=this.shininess);this.map instanceof c.Texture&&(e.map=this.map.toJSON(a).uuid);this.alphaMap instanceof c.Texture&&(e.alphaMap=this.alphaMap.toJSON(a).uuid);this.lightMap instanceof c.Texture&&(e.lightMap=this.lightMap.toJSON(a).uuid);this.bumpMap instanceof c.Texture&&(e.bumpMap=this.bumpMap.toJSON(a).uuid,e.bumpScale=this.bumpScale);this.normalMap instanceof c.Texture&&(e.normalMap=this.normalMap.toJSON(a).uuid,e.normalScale=this.normalScale.toArray());
this.displacementMap instanceof c.Texture&&(e.displacementMap=this.displacementMap.toJSON(a).uuid,e.displacementScale=this.displacementScale,e.displacementBias=this.displacementBias);this.roughnessMap instanceof c.Texture&&(e.roughnessMap=this.roughnessMap.toJSON(a).uuid);this.metalnessMap instanceof c.Texture&&(e.metalnessMap=this.metalnessMap.toJSON(a).uuid);this.emissiveMap instanceof c.Texture&&(e.emissiveMap=this.emissiveMap.toJSON(a).uuid);this.specularMap instanceof c.Texture&&(e.specularMap=
this.specularMap.toJSON(a).uuid);this.envMap instanceof c.Texture&&(e.envMap=this.envMap.toJSON(a).uuid,e.reflectivity=this.reflectivity);void 0!==this.size&&(e.size=this.size);void 0!==this.sizeAttenuation&&(e.sizeAttenuation=this.sizeAttenuation);void 0!==this.vertexColors&&this.vertexColors!==c.NoColors&&(e.vertexColors=this.vertexColors);void 0!==this.shading&&this.shading!==c.SmoothShading&&(e.shading=this.shading);void 0!==this.blending&&this.blending!==c.NormalBlending&&(e.blending=this.blending);
void 0!==this.side&&this.side!==c.FrontSide&&(e.side=this.side);1>this.opacity&&(e.opacity=this.opacity);!0===this.transparent&&(e.transparent=this.transparent);0<this.alphaTest&&(e.alphaTest=this.alphaTest);!0===this.premultipliedAlpha&&(e.premultipliedAlpha=this.premultipliedAlpha);!0===this.wireframe&&(e.wireframe=this.wireframe);1<this.wireframeLinewidth&&(e.wireframeLinewidth=this.wireframeLinewidth);d&&(d=b(a.textures),a=b(a.images),0<d.length&&(e.textures=d),0<a.length&&(e.images=a));return e},
clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.name=a.name;this.side=a.side;this.opacity=a.opacity;this.transparent=a.transparent;this.blending=a.blending;this.blendSrc=a.blendSrc;this.blendDst=a.blendDst;this.blendEquation=a.blendEquation;this.blendSrcAlpha=a.blendSrcAlpha;this.blendDstAlpha=a.blendDstAlpha;this.blendEquationAlpha=a.blendEquationAlpha;this.depthFunc=a.depthFunc;this.depthTest=a.depthTest;this.depthWrite=a.depthWrite;this.colorWrite=a.colorWrite;this.precision=
a.precision;this.polygonOffset=a.polygonOffset;this.polygonOffsetFactor=a.polygonOffsetFactor;this.polygonOffsetUnits=a.polygonOffsetUnits;this.alphaTest=a.alphaTest;this.premultipliedAlpha=a.premultipliedAlpha;this.overdraw=a.overdraw;this.visible=a.visible;this.clipShadows=a.clipShadows;a=a.clippingPlanes;var b=null;if(null!==a)for(var c=a.length,b=Array(c),e=0;e!==c;++e)b[e]=a[e].clone();this.clippingPlanes=b;return this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}};
c.EventDispatcher.prototype.apply(c.Material.prototype);c.MaterialIdCount=0;c.LineBasicMaterial=function(a){c.Material.call(this);this.type="LineBasicMaterial";this.color=new c.Color(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.blending=c.NormalBlending;this.vertexColors=c.NoColors;this.fog=!0;this.setValues(a)};c.LineBasicMaterial.prototype=Object.create(c.Material.prototype);c.LineBasicMaterial.prototype.constructor=c.LineBasicMaterial;c.LineBasicMaterial.prototype.copy=function(a){c.Material.prototype.copy.call(this,
a);this.color.copy(a.color);this.linewidth=a.linewidth;this.linecap=a.linecap;this.linejoin=a.linejoin;this.vertexColors=a.vertexColors;this.fog=a.fog;return this};c.MeshBasicMaterial=function(a){c.Material.call(this);this.type="MeshBasicMaterial";this.color=new c.Color(16777215);this.aoMap=this.map=null;this.aoMapIntensity=1;this.envMap=this.alphaMap=this.specularMap=null;this.combine=c.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.shading=c.SmoothShading;this.blending=
c.NormalBlending;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=c.NoColors;this.morphTargets=this.skinning=!1;this.setValues(a)};c.MeshBasicMaterial.prototype=Object.create(c.Material.prototype);c.MeshBasicMaterial.prototype.constructor=c.MeshBasicMaterial;c.MeshBasicMaterial.prototype.copy=function(a){c.Material.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;
this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.fog=a.fog;this.shading=a.shading;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.vertexColors=a.vertexColors;this.skinning=a.skinning;this.morphTargets=a.morphTargets;return this};c.MeshLambertMaterial=function(a){c.Material.call(this);
this.type="MeshLambertMaterial";this.color=new c.Color(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new c.Color(0);this.emissiveIntensity=1;this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null;this.combine=c.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.blending=c.NormalBlending;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=
c.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};c.MeshLambertMaterial.prototype=Object.create(c.Material.prototype);c.MeshLambertMaterial.prototype.constructor=c.MeshLambertMaterial;c.MeshLambertMaterial.prototype.copy=function(a){c.Material.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=
a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.fog=a.fog;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.vertexColors=a.vertexColors;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=
a.morphNormals;return this};c.MultiMaterial=function(a){this.uuid=c.Math.generateUUID();this.type="MultiMaterial";this.materials=a instanceof Array?a:[];this.visible=!0};c.MultiMaterial.prototype={constructor:c.MultiMaterial,toJSON:function(a){for(var b={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},c=this.materials,e=0,f=c.length;e<f;e++){var g=c[e].toJSON(a);delete g.metadata;b.materials.push(g)}b.visible=this.visible;return b},clone:function(){for(var a=
new this.constructor,b=0;b<this.materials.length;b++)a.materials.push(this.materials[b].clone());a.visible=this.visible;return a}};c.MeshPhongMaterial=function(a){c.Material.call(this);this.type="MeshPhongMaterial";this.color=new c.Color(16777215);this.specular=new c.Color(1118481);this.shininess=30;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new c.Color(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=
null;this.normalScale=new c.Vector2(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.specularMap=null;this.combine=c.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.shading=c.SmoothShading;this.blending=c.NormalBlending;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=c.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};
c.MeshPhongMaterial.prototype=Object.create(c.Material.prototype);c.MeshPhongMaterial.prototype.constructor=c.MeshPhongMaterial;c.MeshPhongMaterial.prototype.copy=function(a){c.Material.prototype.copy.call(this,a);this.color.copy(a.color);this.specular.copy(a.specular);this.shininess=a.shininess;this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=
a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.fog=a.fog;this.shading=a.shading;this.wireframe=a.wireframe;this.wireframeLinewidth=
a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.vertexColors=a.vertexColors;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};c.MeshDepthMaterial=function(a){c.Material.call(this);this.type="MeshDepthMaterial";this.depthPacking=c.BasicDepthPacking;this.morphTargets=this.skinning=!1;this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=
!1;this.wireframeLinewidth=1;this.setValues(a)};c.MeshDepthMaterial.prototype=Object.create(c.Material.prototype);c.MeshDepthMaterial.prototype.constructor=c.MeshDepthMaterial;c.MeshDepthMaterial.prototype.copy=function(a){c.Material.prototype.copy.call(this,a);this.depthPacking=a.depthPacking;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.map=a.map;this.alphaMap=a.alphaMap;this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;
this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;return this};c.MeshNormalMaterial=function(a){c.Material.call(this,a);this.type="MeshNormalMaterial";this.wireframe=!1;this.wireframeLinewidth=1;this.morphTargets=!1;this.setValues(a)};c.MeshNormalMaterial.prototype=Object.create(c.Material.prototype);c.MeshNormalMaterial.prototype.constructor=c.MeshNormalMaterial;c.MeshNormalMaterial.prototype.copy=function(a){c.Material.prototype.copy.call(this,a);this.wireframe=a.wireframe;
this.wireframeLinewidth=a.wireframeLinewidth;return this};c.SpriteMaterial=function(a){c.Material.call(this);this.type="SpriteMaterial";this.color=new c.Color(16777215);this.map=null;this.rotation=0;this.fog=!1;this.setValues(a)};c.SpriteMaterial.prototype=Object.create(c.Material.prototype);c.SpriteMaterial.prototype.constructor=c.SpriteMaterial;c.SpriteMaterial.prototype.copy=function(a){c.Material.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.rotation=a.rotation;this.fog=
a.fog;return this};c.Texture=function(a,b,d,e,f,g,h,n,q,p){Object.defineProperty(this,"id",{value:c.TextureIdCount++});this.uuid=c.Math.generateUUID();this.sourceFile=this.name="";this.image=void 0!==a?a:c.Texture.DEFAULT_IMAGE;this.mipmaps=[];this.mapping=void 0!==b?b:c.Texture.DEFAULT_MAPPING;this.wrapS=void 0!==d?d:c.ClampToEdgeWrapping;this.wrapT=void 0!==e?e:c.ClampToEdgeWrapping;this.magFilter=void 0!==f?f:c.LinearFilter;this.minFilter=void 0!==g?g:c.LinearMipMapLinearFilter;this.anisotropy=
void 0!==q?q:1;this.format=void 0!==h?h:c.RGBAFormat;this.type=void 0!==n?n:c.UnsignedByteType;this.offset=new c.Vector2(0,0);this.repeat=new c.Vector2(1,1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.encoding=void 0!==p?p:c.LinearEncoding;this.version=0;this.onUpdate=null};c.Texture.DEFAULT_IMAGE=void 0;c.Texture.DEFAULT_MAPPING=c.UVMapping;c.Texture.prototype={constructor:c.Texture,set needsUpdate(a){!0===a&&this.version++},clone:function(){return(new this.constructor).copy(this)},
copy:function(a){this.image=a.image;this.mipmaps=a.mipmaps.slice(0);this.mapping=a.mapping;this.wrapS=a.wrapS;this.wrapT=a.wrapT;this.magFilter=a.magFilter;this.minFilter=a.minFilter;this.anisotropy=a.anisotropy;this.format=a.format;this.type=a.type;this.offset.copy(a.offset);this.repeat.copy(a.repeat);this.generateMipmaps=a.generateMipmaps;this.premultiplyAlpha=a.premultiplyAlpha;this.flipY=a.flipY;this.unpackAlignment=a.unpackAlignment;this.encoding=a.encoding;return this},toJSON:function(a){if(void 0!==
a.textures[this.uuid])return a.textures[this.uuid];var b={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy};if(void 0!==this.image){var d=this.image;void 0===d.uuid&&(d.uuid=c.Math.generateUUID());if(void 0===a.images[d.uuid]){var e=a.images,f=d.uuid,g=d.uuid,
h;void 0!==d.toDataURL?h=d:(h=document.createElement("canvas"),h.width=d.width,h.height=d.height,h.getContext("2d").drawImage(d,0,0,d.width,d.height));h=2048<h.width||2048<h.height?h.toDataURL("image/jpeg",.6):h.toDataURL("image/png");e[f]={uuid:g,url:h}}b.image=d.uuid}return a.textures[this.uuid]=b},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(a){if(this.mapping===c.UVMapping){a.multiply(this.repeat);a.add(this.offset);if(0>a.x||1<a.x)switch(this.wrapS){case c.RepeatWrapping:a.x-=
Math.floor(a.x);break;case c.ClampToEdgeWrapping:a.x=0>a.x?0:1;break;case c.MirroredRepeatWrapping:1===Math.abs(Math.floor(a.x)%2)?a.x=Math.ceil(a.x)-a.x:a.x-=Math.floor(a.x)}if(0>a.y||1<a.y)switch(this.wrapT){case c.RepeatWrapping:a.y-=Math.floor(a.y);break;case c.ClampToEdgeWrapping:a.y=0>a.y?0:1;break;case c.MirroredRepeatWrapping:1===Math.abs(Math.floor(a.y)%2)?a.y=Math.ceil(a.y)-a.y:a.y-=Math.floor(a.y)}this.flipY&&(a.y=1-a.y)}}};c.EventDispatcher.prototype.apply(c.Texture.prototype);c.TextureIdCount=
0;c.CompressedTexture=function(a,b,d,e,f,g,h,n,q,p,u,s){c.Texture.call(this,null,g,h,n,q,p,e,f,u,s);this.image={width:b,height:d};this.mipmaps=a;this.generateMipmaps=this.flipY=!1};c.CompressedTexture.prototype=Object.create(c.Texture.prototype);c.CompressedTexture.prototype.constructor=c.CompressedTexture;c.DataTexture=function(a,b,d,e,f,g,h,n,q,p,u,s){c.Texture.call(this,null,g,h,n,q,p,e,f,u,s);this.image={data:a,width:b,height:d};this.magFilter=void 0!==q?q:c.NearestFilter;this.minFilter=void 0!==
p?p:c.NearestFilter;this.generateMipmaps=this.flipY=!1};c.DataTexture.prototype=Object.create(c.Texture.prototype);c.DataTexture.prototype.constructor=c.DataTexture;c.Line=function(a,b,d){if(1===d)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new c.LineSegments(a,b);c.Object3D.call(this);this.type="Line";this.geometry=void 0!==a?a:new c.Geometry;this.material=void 0!==b?b:new c.LineBasicMaterial({color:16777215*Math.random()})};
c.Line.prototype=Object.create(c.Object3D.prototype);c.Line.prototype.constructor=c.Line;c.Line.prototype.raycast=function(){var a=new c.Matrix4,b=new c.Ray,d=new c.Sphere;return function(e,f){var g=e.linePrecision,g=g*g,h=this.geometry,n=this.matrixWorld;null===h.boundingSphere&&h.computeBoundingSphere();d.copy(h.boundingSphere);d.applyMatrix4(n);if(!1!==e.ray.intersectsSphere(d)){a.getInverse(n);b.copy(e.ray).applyMatrix4(a);var q=new c.Vector3,p=new c.Vector3,n=new c.Vector3,u=new c.Vector3,s=
this instanceof c.LineSegments?2:1;if(h instanceof c.BufferGeometry){var l=h.index,v=h.attributes.position.array;if(null!==l)for(var l=l.array,h=0,t=l.length-1;h<t;h+=s){var r=l[h+1];q.fromArray(v,3*l[h]);p.fromArray(v,3*r);r=b.distanceSqToSegment(q,p,u,n);r>g||(u.applyMatrix4(this.matrixWorld),r=e.ray.origin.distanceTo(u),r<e.near||r>e.far||f.push({distance:r,point:n.clone().applyMatrix4(this.matrixWorld),index:h,face:null,faceIndex:null,object:this}))}else for(h=0,t=v.length/3-1;h<t;h+=s)q.fromArray(v,
3*h),p.fromArray(v,3*h+3),r=b.distanceSqToSegment(q,p,u,n),r>g||(u.applyMatrix4(this.matrixWorld),r=e.ray.origin.distanceTo(u),r<e.near||r>e.far||f.push({distance:r,point:n.clone().applyMatrix4(this.matrixWorld),index:h,face:null,faceIndex:null,object:this}))}else if(h instanceof c.Geometry)for(q=h.vertices,p=q.length,h=0;h<p-1;h+=s)r=b.distanceSqToSegment(q[h],q[h+1],u,n),r>g||(u.applyMatrix4(this.matrixWorld),r=e.ray.origin.distanceTo(u),r<e.near||r>e.far||f.push({distance:r,point:n.clone().applyMatrix4(this.matrixWorld),
index:h,face:null,faceIndex:null,object:this}))}}}();c.Line.prototype.clone=function(){return(new this.constructor(this.geometry,this.material)).copy(this)};c.LineStrip=0;c.LinePieces=1;c.LineSegments=function(a,b){c.Line.call(this,a,b);this.type="LineSegments"};c.LineSegments.prototype=Object.create(c.Line.prototype);c.LineSegments.prototype.constructor=c.LineSegments;c.Mesh=function(a,b){c.Object3D.call(this);this.type="Mesh";this.geometry=void 0!==a?a:new c.Geometry;this.material=void 0!==b?b:
new c.MeshBasicMaterial({color:16777215*Math.random()});this.drawMode=c.TrianglesDrawMode;this.updateMorphTargets()};c.Mesh.prototype=Object.create(c.Object3D.prototype);c.Mesh.prototype.constructor=c.Mesh;c.Mesh.prototype.setDrawMode=function(a){this.drawMode=a};c.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&0<this.geometry.morphTargets.length){this.morphTargetBase=-1;this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var a=0,b=this.geometry.morphTargets.length;a<
b;a++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[a].name]=a}};c.Mesh.prototype.getMorphTargetIndexByName=function(a){if(void 0!==this.morphTargetDictionary[a])return this.morphTargetDictionary[a];console.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+a+" does not exist. Returning 0.");return 0};c.Mesh.prototype.raycast=function(){function a(a,b,d,e,f,g,h){c.Triangle.barycoordFromPoint(a,b,d,e,r);f.multiplyScalar(r.x);g.multiplyScalar(r.y);
h.multiplyScalar(r.z);f.add(g).add(h);return f.clone()}function b(a,b,d,e,f,g,h){var k=a.material;if(null===(k.side===c.BackSide?d.intersectTriangle(g,f,e,!0,h):d.intersectTriangle(e,f,g,k.side!==c.DoubleSide,h)))return null;z.copy(h);z.applyMatrix4(a.matrixWorld);d=b.ray.origin.distanceTo(z);return d<b.near||d>b.far?null:{distance:d,point:z.clone(),object:a}}function d(d,e,f,g,k,p,r,s){h.fromArray(g,3*p);n.fromArray(g,3*r);q.fromArray(g,3*s);if(d=b(d,e,f,h,n,q,D))k&&(l.fromArray(k,2*p),v.fromArray(k,
2*r),t.fromArray(k,2*s),d.uv=a(D,h,n,q,l,v,t)),d.face=new c.Face3(p,r,s,c.Triangle.normal(h,n,q)),d.faceIndex=p;return d}var e=new c.Matrix4,f=new c.Ray,g=new c.Sphere,h=new c.Vector3,n=new c.Vector3,q=new c.Vector3,p=new c.Vector3,u=new c.Vector3,s=new c.Vector3,l=new c.Vector2,v=new c.Vector2,t=new c.Vector2,r=new c.Vector3,D=new c.Vector3,z=new c.Vector3;return function(r,z){var B=this.geometry,C=this.material,F=this.matrixWorld;if(void 0!==C&&(null===B.boundingSphere&&B.computeBoundingSphere(),
g.copy(B.boundingSphere),g.applyMatrix4(F),!1!==r.ray.intersectsSphere(g)&&(e.getInverse(F),f.copy(r.ray).applyMatrix4(e),null===B.boundingBox||!1!==f.intersectsBox(B.boundingBox)))){var H,G;if(B instanceof c.BufferGeometry){var K,O,C=B.index,F=B.attributes,B=F.position.array;void 0!==F.uv&&(H=F.uv.array);if(null!==C)for(var F=C.array,P=0,N=F.length;P<N;P+=3){if(C=F[P],K=F[P+1],O=F[P+2],G=d(this,r,f,B,H,C,K,O))G.faceIndex=Math.floor(P/3),z.push(G)}else for(P=0,N=B.length;P<N;P+=9)if(C=P/3,K=C+1,O=
C+2,G=d(this,r,f,B,H,C,K,O))G.index=C,z.push(G)}else if(B instanceof c.Geometry){var A,L,F=C instanceof c.MultiMaterial,P=!0===F?C.materials:null,N=B.vertices;K=B.faces;O=B.faceVertexUvs[0];0<O.length&&(H=O);for(var T=0,Y=K.length;T<Y;T++){var U=K[T];G=!0===F?P[U.materialIndex]:C;if(void 0!==G){O=N[U.a];A=N[U.b];L=N[U.c];if(!0===G.morphTargets){G=B.morphTargets;var I=this.morphTargetInfluences;h.set(0,0,0);n.set(0,0,0);q.set(0,0,0);for(var Z=0,Q=G.length;Z<Q;Z++){var J=I[Z];if(0!==J){var S=G[Z].vertices;
h.addScaledVector(p.subVectors(S[U.a],O),J);n.addScaledVector(u.subVectors(S[U.b],A),J);q.addScaledVector(s.subVectors(S[U.c],L),J)}}h.add(O);n.add(A);q.add(L);O=h;A=n;L=q}if(G=b(this,r,f,O,A,L,D))H&&(I=H[T],l.copy(I[0]),v.copy(I[1]),t.copy(I[2]),G.uv=a(D,O,A,L,l,v,t)),G.face=U,G.faceIndex=T,z.push(G)}}}}}}();c.Mesh.prototype.clone=function(){return(new this.constructor(this.geometry,this.material)).copy(this)};c.Sprite=function(){var a=new Uint16Array([0,1,2,0,2,3]),b=new Float32Array([-.5,-.5,0,
.5,-.5,0,.5,.5,0,-.5,.5,0]),d=new Float32Array([0,0,1,0,1,1,0,1]),e=new c.BufferGeometry;e.setIndex(new c.BufferAttribute(a,1));e.addAttribute("position",new c.BufferAttribute(b,3));e.addAttribute("uv",new c.BufferAttribute(d,2));return function(a){c.Object3D.call(this);this.type="Sprite";this.geometry=e;this.material=void 0!==a?a:new c.SpriteMaterial}}();c.Sprite.prototype=Object.create(c.Object3D.prototype);c.Sprite.prototype.constructor=c.Sprite;c.Sprite.prototype.raycast=function(){var a=new c.Vector3;
return function(b,c){a.setFromMatrixPosition(this.matrixWorld);var e=b.ray.distanceSqToPoint(a);e>this.scale.x*this.scale.y/4||c.push({distance:Math.sqrt(e),point:this.position,face:null,object:this})}}();c.Sprite.prototype.clone=function(){return(new this.constructor(this.material)).copy(this)};c.Particle=c.Sprite;c.Scene=function(){c.Object3D.call(this);this.type="Scene";this.overrideMaterial=this.fog=null;this.autoUpdate=!0};c.Scene.prototype=Object.create(c.Object3D.prototype);c.Scene.prototype.constructor=
c.Scene;c.Scene.prototype.copy=function(a,b){c.Object3D.prototype.copy.call(this,a,b);null!==a.fog&&(this.fog=a.fog.clone());null!==a.overrideMaterial&&(this.overrideMaterial=a.overrideMaterial.clone());this.autoUpdate=a.autoUpdate;this.matrixAutoUpdate=a.matrixAutoUpdate;return this};c.RenderableObject=function(){this.id=0;this.object=null;this.renderOrder=this.z=0};c.RenderableFace=function(){this.id=0;this.v1=new c.RenderableVertex;this.v2=new c.RenderableVertex;this.v3=new c.RenderableVertex;
this.normalModel=new c.Vector3;this.vertexNormalsModel=[new c.Vector3,new c.Vector3,new c.Vector3];this.vertexNormalsLength=0;this.color=new c.Color;this.material=null;this.uvs=[new c.Vector2,new c.Vector2,new c.Vector2];this.renderOrder=this.z=0};c.RenderableVertex=function(){this.position=new c.Vector3;this.positionWorld=new c.Vector3;this.positionScreen=new c.Vector4;this.visible=!0};c.RenderableVertex.prototype.copy=function(a){this.positionWorld.copy(a.positionWorld);this.positionScreen.copy(a.positionScreen)};
c.RenderableLine=function(){this.id=0;this.v1=new c.RenderableVertex;this.v2=new c.RenderableVertex;this.vertexColors=[new c.Color,new c.Color];this.material=null;this.renderOrder=this.z=0};c.RenderableSprite=function(){this.id=0;this.object=null;this.rotation=this.z=this.y=this.x=0;this.scale=new c.Vector2;this.material=null;this.renderOrder=0};c.Projector=function(){function a(){if(s===v){var a=new c.RenderableVertex;l.push(a);v++;s++;return a}return l[s++]}function b(){if(r===z){var a=new c.RenderableFace;
D.push(a);z++;r++;return a}return D[r++]}function d(){if(E===C){var a=new c.RenderableLine;B.push(a);C++;E++;return a}return B[E++]}function e(){if(H===K){var a=new c.RenderableSprite;G.push(a);K++;H++;return a}return G[H++]}function f(a,b){return a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?b.z-a.z:a.id!==b.id?a.id-b.id:0}function g(a,b){var c=0,d=1,e=a.z+a.w,f=b.z+b.w,h=-a.z+a.w,k=-b.z+b.w;if(0<=e&&0<=f&&0<=h&&0<=k)return!0;if(0>e&&0>f||0>h&&0>k)return!1;0>e?c=Math.max(c,
e/(e-f)):0>f&&(d=Math.min(d,e/(e-f)));0>h?c=Math.max(c,h/(h-k)):0>k&&(d=Math.min(d,h/(h-k)));if(d<c)return!1;a.lerp(b,c);b.lerp(a,1-d);return!0}var h,n,q=[],p=0,u,s,l=[],v=0,t,r,D=[],z=0,y,E,B=[],C=0,F,H,G=[],K=0,O={objects:[],lights:[],elements:[]},P=new c.Vector3,N=new c.Vector4,A=new c.Box3(new c.Vector3(-1,-1,-1),new c.Vector3(1,1,1)),L=new c.Box3,T=Array(3),Y=new c.Matrix4,U=new c.Matrix4,I,Z=new c.Matrix4,J=new c.Matrix3,Q=new c.Frustum,S=new c.Vector4,ha=new c.Vector4;this.projectVector=function(a,
b){console.warn("THREE.Projector: .projectVector() is now vector.project().");a.project(b)};this.unprojectVector=function(a,b){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject().");a.unproject(b)};this.pickingRay=function(a,b){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")};var $=new function(){function e(a){var b=a.positionWorld,c=a.positionScreen;b.copy(a.position).applyMatrix4(I);c.copy(b).applyMatrix4(U);b=1/c.w;c.x*=b;c.y*=b;c.z*=b;
a.visible=-1<=c.x&&1>=c.x&&-1<=c.y&&1>=c.y&&-1<=c.z&&1>=c.z}function f(a,b,c){if(!0===a.visible||!0===b.visible||!0===c.visible)return!0;T[0]=a.positionScreen;T[1]=b.positionScreen;T[2]=c.positionScreen;return A.intersectsBox(L.setFromPoints(T))}function g(a,b,c){return 0>(c.positionScreen.x-a.positionScreen.x)*(b.positionScreen.y-a.positionScreen.y)-(c.positionScreen.y-a.positionScreen.y)*(b.positionScreen.x-a.positionScreen.x)}var h=[],k=[],m=null,p=null,n=new c.Matrix3;return{setObject:function(a){m=
a;p=m.material;n.getNormalMatrix(m.matrixWorld);h.length=0;k.length=0},projectVertex:e,checkTriangleVisibility:f,checkBackfaceCulling:g,pushVertex:function(b,c,d){u=a();u.position.set(b,c,d);e(u)},pushNormal:function(a,b,c){h.push(a,b,c)},pushUv:function(a,b){k.push(a,b)},pushLine:function(a,b){var c=l[a],e=l[b];y=d();y.id=m.id;y.v1.copy(c);y.v2.copy(e);y.z=(c.positionScreen.z+e.positionScreen.z)/2;y.renderOrder=m.renderOrder;y.material=m.material;O.elements.push(y)},pushTriangle:function(a,d,e){var r=
l[a],q=l[d],s=l[e];if(!1!==f(r,q,s)&&(p.side===c.DoubleSide||!0===g(r,q,s))){t=b();t.id=m.id;t.v1.copy(r);t.v2.copy(q);t.v3.copy(s);t.z=(r.positionScreen.z+q.positionScreen.z+s.positionScreen.z)/3;t.renderOrder=m.renderOrder;t.normalModel.fromArray(h,3*a);t.normalModel.applyMatrix3(n).normalize();for(r=0;3>r;r++)q=t.vertexNormalsModel[r],q.fromArray(h,3*arguments[r]),q.applyMatrix3(n).normalize(),t.uvs[r].fromArray(k,2*arguments[r]);t.vertexNormalsLength=3;t.material=m.material;O.elements.push(t)}}}};
this.projectScene=function(v,u,z,B){H=E=r=0;O.elements.length=0;!0===v.autoUpdate&&v.updateMatrixWorld();null===u.parent&&u.updateMatrixWorld();Y.copy(u.matrixWorldInverse.getInverse(u.matrixWorld));U.multiplyMatrices(u.projectionMatrix,Y);Q.setFromMatrix(U);n=0;O.objects.length=0;O.lights.length=0;v.traverseVisible(function(a){if(a instanceof c.Light)O.lights.push(a);else if((a instanceof c.Mesh||a instanceof c.Line||a instanceof c.Sprite)&&!1!==a.material.visible&&(!1===a.frustumCulled||!0===Q.intersectsObject(a))){if(n===
p){var b=new c.RenderableObject;q.push(b);p++;n++;h=b}else h=q[n++];h.id=a.id;h.object=a;P.setFromMatrixPosition(a.matrixWorld);P.applyProjection(U);h.z=P.z;h.renderOrder=a.renderOrder;O.objects.push(h)}});!0===z&&O.objects.sort(f);v=0;for(z=O.objects.length;v<z;v++){var C=O.objects[v].object,A=C.geometry;$.setObject(C);I=C.matrixWorld;s=0;if(C instanceof c.Mesh)if(A instanceof c.BufferGeometry){var D=A.attributes,C=A.groups;if(void 0!==D.position){for(var G=D.position.array,M=0,K=G.length;M<K;M+=
3)$.pushVertex(G[M],G[M+1],G[M+2]);if(void 0!==D.normal)for(var T=D.normal.array,M=0,K=T.length;M<K;M+=3)$.pushNormal(T[M],T[M+1],T[M+2]);if(void 0!==D.uv)for(D=D.uv.array,M=0,K=D.length;M<K;M+=2)$.pushUv(D[M],D[M+1]);if(null!==A.index)if(G=A.index.array,0<C.length)for(v=0;v<C.length;v++)for(K=C[v],M=K.start,K=K.start+K.count;M<K;M+=3)$.pushTriangle(G[M],G[M+1],G[M+2]);else for(M=0,K=G.length;M<K;M+=3)$.pushTriangle(G[M],G[M+1],G[M+2]);else for(M=0,K=G.length/3;M<K;M+=3)$.pushTriangle(M,M+1,M+2)}}else{if(A instanceof
c.Geometry){var L=A.vertices,M=A.faces,K=A.faceVertexUvs[0];J.getNormalMatrix(I);for(var G=C.material,D=G instanceof c.MultiMaterial,T=!0===D?C.material:null,ba=0,R=L.length;ba<R;ba++){var ga=L[ba];P.copy(ga);if(!0===G.morphTargets)for(var oa=A.morphTargets,X=C.morphTargetInfluences,aa=0,wa=oa.length;aa<wa;aa++){var ea=X[aa];if(0!==ea){var ca=oa[aa].vertices[ba];P.x+=(ca.x-ga.x)*ea;P.y+=(ca.y-ga.y)*ea;P.z+=(ca.z-ga.z)*ea}}$.pushVertex(P.x,P.y,P.z)}L=0;for(ba=M.length;L<ba;L++)if(R=M[L],G=!0===D?T.materials[R.materialIndex]:
C.material,void 0!==G&&(X=G.side,A=l[R.a],ga=l[R.b],oa=l[R.c],!1!==$.checkTriangleVisibility(A,ga,oa))){aa=$.checkBackfaceCulling(A,ga,oa);if(X!==c.DoubleSide){if(X===c.FrontSide&&!1===aa)continue;if(X===c.BackSide&&!0===aa)continue}t=b();t.id=C.id;t.v1.copy(A);t.v2.copy(ga);t.v3.copy(oa);t.normalModel.copy(R.normal);!1!==aa||X!==c.BackSide&&X!==c.DoubleSide||t.normalModel.negate();t.normalModel.applyMatrix3(J).normalize();wa=R.vertexNormals;ea=0;for(ca=Math.min(wa.length,3);ea<ca;ea++){var V=t.vertexNormalsModel[ea];
V.copy(wa[ea]);!1!==aa||X!==c.BackSide&&X!==c.DoubleSide||V.negate();V.applyMatrix3(J).normalize()}t.vertexNormalsLength=wa.length;X=K[L];if(void 0!==X)for(aa=0;3>aa;aa++)t.uvs[aa].copy(X[aa]);t.color=R.color;t.material=G;t.z=(A.positionScreen.z+ga.positionScreen.z+oa.positionScreen.z)/3;t.renderOrder=C.renderOrder;O.elements.push(t)}}}else if(C instanceof c.Line)if(A instanceof c.BufferGeometry){if(D=A.attributes,void 0!==D.position){G=D.position.array;M=0;for(K=G.length;M<K;M+=3)$.pushVertex(G[M],
G[M+1],G[M+2]);if(null!==A.index)for(G=A.index.array,M=0,K=G.length;M<K;M+=2)$.pushLine(G[M],G[M+1]);else for(D=C instanceof c.LineSegments?2:1,M=0,K=G.length/3-1;M<K;M+=D)$.pushLine(M,M+1)}}else{if(A instanceof c.Geometry&&(Z.multiplyMatrices(U,I),L=C.geometry.vertices,0!==L.length))for(A=a(),A.positionScreen.copy(L[0]).applyMatrix4(Z),D=C instanceof c.LineSegments?2:1,ba=1,R=L.length;ba<R;ba++)A=a(),A.positionScreen.copy(L[ba]).applyMatrix4(Z),0<(ba+1)%D||(ga=l[s-2],S.copy(A.positionScreen),ha.copy(ga.positionScreen),
!0===g(S,ha)&&(S.multiplyScalar(1/S.w),ha.multiplyScalar(1/ha.w),y=d(),y.id=C.id,y.v1.positionScreen.copy(S),y.v2.positionScreen.copy(ha),y.z=Math.max(S.z,ha.z),y.renderOrder=C.renderOrder,y.material=C.material,C.material.vertexColors===c.VertexColors&&(y.vertexColors[0].copy(C.geometry.colors[ba]),y.vertexColors[1].copy(C.geometry.colors[ba-1])),O.elements.push(y)))}else C instanceof c.Sprite&&(N.set(I.elements[12],I.elements[13],I.elements[14],1),N.applyMatrix4(U),M=1/N.w,N.z*=M,-1<=N.z&&1>=N.z&&
(F=e(),F.id=C.id,F.x=N.x*M,F.y=N.y*M,F.z=N.z,F.renderOrder=C.renderOrder,F.object=C,F.rotation=C.rotation,F.scale.x=C.scale.x*Math.abs(F.x-(N.x+u.projectionMatrix.elements[0])/(N.w+u.projectionMatrix.elements[12])),F.scale.y=C.scale.y*Math.abs(F.y-(N.y+u.projectionMatrix.elements[5])/(N.w+u.projectionMatrix.elements[13])),F.material=C.material,O.elements.push(F)))}!0===B&&O.elements.sort(f);return O}};c.SpriteCanvasMaterial=function(a){c.Material.call(this);this.type="SpriteCanvasMaterial";this.color=
new c.Color(16777215);this.program=function(a,c){};this.setValues(a)};c.SpriteCanvasMaterial.prototype=Object.create(c.Material.prototype);c.SpriteCanvasMaterial.prototype.constructor=c.SpriteCanvasMaterial;c.SpriteCanvasMaterial.prototype.clone=function(){var a=new c.SpriteCanvasMaterial;a.copy(this);a.color.copy(this.color);a.program=this.program;return a};c.CanvasRenderer=function(a){function b(a,b,c,d){q(b);p(c);u(d);s(a.getStyle());A.stroke();fa.expandByScalar(2*b)}function d(a){l(a.getStyle());
A.fill()}function e(a){if(0===a.version||a instanceof c.CompressedTexture||a instanceof c.DataTexture)return{canvas:void 0,version:a.version};var b=a.image;if(!1===b.complete)return{canvas:void 0,version:0};var d=document.createElement("canvas");d.width=b.width;d.height=b.height;var e=d.getContext("2d");e.setTransform(1,0,0,-1,0,b.height);e.drawImage(b,0,0);var b=a.wrapS===c.RepeatWrapping,e=a.wrapT===c.RepeatWrapping,f="no-repeat";!0===b&&!0===e?f="repeat":!0===b?f="repeat-x":!0===e&&(f="repeat-y");
d=A.createPattern(d,f);if(a.onUpdate)a.onUpdate(a);return{canvas:d,version:a.version}}function f(a,b,c,d,f,g,h,k,m,p,n,r,q){var t=ba[q.id];if(void 0===t||t.version!==q.version)t=e(q),ba[q.id]=t;if(void 0!==t.canvas){l(t.canvas);var t=q.offset.x/q.repeat.x,s=q.offset.y/q.repeat.y,v=q.image.width*q.repeat.x;q=q.image.height*q.repeat.y;h=(h+t)*v;k=(k+s)*q;c-=a;d-=b;f-=a;g-=b;m=(m+t)*v-h;p=(p+s)*q-k;n=(n+t)*v-h;r=(r+s)*q-k;q=m*r-n*p;0!==q&&(t=1/q,q=(r*c-p*f)*t,p=(r*d-p*g)*t,c=(m*f-n*c)*t,d=(m*g-n*d)*
t,a=a-q*h-c*k,b=b-p*h-d*k,A.save(),A.transform(q,p,c,d,a,b),A.fill(),A.restore())}else l("rgba( 0, 0, 0, 1)"),A.fill()}function g(a,b,c){var d=b.x-a.x,e=b.y-a.y,f=d*d+e*e;0!==f&&(c/=Math.sqrt(f),d*=c,e*=c,b.x+=d,b.y+=e,a.x-=d,a.y-=e)}function h(a){Y!==a&&(Y=A.globalAlpha=a)}function n(a){U!==a&&(a===c.NormalBlending?A.globalCompositeOperation="source-over":a===c.AdditiveBlending?A.globalCompositeOperation="lighter":a===c.SubtractiveBlending&&(A.globalCompositeOperation="darker"),U=a)}function q(a){J!==
a&&(J=A.lineWidth=a)}function p(a){S!==a&&(S=A.lineCap=a)}function u(a){Q!==a&&(Q=A.lineJoin=a)}function s(a){I!==a&&(I=A.strokeStyle=a)}function l(a){Z!==a&&(Z=A.fillStyle=a)}function v(a){ha.length!==a.length&&(A.setLineDash(a),ha=a)}console.log("THREE.CanvasRenderer",c.REVISION);a=a||{};var t=this,r,D,z,y=new c.Projector,E=void 0!==a.canvas?a.canvas:document.createElement("canvas"),B=E.width,C=E.height,F=Math.floor(B/2),H=Math.floor(C/2),G=0,K=0,O=B,P=C,N=1,A=E.getContext("2d",{alpha:!0===a.alpha}),
L=new c.Color(0),T=!0===a.alpha?0:1,Y=1,U=0,I=null,Z=null,J=null,S=null,Q=null,ha=[],$,da,ka;new c.RenderableVertex;new c.RenderableVertex;var ta,la,xa,ua,ya,za,M=new c.Color;new c.Color;new c.Color;new c.Color;new c.Color;var va=new c.Color,Fa=new c.Color,La=new c.Color,ba={},R,ga,oa,X,aa,wa,ea,ca=new c.Box2,V=new c.Box2,fa=new c.Box2,Aa=new c.Color,pa=new c.Color,Ba=new c.Color,Ga=new c.Vector3,Oa=new c.Vector3,ja=new c.Vector3,ra=new c.Matrix3;void 0===A.setLineDash&&(A.setLineDash=function(){});
this.domElement=E;this.sortElements=this.sortObjects=this.autoClear=!0;this.info={render:{vertices:0,faces:0}};this.supportsVertexTextures=function(){};this.setFaceCulling=function(){};this.getContext=function(){return A};this.getContextAttributes=function(){return A.getContextAttributes()};this.getPixelRatio=function(){return N};this.setPixelRatio=function(a){void 0!==a&&(N=a)};this.setSize=function(a,b,c){B=a*N;C=b*N;E.width=B;E.height=C;F=Math.floor(B/2);H=Math.floor(C/2);!1!==c&&(E.style.width=
a+"px",E.style.height=b+"px");ca.min.set(-F,-H);ca.max.set(F,H);V.min.set(-F,-H);V.max.set(F,H);Y=1;U=0;Q=S=J=Z=I=null;this.setViewport(0,0,a,b)};this.setViewport=function(a,b,c,d){G=a*N;K=b*N;O=c*N;P=d*N};this.setScissor=function(){};this.setScissorTest=function(){};this.setClearColor=function(a,b){L.set(a);T=void 0!==b?b:1;V.min.set(-F,-H);V.max.set(F,H)};this.setClearColorHex=function(a,b){console.warn("THREE.CanvasRenderer: .setClearColorHex() is being removed. Use .setClearColor() instead.");
this.setClearColor(a,b)};this.getClearColor=function(){return L};this.getClearAlpha=function(){return T};this.getMaxAnisotropy=function(){return 0};this.clear=function(){!1===V.isEmpty()&&(V.intersect(ca),V.expandByScalar(2),V.min.x+=F,V.min.y=-V.min.y+H,V.max.x+=F,V.max.y=-V.max.y+H,1>T&&A.clearRect(V.min.x|0,V.max.y|0,V.max.x-V.min.x|0,V.min.y-V.max.y|0),0<T&&(n(c.NormalBlending),h(1),l("rgba("+Math.floor(255*L.r)+","+Math.floor(255*L.g)+","+Math.floor(255*L.b)+","+T+")"),A.fillRect(V.min.x|0,V.max.y|
0,V.max.x-V.min.x|0,V.min.y-V.max.y|0)),V.makeEmpty())};this.clearColor=function(){};this.clearDepth=function(){};this.clearStencil=function(){};this.render=function(a,U){if(!1===U instanceof c.Camera)console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");else{!0===this.autoClear&&this.clear();t.info.render.vertices=0;t.info.render.faces=0;A.setTransform(O/B,0,0,-P/C,G,C-K);A.translate(F,H);r=y.projectScene(a,U,this.sortObjects,this.sortElements);D=r.elements;z=r.lights;
ra.getNormalMatrix(U.matrixWorldInverse);Aa.setRGB(0,0,0);pa.setRGB(0,0,0);Ba.setRGB(0,0,0);for(var E=0,N=z.length;E<N;E++){var I=z[E],L=I.color;I instanceof c.AmbientLight?Aa.add(L):I instanceof c.DirectionalLight?pa.add(L):I instanceof c.PointLight&&Ba.add(L)}E=0;for(N=D.length;E<N;E++){var W=D[E],T=W.material;if(void 0!==T&&0!==T.opacity){fa.makeEmpty();if(W instanceof c.RenderableSprite){$=W;$.x*=F;$.y*=H;var I=$,J=W,L=T;h(L.opacity);n(L.blending);var S=J.scale.x*F,J=J.scale.y*H,W=.5*Math.sqrt(S*
S+J*J);fa.min.set(I.x-W,I.y-W);fa.max.set(I.x+W,I.y+W);if(L instanceof c.SpriteMaterial){var Z=L.map;if(null!==Z){W=ba[Z.id];if(void 0===W||W.version!==Z.version)W=e(Z),ba[Z.id]=W;if(void 0!==W.canvas){l(W.canvas);var Q=Z.image,W=Q.width*Z.offset.x,T=Q.height*Z.offset.y,Y=Q.width*Z.repeat.x,Z=Q.height*Z.repeat.y,Q=S/Y,ha=J/Z;A.save();A.translate(I.x,I.y);0!==L.rotation&&A.rotate(L.rotation);A.translate(-S/2,-J/2);A.scale(Q,ha);A.translate(-W,-T);A.fillRect(W,T,Y,Z);A.restore()}}else l(L.color.getStyle()),
A.save(),A.translate(I.x,I.y),0!==L.rotation&&A.rotate(L.rotation),A.scale(S,-J),A.fillRect(-.5,-.5,1,1),A.restore()}else L instanceof c.SpriteCanvasMaterial&&(s(L.color.getStyle()),l(L.color.getStyle()),A.save(),A.translate(I.x,I.y),0!==L.rotation&&A.rotate(L.rotation),A.scale(S,J),L.program(A),A.restore())}else if(W instanceof c.RenderableLine){if($=W.v1,da=W.v2,$.positionScreen.x*=F,$.positionScreen.y*=H,da.positionScreen.x*=F,da.positionScreen.y*=H,fa.setFromPoints([$.positionScreen,da.positionScreen]),
!0===ca.intersectsBox(fa))if(I=$,L=da,S=W,J=T,h(J.opacity),n(J.blending),A.beginPath(),A.moveTo(I.positionScreen.x,I.positionScreen.y),A.lineTo(L.positionScreen.x,L.positionScreen.y),J instanceof c.LineBasicMaterial){q(J.linewidth);p(J.linecap);u(J.linejoin);if(J.vertexColors!==c.VertexColors)s(J.color.getStyle());else if(W=S.vertexColors[0].getStyle(),S=S.vertexColors[1].getStyle(),W===S)s(W);else{try{var ia=A.createLinearGradient(I.positionScreen.x,I.positionScreen.y,L.positionScreen.x,L.positionScreen.y);
ia.addColorStop(0,W);ia.addColorStop(1,S)}catch(ma){ia=W}s(ia)}A.stroke();fa.expandByScalar(2*J.linewidth)}else J instanceof c.LineDashedMaterial&&(q(J.linewidth),p(J.linecap),u(J.linejoin),s(J.color.getStyle()),v([J.dashSize,J.gapSize]),A.stroke(),fa.expandByScalar(2*J.linewidth),v([]))}else if(W instanceof c.RenderableFace){$=W.v1;da=W.v2;ka=W.v3;if(-1>$.positionScreen.z||1<$.positionScreen.z)continue;if(-1>da.positionScreen.z||1<da.positionScreen.z)continue;if(-1>ka.positionScreen.z||1<ka.positionScreen.z)continue;
$.positionScreen.x*=F;$.positionScreen.y*=H;da.positionScreen.x*=F;da.positionScreen.y*=H;ka.positionScreen.x*=F;ka.positionScreen.y*=H;0<T.overdraw&&(g($.positionScreen,da.positionScreen,T.overdraw),g(da.positionScreen,ka.positionScreen,T.overdraw),g(ka.positionScreen,$.positionScreen,T.overdraw));fa.setFromPoints([$.positionScreen,da.positionScreen,ka.positionScreen]);if(!0===ca.intersectsBox(fa)){L=$;S=da;J=ka;I=T;t.info.render.vertices+=3;t.info.render.faces++;h(I.opacity);n(I.blending);ta=L.positionScreen.x;
la=L.positionScreen.y;xa=S.positionScreen.x;ua=S.positionScreen.y;ya=J.positionScreen.x;za=J.positionScreen.y;var T=ta,Y=la,Z=xa,Q=ua,ha=ya,Ca=za;A.beginPath();A.moveTo(T,Y);A.lineTo(Z,Q);A.lineTo(ha,Ca);A.closePath();if((I instanceof c.MeshLambertMaterial||I instanceof c.MeshPhongMaterial)&&null===I.map){va.copy(I.color);Fa.copy(I.emissive);I.vertexColors===c.FaceColors&&va.multiply(W.color);M.copy(Aa);Oa.copy(L.positionWorld).add(S.positionWorld).add(J.positionWorld).divideScalar(3);L=Oa;S=W.normalModel;
J=M;W=0;for(T=z.length;W<T;W++)Y=z[W],La.copy(Y.color),Y instanceof c.DirectionalLight?(Z=Ga.setFromMatrixPosition(Y.matrixWorld).normalize(),Q=S.dot(Z),0>=Q||(Q*=Y.intensity,J.add(La.multiplyScalar(Q)))):Y instanceof c.PointLight&&(Z=Ga.setFromMatrixPosition(Y.matrixWorld),Q=S.dot(Ga.subVectors(Z,L).normalize()),0>=Q||(Q*=0==Y.distance?1:1-Math.min(L.distanceTo(Z)/Y.distance,1),0!=Q&&(Q*=Y.intensity,J.add(La.multiplyScalar(Q)))));M.multiply(va).add(Fa);!0===I.wireframe?b(M,I.wireframeLinewidth,I.wireframeLinecap,
I.wireframeLinejoin):d(M)}else I instanceof c.MeshBasicMaterial||I instanceof c.MeshLambertMaterial||I instanceof c.MeshPhongMaterial?null!==I.map?I.map.mapping===c.UVMapping&&(R=W.uvs,f(ta,la,xa,ua,ya,za,R[0].x,R[0].y,R[1].x,R[1].y,R[2].x,R[2].y,I.map)):null!==I.envMap?I.envMap.mapping===c.SphericalReflectionMapping&&(ja.copy(W.vertexNormalsModel[0]).applyMatrix3(ra),ga=.5*ja.x+.5,oa=.5*ja.y+.5,ja.copy(W.vertexNormalsModel[1]).applyMatrix3(ra),X=.5*ja.x+.5,aa=.5*ja.y+.5,ja.copy(W.vertexNormalsModel[2]).applyMatrix3(ra),
wa=.5*ja.x+.5,ea=.5*ja.y+.5,f(ta,la,xa,ua,ya,za,ga,oa,X,aa,wa,ea,I.envMap)):(M.copy(I.color),I.vertexColors===c.FaceColors&&M.multiply(W.color),!0===I.wireframe?b(M,I.wireframeLinewidth,I.wireframeLinecap,I.wireframeLinejoin):d(M)):(I instanceof c.MeshNormalMaterial?(ja.copy(W.normalModel).applyMatrix3(ra),M.setRGB(ja.x,ja.y,ja.z).multiplyScalar(.5).addScalar(.5)):M.setRGB(1,1,1),!0===I.wireframe?b(M,I.wireframeLinewidth,I.wireframeLinecap,I.wireframeLinejoin):d(M))}}V.union(fa)}}A.setTransform(1,
0,0,1,0,0)}}};c.TrackballControls=function(a,b){function d(a){!1!==l.enabled&&(window.removeEventListener("keydown",d),D=r,r===v.NONE)&&(a.keyCode!==l.keys[v.ROTATE]||l.noRotate?a.keyCode!==l.keys[v.ZOOM]||l.noZoom?a.keyCode!==l.keys[v.PAN]||l.noPan||(r=v.PAN):r=v.ZOOM:r=v.ROTATE)}function e(a){!1!==l.enabled&&(r=D,window.addEventListener("keydown",d,!1))}function f(a){!1!==l.enabled&&(a.preventDefault(),a.stopPropagation(),r===v.NONE&&(r=a.button),r!==v.ROTATE||l.noRotate?r!==v.ZOOM||l.noZoom?r!==
v.PAN||l.noPan||(O.copy(J(a.pageX,a.pageY)),P.copy(O)):(F.copy(J(a.pageX,a.pageY)),H.copy(F)):(E.copy(Q(a.pageX,a.pageY)),y.copy(E)),document.addEventListener("mousemove",g,!1),document.addEventListener("mouseup",h,!1),l.dispatchEvent(A))}function g(a){!1!==l.enabled&&(a.preventDefault(),a.stopPropagation(),r!==v.ROTATE||l.noRotate?r!==v.ZOOM||l.noZoom?r!==v.PAN||l.noPan||P.copy(J(a.pageX,a.pageY)):H.copy(J(a.pageX,a.pageY)):(y.copy(E),E.copy(Q(a.pageX,a.pageY))))}function h(a){!1!==l.enabled&&(a.preventDefault(),
a.stopPropagation(),r=v.NONE,document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",h),l.dispatchEvent(L))}function n(a){if(!1!==l.enabled){a.preventDefault();a.stopPropagation();var b=0;a.wheelDelta?b=a.wheelDelta/40:a.detail&&(b=-a.detail/3);F.y+=.01*b;l.dispatchEvent(A);l.dispatchEvent(L)}}function q(a){if(!1!==l.enabled){switch(a.touches.length){case 1:r=v.TOUCH_ROTATE;E.copy(Q(a.touches[0].pageX,a.touches[0].pageY));y.copy(E);break;default:r=v.TOUCH_ZOOM_PAN;var b=
a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY;K=G=Math.sqrt(b*b+c*c);O.copy(J((a.touches[0].pageX+a.touches[1].pageX)/2,(a.touches[0].pageY+a.touches[1].pageY)/2));P.copy(O)}l.dispatchEvent(A)}}function p(a){if(!1!==l.enabled)switch(a.preventDefault(),a.stopPropagation(),a.touches.length){case 1:y.copy(E);E.copy(Q(a.touches[0].pageX,a.touches[0].pageY));break;default:var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY;K=Math.sqrt(b*b+
c*c);P.copy(J((a.touches[0].pageX+a.touches[1].pageX)/2,(a.touches[0].pageY+a.touches[1].pageY)/2))}}function u(a){if(!1!==l.enabled){switch(a.touches.length){case 0:r=v.NONE;break;case 1:r=v.TOUCH_ROTATE,E.copy(Q(a.touches[0].pageX,a.touches[0].pageY)),y.copy(E)}l.dispatchEvent(L)}}function s(a){a.preventDefault()}var l=this,v={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=a;this.domElement=void 0!==b?b:document;this.enabled=!0;this.screen={left:0,top:0,width:0,height:0};
this.rotateSpeed=1;this.zoomSpeed=1.2;this.panSpeed=.3;this.staticMoving=this.noPan=this.noZoom=this.noRotate=!1;this.dynamicDampingFactor=.2;this.minDistance=0;this.maxDistance=Infinity;this.keys=[65,83,68];this.target=new c.Vector3;var t=new c.Vector3,r=v.NONE,D=v.NONE,z=new c.Vector3,y=new c.Vector2,E=new c.Vector2,B=new c.Vector3,C=0,F=new c.Vector2,H=new c.Vector2,G=0,K=0,O=new c.Vector2,P=new c.Vector2;this.target0=this.target.clone();this.position0=this.object.position.clone();this.up0=this.object.up.clone();
var N={type:"change"},A={type:"start"},L={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var a=this.domElement.getBoundingClientRect(),b=this.domElement.ownerDocument.documentElement;this.screen.left=a.left+window.pageXOffset-b.clientLeft;this.screen.top=a.top+window.pageYOffset-b.clientTop;this.screen.width=a.width;this.screen.height=a.height}};this.handleEvent=
function(a){if("function"==typeof this[a.type])this[a.type](a)};var J=function(){var a=new c.Vector2;return function(b,c){a.set((b-l.screen.left)/l.screen.width,(c-l.screen.top)/l.screen.height);return a}}(),Q=function(){var a=new c.Vector2;return function(b,c){a.set((b-.5*l.screen.width-l.screen.left)/(.5*l.screen.width),(l.screen.height+2*(l.screen.top-c))/l.screen.width);return a}}();this.rotateCamera=function(){var a=new c.Vector3,b=new c.Quaternion,d=new c.Vector3,e=new c.Vector3,f=new c.Vector3,
g=new c.Vector3,h;return function(){g.set(E.x-y.x,E.y-y.y,0);(h=g.length())?(z.copy(l.object.position).sub(l.target),d.copy(z).normalize(),e.copy(l.object.up).normalize(),f.crossVectors(e,d).normalize(),e.setLength(E.y-y.y),f.setLength(E.x-y.x),g.copy(e.add(f)),a.crossVectors(g,z).normalize(),h*=l.rotateSpeed,b.setFromAxisAngle(a,h),z.applyQuaternion(b),l.object.up.applyQuaternion(b),B.copy(a),C=h):!l.staticMoving&&C&&(C*=Math.sqrt(1-l.dynamicDampingFactor),z.copy(l.object.position).sub(l.target),
b.setFromAxisAngle(B,C),z.applyQuaternion(b),l.object.up.applyQuaternion(b));y.copy(E)}}();this.zoomCamera=function(){var a;r===v.TOUCH_ZOOM_PAN?(a=G/K,G=K,z.multiplyScalar(a)):(a=1+(H.y-F.y)*l.zoomSpeed,1!==a&&0<a&&(z.multiplyScalar(a),l.staticMoving?F.copy(H):F.y+=(H.y-F.y)*this.dynamicDampingFactor))};this.panCamera=function(){var a=new c.Vector2,b=new c.Vector3,d=new c.Vector3;return function(){a.copy(P).sub(O);a.lengthSq()&&(a.multiplyScalar(z.length()*l.panSpeed),d.copy(z).cross(l.object.up).setLength(a.x),
d.add(b.copy(l.object.up).setLength(a.y)),l.object.position.add(d),l.target.add(d),l.staticMoving?O.copy(P):O.add(a.subVectors(P,O).multiplyScalar(l.dynamicDampingFactor)))}}();this.checkDistances=function(){l.noZoom&&l.noPan||(z.lengthSq()>l.maxDistance*l.maxDistance&&(l.object.position.addVectors(l.target,z.setLength(l.maxDistance)),F.copy(H)),z.lengthSq()<l.minDistance*l.minDistance&&(l.object.position.addVectors(l.target,z.setLength(l.minDistance)),F.copy(H)))};this.update=function(){z.subVectors(l.object.position,
l.target);l.noRotate||l.rotateCamera();l.noZoom||l.zoomCamera();l.noPan||l.panCamera();l.object.position.addVectors(l.target,z);l.checkDistances();l.object.lookAt(l.target);1E-6<t.distanceToSquared(l.object.position)&&(l.dispatchEvent(N),t.copy(l.object.position))};this.reset=function(){D=r=v.NONE;l.target.copy(l.target0);l.object.position.copy(l.position0);l.object.up.copy(l.up0);z.subVectors(l.object.position,l.target);l.object.lookAt(l.target);l.dispatchEvent(N);t.copy(l.object.position)};this.dispose=
function(){this.domElement.removeEventListener("contextmenu",s,!1);this.domElement.removeEventListener("mousedown",f,!1);this.domElement.removeEventListener("mousewheel",n,!1);this.domElement.removeEventListener("MozMousePixelScroll",n,!1);this.domElement.removeEventListener("touchstart",q,!1);this.domElement.removeEventListener("touchend",u,!1);this.domElement.removeEventListener("touchmove",p,!1);document.removeEventListener("mousemove",g,!1);document.removeEventListener("mouseup",h,!1);window.removeEventListener("keydown",
d,!1);window.removeEventListener("keyup",e,!1)};this.domElement.addEventListener("contextmenu",s,!1);this.domElement.addEventListener("mousedown",f,!1);this.domElement.addEventListener("mousewheel",n,!1);this.domElement.addEventListener("MozMousePixelScroll",n,!1);this.domElement.addEventListener("touchstart",q,!1);this.domElement.addEventListener("touchend",u,!1);this.domElement.addEventListener("touchmove",p,!1);window.addEventListener("keydown",d,!1);window.addEventListener("keyup",e,!1);this.handleResize();
this.update()};c.TrackballControls.prototype=Object.create(c.EventDispatcher.prototype);c.TrackballControls.prototype.constructor=c.TrackballControls;c.SphereGeometry=function(a,b,d,e,f,g,h){c.Geometry.call(this);this.type="SphereGeometry";this.parameters={radius:a,widthSegments:b,heightSegments:d,phiStart:e,phiLength:f,thetaStart:g,thetaLength:h};this.fromBufferGeometry(new c.SphereBufferGeometry(a,b,d,e,f,g,h))};c.SphereGeometry.prototype=Object.create(c.Geometry.prototype);c.SphereGeometry.prototype.constructor=
c.SphereGeometry;c.SphereBufferGeometry=function(a,b,d,e,f,g,h){c.BufferGeometry.call(this);this.type="SphereBufferGeometry";this.parameters={radius:a,widthSegments:b,heightSegments:d,phiStart:e,phiLength:f,thetaStart:g,thetaLength:h};a=a||50;b=Math.max(3,Math.floor(b)||8);d=Math.max(2,Math.floor(d)||6);e=void 0!==e?e:0;f=void 0!==f?f:2*Math.PI;g=void 0!==g?g:0;h=void 0!==h?h:Math.PI;for(var n=g+h,q=(b+1)*(d+1),p=new c.BufferAttribute(new Float32Array(3*q),3),u=new c.BufferAttribute(new Float32Array(3*
q),3),q=new c.BufferAttribute(new Float32Array(2*q),2),s=0,l=[],v=new c.Vector3,t=0;t<=d;t++){for(var r=[],D=t/d,z=0;z<=b;z++){var y=z/b,E=-a*Math.cos(e+y*f)*Math.sin(g+D*h),B=a*Math.cos(g+D*h),C=a*Math.sin(e+y*f)*Math.sin(g+D*h);v.set(E,B,C).normalize();p.setXYZ(s,E,B,C);u.setXYZ(s,v.x,v.y,v.z);q.setXY(s,y,1-D);r.push(s);s++}l.push(r)}e=[];for(t=0;t<d;t++)for(z=0;z<b;z++)f=l[t][z+1],h=l[t][z],s=l[t+1][z],v=l[t+1][z+1],(0!==t||0<g)&&e.push(f,h,v),(t!==d-1||n<Math.PI)&&e.push(h,s,v);this.setIndex(new (65535<
p.count?c.Uint32Attribute:c.Uint16Attribute)(e,1));this.addAttribute("position",p);this.addAttribute("normal",u);this.addAttribute("uv",q);this.boundingSphere=new c.Sphere(new c.Vector3,a)};c.SphereBufferGeometry.prototype=Object.create(c.BufferGeometry.prototype);c.SphereBufferGeometry.prototype.constructor=c.SphereBufferGeometry;c.CylinderGeometry=function(a,b,d,e,f,g,h,n){c.Geometry.call(this);this.type="CylinderGeometry";this.parameters={radiusTop:a,radiusBottom:b,height:d,radialSegments:e,heightSegments:f,
openEnded:g,thetaStart:h,thetaLength:n};this.fromBufferGeometry(new c.CylinderBufferGeometry(a,b,d,e,f,g,h,n));this.mergeVertices()};c.CylinderGeometry.prototype=Object.create(c.Geometry.prototype);c.CylinderGeometry.prototype.constructor=c.CylinderGeometry;c.CylinderBufferGeometry=function(a,b,d,e,f,g,h,n){function q(d){var f,g,k;k=new c.Vector2;var s=new c.Vector3,u=0,x=!0===d?a:b,y=!0===d?1:-1;g=D;for(f=1;f<=e;f++)v.setXYZ(D,0,E*y,0),t.setXYZ(D,0,y,0),!0===d?(k.x=f/e,k.y=0):(k.x=(f-1)/e,k.y=1),
r.setXY(D,k.x,k.y),D++;k=D;for(f=0;f<=e;f++){var A=f/e;s.x=x*Math.sin(A*n+h);s.y=E*y;s.z=x*Math.cos(A*n+h);v.setXYZ(D,s.x,s.y,s.z);t.setXYZ(D,0,y,0);r.setXY(D,A,!0===d?1:0);D++}for(f=0;f<e;f++)s=g+f,x=k+f,!0===d?(l.setX(z,x),z++,l.setX(z,x+1)):(l.setX(z,x+1),z++,l.setX(z,x)),z++,l.setX(z,s),z++,u+=3;p.addGroup(B,u,!0===d?1:2);B+=u}c.BufferGeometry.call(this);this.type="CylinderBufferGeometry";this.parameters={radiusTop:a,radiusBottom:b,height:d,radialSegments:e,heightSegments:f,openEnded:g,thetaStart:h,
thetaLength:n};var p=this;a=void 0!==a?a:20;b=void 0!==b?b:20;d=void 0!==d?d:100;e=Math.floor(e)||8;f=Math.floor(f)||1;g=void 0!==g?g:!1;h=void 0!==h?h:0;n=void 0!==n?n:2*Math.PI;var u=function(){var a=(e+1)*(f+1);!1===g&&(a+=2*(e+1)+2*e);return a}(),s=function(){var a=e*f*6;!1===g&&(a+=6*e);return a}(),l=new c.BufferAttribute(new (65535<s?Uint32Array:Uint16Array)(s),1),v=new c.BufferAttribute(new Float32Array(3*u),3),t=new c.BufferAttribute(new Float32Array(3*u),3),r=new c.BufferAttribute(new Float32Array(2*
u),2),D=0,z=0,y=[],E=d/2,B=0;(function(){var g,k,q=new c.Vector3,s=new c.Vector3,u=0,x=(b-a)/d;for(k=0;k<=f;k++){var J=[],N=k/f,A=N*(b-a)+a;for(g=0;g<=e;g++){var L=g/e;s.x=A*Math.sin(L*n+h);s.y=-N*d+E;s.z=A*Math.cos(L*n+h);v.setXYZ(D,s.x,s.y,s.z);q.copy(s);if(0===a&&0===k||0===b&&k===f)q.x=Math.sin(L*n+h),q.z=Math.cos(L*n+h);q.setY(Math.sqrt(q.x*q.x+q.z*q.z)*x).normalize();t.setXYZ(D,q.x,q.y,q.z);r.setXY(D,L,1-N);J.push(D);D++}y.push(J)}for(g=0;g<e;g++)for(k=0;k<f;k++)q=y[k+1][g],s=y[k+1][g+1],x=
y[k][g+1],l.setX(z,y[k][g]),z++,l.setX(z,q),z++,l.setX(z,x),z++,l.setX(z,q),z++,l.setX(z,s),z++,l.setX(z,x),z++,u+=6;p.addGroup(B,u,0);B+=u})();!1===g&&(0<a&&q(!0),0<b&&q(!1));this.setIndex(l);this.addAttribute("position",v);this.addAttribute("normal",t);this.addAttribute("uv",r)};c.CylinderBufferGeometry.prototype=Object.create(c.BufferGeometry.prototype);c.CylinderBufferGeometry.prototype.constructor=c.CylinderBufferGeometry;c.ArrowHelper=function(){var a=new c.Geometry;a.vertices.push(new c.Vector3(0,
0,0),new c.Vector3(0,1,0));var b=new c.CylinderGeometry(0,.5,1,5,1);b.translate(0,-.5,0);return function(d,e,f,g,h,n){c.Object3D.call(this);void 0===g&&(g=16776960);void 0===f&&(f=1);void 0===h&&(h=.2*f);void 0===n&&(n=.2*h);this.position.copy(e);this.line=new c.Line(a,new c.LineBasicMaterial({color:g}));this.line.matrixAutoUpdate=!1;this.add(this.line);this.cone=new c.Mesh(b,new c.MeshBasicMaterial({color:g}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(d);this.setLength(f,
h,n)}}();c.ArrowHelper.prototype=Object.create(c.Object3D.prototype);c.ArrowHelper.prototype.constructor=c.ArrowHelper;c.ArrowHelper.prototype.setDirection=function(){var a=new c.Vector3,b;return function(c){.99999<c.y?this.quaternion.set(0,0,0,1):-.99999>c.y?this.quaternion.set(1,0,0,0):(a.set(c.z,0,-c.x).normalize(),b=Math.acos(c.y),this.quaternion.setFromAxisAngle(a,b))}}();c.ArrowHelper.prototype.setLength=function(a,b,c){void 0===b&&(b=.2*a);void 0===c&&(c=.2*b);this.line.scale.set(1,Math.max(0,
a-b),1);this.line.updateMatrix();this.cone.scale.set(c,b,c);this.cone.position.y=a;this.cone.updateMatrix()};c.ArrowHelper.prototype.setColor=function(a){this.line.material.color.set(a);this.cone.material.color.set(a)};h.THREE=c})}]);
</script>
</body>
</html>
